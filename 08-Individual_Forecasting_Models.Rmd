# How to Make 27 Individual Forecasting Models

This chapter builds time series models. This is also known as forecasting, the professional organization is named the International Institute of Forecasters, and their website is <https://forecasters.org>. I strongly recommend checking the IIF, I've found it to be a very good source of skills and knowledge when it comes to forecasting.

In this chapter we are going to build 16 forecasting models. There are a few large groups of models, with variations within each of the groups. For example, we will use (or not use) seasonality in the model making process.

We'll follow the same pattern/process we've been following in the previous sections:

> Load the library
>
> Set initial values to 0
>
> Create the function
>
> Break the data into train and test sets
>
> Set up random resampling
>
> Fit the model on the training data, make predictions and measure error on the test data
>
> Return the results
>
> Check for errors or warnings
>
> Test on a different data set

The first step is to load the library In the case of time series forecasting, the library is the excellent FPP3 library. There is an excellent book available that guides the learner through the time series process. The book is Forecasting Principles and Practice. It is currently in its third edition, and I recommend it very highly. The website for the book is:

<https://otexts.com/fpp3/>

The time series data we will use is the most important data that is published on a regular bases by the United States federal government: The monthly labor report. There is a large set of time series data sets at the Bureau of Labor Statistics website:

<https://www.bls.gov>

The top picks of time series data are here:

<https://data.bls.gov/cgi-bin/surveymost?ce>

For our work here we will only be looking at one data set, but it's by far the most watched result: Total nonfarm employment. The data can be found here:

<https://data.bls.gov/timeseries/CES0000000001>

I have the data stored on my Github repository, and w will be accessing that data, but there are other ways the data may be retrieved. If you plan to use this a lot, consider registering for the Application Program Interface (API) for the time series data. More information about the API and directions to register is available at:

<https://www.bls.gov/developers/>

![All data is about people](_book/images/All_data_connects_to_people.jpg)

## 12 Individual Time Series Models

### Arima 1

```{r ARIMA 1 with season and trend}

library(fpp3)

# Set initial values to 0

# Set up function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {

# Determine if the data is quarterly, monthly or weekly from the input:
if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }

# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]

# Build the model
Arima1_model = fable::ARIMA(Difference ~ season() + trend(),stepwise = TRUE, greedy = TRUE, approximation = TRUE)

# Calculate error rate
Arima1_test_error <- time_series_train %>%
    fabletools::model(Arima1_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)

# Make predictions on the holdout/test data
Arima1_predictions <- time_series_test %>%
    fabletools::model(
      Arima1_model,
    ) %>%
    fabletools::forecast(h = number)

# Report the predictions
Arima1_prediction_model <- Arima1_predictions[1]
Arima1_prediction_date<- Arima1_predictions[2]
Arima1_prediction_range <- Arima1_predictions[3]
Arima1_prediction_mean <-Arima1_predictions[4]

results <- data.frame(
  'Model' = Arima1_predictions[1],
  'Error' = Arima1_test_error$RMSE,
  'Date' = Arima1_predictions[2],
  'Forecast' = Arima1_predictions[4]
)

return(results)

}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Arima 2

```{r ARIMA2}

library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {

# Determine if the data is quarterly, monthly or weekly from the input:
if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }

# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]

Arima2_model <- fable::ARIMA(Difference ~ season(), stepwise = TRUE, greedy = TRUE, approximation = TRUE)

# Calculate error rate
Arima2_test_error <- time_series_train %>%
  fabletools::model(Arima2_model) %>%
  fabletools::forecast(h = number) %>%
  fabletools::accuracy(time_series_test)

# Make predictions on the holdout/test data
Arima2_predictions <- time_series_test %>%
  fabletools::model(
    Arima2_model,
  ) %>%
  fabletools::forecast(h = number)

# Report the predictions
Arima2_prediction_model <- Arima2_predictions[1]
Arima2_prediction_date<- Arima2_predictions[2]
Arima2_prediction_range <- Arima2_predictions[3]
Arima2_prediction_mean <-Arima2_predictions[4]

results <- data.frame(
  'Model' = Arima2_predictions[1],
  'Error' = Arima2_test_error$RMSE,
  'Date' = Arima2_predictions[2],
  'Forecast' = Arima2_predictions[4]
)

return(results)

}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Arima3

```{r ARIMA3}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {

# Determine if the data is quarterly, monthly or weekly from the input:
if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }

# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]

# Create the model:
Arima3_model <- fable::ARIMA(Difference ~ trend(),stepwise = TRUE, greedy = TRUE, approximation = TRUE)

# Calculate the error:
Arima3_test_error <- time_series_train %>%
    fabletools::model(Arima3_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)

# Calculate the forecast:
Arima3_predictions <- time_series_test %>%
    fabletools::model(
      Arima3_model,
    ) %>%
    fabletools::forecast(h = number)

# Report the predictions:
results <- data.frame(
  'Model' = Arima3_predictions[1],
  'Error' = Arima3_test_error$RMSE,
  'Date' = Arima3_predictions[2],
  'Forecast' = Arima3_predictions[4]
)

return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Arima4

```{r Arima4 models}

library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
Arima4_model <- fable::ARIMA(Difference ~ trend(),stepwise = TRUE, greedy = TRUE, approximation = TRUE)
  
  # Calculate the error:
  Arima4_test_error <- time_series_train %>%
    fabletools::model(Arima4_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Arima4_predictions <- time_series_test %>%
    fabletools::model(
      Arima4_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Arima4_predictions[1],
    'Error' = Arima4_test_error$RMSE,
    'Date' = Arima4_predictions[2],
    'Forecast' = Arima4_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Deterministic

```{r Deterministic time series models}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
Deterministic_model <- fable::ARIMA(Difference ~  1 + pdq(d = 0))
  
# Calculate the error:
Deterministic_test_error <- time_series_train %>%
    fabletools::model(Deterministic_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
Deterministic_predictions <- time_series_test %>%
    fabletools::model(
      Deterministic_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = Deterministic_predictions[1],
    'Error' = Deterministic_test_error$RMSE,
    'Date' = Deterministic_predictions[2],
    'Forecast' = Deterministic_predictions[4]
  )
  
return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Drift

```{r Drift model}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
Drift_model <- fable::SNAIVE(Difference ~ drift())

# Calculate the error:
Drift_test_error <- time_series_train %>%
    fabletools::model(Drift_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
Drift_predictions <- time_series_test %>%
    fabletools::model(
      Drift_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = Drift_predictions[1],
    'Error' = Drift_test_error$RMSE,
    'Date' = Drift_predictions[2],
    'Range' = Drift_predictions[3],
    'Value' = Drift_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### ETS1

```{r}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
ETS1_model <-   fable::ETS(Difference ~ season() + trend())

# Calculate the error:
ETS1_test_error <- time_series_train %>%
    fabletools::model(ETS1_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
ETS1_predictions <- time_series_test %>%
    fabletools::model(
      ETS1_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = ETS1_predictions[1],
    'Error' = ETS1_test_error$RMSE,
    'Date' = ETS1_predictions[2],
    'Value' = ETS1_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### ETS2

```{r}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
ETS2_model <- fable::ETS(Difference ~ trend())

# Calculate the error:
ETS2_test_error <- time_series_train %>%
    fabletools::model(ETS2_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
ETS2_predictions <- time_series_test %>%
    fabletools::model(
      ETS2_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = ETS2_predictions[1],
    'Error' = ETS2_test_error$RMSE,
    'Date' = ETS2_predictions[2],
    'Value' = ETS2_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### ETS3

```{r}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
ETS3_model <- fable::ETS(Difference ~ season())

# Calculate the error:
ETS3_test_error <- time_series_train %>%
    fabletools::model(ETS3_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
ETS3_predictions <- time_series_test %>%
    fabletools::model(
      ETS3_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = ETS3_predictions[1],
    'Error' = ETS3_test_error$RMSE,
    'Date' = ETS3_predictions[2],
    'Value' = ETS3_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### ETS4

```{r}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
ETS4_model <- fable::ETS(Difference)

# Calculate the error:
ETS4_test_error <- time_series_train %>%
    fabletools::model(ETS4_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
ETS4_predictions <- time_series_test %>%
    fabletools::model(
      ETS4_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = ETS4_predictions[1],
    'Error' = ETS4_test_error$RMSE,
    'Date' = ETS4_predictions[2],
    'Value' = ETS4_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Holt-Winters Additive

```{r}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
Holt_Winters_Additive_model <- fable::ETS(Difference ~ error("A") + trend("A") + season("A"))

# Calculate the error:
Holt_Winters_Additive_test_error <- time_series_train %>%
    fabletools::model(Holt_Winters_Additive_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
Holt_Winters_Additive_predictions <- time_series_test %>%
    fabletools::model(
      Holt_Winters_Additive_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = Holt_Winters_Additive_predictions[1],
    'Error' = Holt_Winters_Additive_test_error$RMSE,
    'Date' = Holt_Winters_Additive_predictions[2],
    'Value' = Holt_Winters_Additive_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Holt-Winters Damped

```{r Holt-Winters Damped}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
Holt_Winters_Damped_model <- fable::ETS(Difference ~ error("M") + trend("Ad") + season("M"))

# Calculate the error:
Holt_Winters_Damped_test_error <- time_series_train %>%
    fabletools::model(Holt_Winters_Damped_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
Holt_Winters_Damped_predictions <- time_series_test %>%
    fabletools::model(
      Holt_Winters_Damped_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = Holt_Winters_Damped_predictions[1],
    'Error' = Holt_Winters_Damped_test_error$RMSE,
    'Date' = Holt_Winters_Damped_predictions[2],
    'Value' = Holt_Winters_Damped_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Holt-Winters Multiplicative

```{r Holt-Winters Multiplicative}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
Holt_Winters_Multiplicative_model <- fable::ETS(Difference ~ error("M") + trend("A") + season("M"))

# Calculate the error:
Holt_Winters_Multiplicative_test_error <- time_series_train %>%
    fabletools::model(Holt_Winters_Multiplicative_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
Holt_Winters_Multiplicative_predictions <- time_series_test %>%
    fabletools::model(
      Holt_Winters_Multiplicative_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = Holt_Winters_Multiplicative_predictions[1],
    'Error' = Holt_Winters_Multiplicative_test_error$RMSE,
    'Date' = Holt_Winters_Multiplicative_predictions[2],
    'Value' = Holt_Winters_Multiplicative_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Linear 1

```{r Linear 1}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
# Split the data into train and test:
time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
# Create the model:
Linear1_model <- fable::ETS(Difference ~ error("M") + trend("Ad") + season("M"))

# Calculate the error:
Linear1_test_error <- time_series_train %>%
    fabletools::model(Linear1_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
# Calculate the forecast:
Linear1_predictions <- time_series_test %>%
    fabletools::model(
      Linear1_model,
    ) %>%
    fabletools::forecast(h = number)
  
# Report the predictions:
results <- data.frame(
    'Model' = Linear1_predictions[1],
    'Error' = Linear1_test_error$RMSE,
    'Date' = Linear1_predictions[2],
    'Value' = Linear1_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Linear 2

```{r Linear 2}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Linear2_model <- fable::TSLM(Difference)
  
  # Calculate the error:
  Linear2_test_error <- time_series_train %>%
    fabletools::model(Linear2_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Linear2_predictions <- time_series_test %>%
    fabletools::model(
      Linear2_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Linear2_predictions[1],
    'Error' = Linear2_test_error$RMSE,
    'Date' = Linear2_predictions[2],
    'Value' = Linear2_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Linear 3

```{r Linear 3}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Linear2_model <- fable::TSLM(Difference)
  
  # Calculate the error:
  Linear2_test_error <- time_series_train %>%
    fabletools::model(Linear2_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Linear2_predictions <- time_series_test %>%
    fabletools::model(
      Linear2_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Linear2_predictions[1],
    'Error' = Linear2_test_error$RMSE,
    'Date' = Linear2_predictions[2],
    'Value' = Linear2_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Linear 4

```{r Linear 4}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Linear4_model <- fable::TSLM(Difference ~ trend())
  
  # Calculate the error:
  Linear4_test_error <- time_series_train %>%
    fabletools::model(Linear4_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Linear4_predictions <- time_series_test %>%
    fabletools::model(
      Linear4_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Linear4_predictions[1],
    'Error' = Linear4_test_error$RMSE,
    'Date' = Linear4_predictions[2],
    'Value' = Linear4_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Mean

```{r Mean}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Mean_model <- fable::MEAN(Difference)
  
  # Calculate the error:
  Mean_test_error <- time_series_train %>%
    fabletools::model(Mean_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Mean_predictions <- time_series_test %>%
    fabletools::model(
      Mean_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Mean_predictions[1],
    'Error' = Mean_test_error$RMSE,
    'Date' = Mean_predictions[2],
    'Value' = Mean_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Naive

```{r Naive}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Naive_model <- fable::NAIVE(Difference)
  
  # Calculate the error:
  Naive_test_error <- time_series_train %>%
    fabletools::model(Naive_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Naive_predictions <- time_series_test %>%
    fabletools::model(
      Naive_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Naive_predictions[1],
    'Error' = Naive_test_error$RMSE,
    'Date' = Naive_predictions[2],
    'Value' = Naive_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Neuralnet 1

```{r Neuralnet 1}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Neuralnet1_model <- fable::NNETAR(Difference ~ season() + trend())
  
  # Calculate the error:
  Neuralnet1_test_error <- time_series_train %>%
    fabletools::model(Neuralnet1_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Neuralnet1_predictions <- time_series_test %>%
    fabletools::model(
      Neuralnet1_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Neuralnet1_predictions[1],
    'Error' = Neuralnet1_test_error$RMSE,
    'Date' = Neuralnet1_predictions[2],
    'Value' = Neuralnet1_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Neuralnet 2

```{r Neuralnet 2}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Neuralnet2_model <- fable::NNETAR(Difference ~ trend())
  
  # Calculate the error:
  Neuralnet2_test_error <- time_series_train %>%
    fabletools::model(Neuralnet2_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Neuralnet2_predictions <- time_series_test %>%
    fabletools::model(
      Neuralnet2_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Neuralnet2_predictions[1],
    'Error' = Neuralnet2_test_error$RMSE,
    'Date' = Neuralnet2_predictions[2],
    'Value' = Neuralnet2_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Neuralnet 3

```{r Neuralnet 3}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Neuralnet3_model <- fable::NNETAR(Difference ~ season())
  
  # Calculate the error:
  Neuralnet3_test_error <- time_series_train %>%
    fabletools::model(Neuralnet3_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Neuralnet3_predictions <- time_series_test %>%
    fabletools::model(
      Neuralnet3_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Neuralnet3_predictions[1],
    'Error' = Neuralnet3_test_error$RMSE,
    'Date' = Neuralnet3_predictions[2],
    'Value' = Neuralnet3_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Neuralnet 4

```{r Neuralnet 4}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Neuralnet3_model <- fable::NNETAR(Difference ~ season())
  
  # Calculate the error:
  Neuralnet3_test_error <- time_series_train %>%
    fabletools::model(Neuralnet3_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Neuralnet3_predictions <- time_series_test %>%
    fabletools::model(
      Neuralnet3_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Neuralnet3_predictions[1],
    'Error' = Neuralnet3_test_error$RMSE,
    'Date' = Neuralnet3_predictions[2],
    'Value' = Neuralnet3_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Prophet Additive

```{r Prophet Additive}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Prophet_Additive_model <- fable.prophet::prophet(Difference ~ season(period = 12, type = "additive"))
  
  # Calculate the error:
  Prophet_Additive_test_error <- time_series_train %>%
    fabletools::model(Prophet_Additive_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Prophet_Additive_predictions <- time_series_test %>%
    fabletools::model(
      Prophet_Additive_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Prophet_Additive_predictions[1],
    'Error' = Prophet_Additive_test_error$RMSE,
    'Date' = Prophet_Additive_predictions[2],
    'Value' = Prophet_Additive_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Prophet Multiplicative

```{r Prophet Multiplicative}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Prophet_Multiplicative_model <- fable.prophet::prophet(Difference ~ season(period = 12, type = "multiplicative"))
  
  # Calculate the error:
  Prophet_Multiplicative_test_error <- time_series_train %>%
    fabletools::model(Prophet_Multiplicative_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Prophet_Multiplicative_predictions <- time_series_test %>%
    fabletools::model(
      Prophet_Multiplicative_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Prophet_Multiplicative_predictions[1],
    'Error' = Prophet_Multiplicative_test_error$RMSE,
    'Date' = Prophet_Multiplicative_predictions[2],
    'Value' = Prophet_Multiplicative_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Seasonal Naive

```{r Seasonal Naive}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  SNaive_model <- fable::SNAIVE(Difference)
  
  # Calculate the error:
  SNaive_test_error <- time_series_train %>%
    fabletools::model(SNaive_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  SNaive_predictions <- time_series_test %>%
    fabletools::model(
      SNaive_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = SNaive_predictions[1],
    'Error' = SNaive_test_error$RMSE,
    'Date' = SNaive_predictions[2],
    'Value' = SNaive_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()
```

### Stochastic

```{r}
library(fpp3)

# Set up the function:
forecasting <- function(time_series_data, train_amount, number, time_interval = c("Q", "M", "W")) {
  
  # Determine if the data is quarterly, monthly or weekly from the input:
  if (time_interval == "Q") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearquarter(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "M") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearmonth(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  if (time_interval == "W") {
    time_series_data <- time_series_data %>%
      dplyr::mutate(Date = tsibble::yearweek(Label), Value = Value, Difference = tsibble::difference(Value)) %>%
      dplyr::select(Date, Value, Difference) %>%
      tsibble::as_tsibble(index = Date) %>%
      dplyr::slice(-c(1))
  }
  
  # Split the data into train and test:
  time_series_train <- time_series_data[1:round(train_amount*(nrow(time_series_data))),]
  time_series_test <- time_series_data[(round(train_amount*(nrow(time_series_data))) +1):nrow(time_series_data),]
  
  # Create the model:
  Stochastic_model <- fable::ARIMA(Difference ~ pdq(d = 1), stepwise = TRUE, greedy = TRUE, approximation = TRUE)
  
  # Calculate the error:
  Stochastic_test_error <- time_series_train %>%
    fabletools::model(Stochastic_model) %>%
    fabletools::forecast(h = number) %>%
    fabletools::accuracy(time_series_test)
  
  # Calculate the forecast:
  Stochastic_predictions <- time_series_test %>%
    fabletools::model(
      Stochastic_model,
    ) %>%
    fabletools::forecast(h = number)
  
  # Report the predictions:
  results <- data.frame(
    'Model' = Stochastic_predictions[1],
    'Error' = Stochastic_test_error$RMSE,
    'Date' = Stochastic_predictions[2],
    'Value' = Stochastic_predictions[4]
  )
  
  return(results)
}

# Test the function:
time_series_data <- read.csv('https://raw.githubusercontent.com/InfiniteCuriosity/forecasting_jobs/main/Total_Nonfarm.csv')

forecasting(time_series_data = time_series_data, train_amount = 0.60, number = 3, time_interval = "M")
warnings()


```

```{r}
summary_table <- data.frame()
```
