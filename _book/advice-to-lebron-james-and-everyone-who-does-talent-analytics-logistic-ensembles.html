<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert</title>
<meta name="author" content="Russ Conte">
<meta name="description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert">
<meta property="og:type" content="book">
<meta property="og:description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert">
<meta name="twitter:description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Ensembles: From Beginner to Expert</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></li>
<li><a class="" href="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions.html"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a></li>
<li><a class="" href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></li>
<li><a class="" href="classification-data-how-to-make-14-individual-classification-models.html"><span class="header-section-number">5</span> Classification data: How to make 14 individual classification models</a></li>
<li><a class="" href="building-ensembles-of-classification-models.html"><span class="header-section-number">6</span> Building ensembles of classification models</a></li>
<li><a class="" href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></li>
<li><a class="active" href="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles.html"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li>
<li><a class="" href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></li>
<li><a class="" href="ensembles-of-26-forecasting-models.html"><span class="header-section-number">10</span> Ensembles of 26 Forecasting Models</a></li>
<li><a class="" href="predicting-on-totally-new-data-with-individual-models-and-ensembles.html"><span class="header-section-number">11</span> Predicting on totally new data with individual models and ensembles</a></li>
<li><a class="" href="how-to-communicate-your-results.html"><span class="header-section-number">12</span> How to communicate your results</a></li>
<li><a class="" href="final-comprhensive-project.html"><span class="header-section-number">13</span> Final Comprhensive Project</a></li>
<li><a class="" href="building-your-own-no-code-solutions.html"><span class="header-section-number">14</span> Building your own no-code solutions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/InfinteCuriosity/EnsemblesBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles<a class="anchor" aria-label="anchor" href="#advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles"><i class="fas fa-link"></i></a>
</h1>
<p>In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps:</p>
<blockquote>
<p>Load the library</p>
<p>Set initial values to 0</p>
<p>Create the function</p>
<p>Set up random resampling</p>
<p>Break the data into train and test</p>
<p>Fit the model on the training data, make predictions and measure error on the test data</p>
<p>Return the results</p>
<p>Check for errors or warnings</p>
<p>Test on a different data set</p>
</blockquote>
<p>Logistic ensembles can be used in an extremely wide range of fields. Previously we modeled diabetes in Pima Indian women. This chapter’s example will be the performance on the court of Lebron James.</p>
<p>Here’s an image of Lebron in play.</p>
<div class="float">
<img src="_book/images/LeBron_James_small.jpg" alt="Lebron James"><div class="figcaption">Lebron James</div>
</div>
<p>There is a LOT of data in sports and HR analytics (which are extremely similar in some ways). A lot of the data is set up as logistic data. For example, here is a data set of the performance of Lebron James. The main column of interest is “result”, which is either 1 or 0. Thus it perfectly fits our requirements for logistic analysis.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://infinitecuriosity.github.io/Ensembles/">Ensembles</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: arm</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: lme4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arm (Version 1.14-4, built: 2024-4-1)</span></span>
<span><span class="co">#&gt; Working directory is /Users/russconte/Library/Mobile Documents/com~apple~CloudDocs/Documents/Machine Learning templates in R/EnsemblesBook</span></span>
<span><span class="co">#&gt; Loading required package: brnn</span></span>
<span><span class="co">#&gt; Loading required package: Formula</span></span>
<span><span class="co">#&gt; Loading required package: truncnorm</span></span>
<span><span class="co">#&gt; Loading required package: broom</span></span>
<span><span class="co">#&gt; Loading required package: C50</span></span>
<span><span class="co">#&gt; Loading required package: caret</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="co">#&gt; Loading required package: class</span></span>
<span><span class="co">#&gt; Loading required package: corrplot</span></span>
<span><span class="co">#&gt; corrplot 0.92 loaded</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'corrplot'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     corrplot</span></span>
<span><span class="co">#&gt; Loading required package: Cubist</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="co">#&gt; Loading required package: e1071</span></span>
<span><span class="co">#&gt; Loading required package: fable</span></span>
<span><span class="co">#&gt; Loading required package: fabletools</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'tsibble':</span></span>
<span><span class="co">#&gt;   method          from</span></span>
<span><span class="co">#&gt;   format.interval inum</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'fabletools'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:e1071':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     interpolate</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     MAE, RMSE</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:lme4':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     refit</span></span>
<span><span class="co">#&gt; Loading required package: fable.prophet</span></span>
<span><span class="co">#&gt; Loading required package: Rcpp</span></span>
<span><span class="co">#&gt; Loading required package: feasts</span></span>
<span><span class="co">#&gt; Loading required package: gam</span></span>
<span><span class="co">#&gt; Loading required package: splines</span></span>
<span><span class="co">#&gt; Loaded gam 1.22-3</span></span>
<span><span class="co">#&gt; Loading required package: gbm</span></span>
<span><span class="co">#&gt; Loaded gbm 2.1.9</span></span>
<span><span class="co">#&gt; This version of gbm is no longer under development. Consider transitioning to gbm3, https://github.com/gbm-developers/gbm3</span></span>
<span><span class="co">#&gt; Loading required package: GGally</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: glmnet</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span>
<span><span class="co">#&gt; Loading required package: gridExtra</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'gridExtra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; Loading required package: gt</span></span>
<span><span class="co">#&gt; Loading required package: gtExtras</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'gtExtras'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; Loading required package: ipred</span></span>
<span><span class="co">#&gt; Loading required package: kernlab</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kernlab'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     alpha</span></span>
<span><span class="co">#&gt; Loading required package: klaR</span></span>
<span><span class="co">#&gt; Loading required package: leaps</span></span>
<span><span class="co">#&gt; Loading required package: MachineShop</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'MachineShop'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:fabletools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy, response</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     calibration, lift, precision, recall, rfe,</span></span>
<span><span class="co">#&gt;     sensitivity, specificity</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     ppr</span></span>
<span><span class="co">#&gt; Loading required package: magrittr</span></span>
<span><span class="co">#&gt; Loading required package: mda</span></span>
<span><span class="co">#&gt; Loaded mda 0.5-4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'mda'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     confusion</span></span>
<span><span class="co">#&gt; Loading required package: Metrics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Metrics'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy, auc, mae, mse, msle, precision, recall,</span></span>
<span><span class="co">#&gt;     rmse, rmsle</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:fabletools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     precision, recall</span></span>
<span><span class="co">#&gt; Loading required package: neuralnet</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'neuralnet'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     compute</span></span>
<span><span class="co">#&gt; Loading required package: pls</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pls'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:corrplot':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     R2</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     coefplot, corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span>
<span><span class="co">#&gt; Loading required package: pROC</span></span>
<span><span class="co">#&gt; Type 'citation("pROC")' for a citation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pROC'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:Metrics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     auc</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     auc</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cov, smooth, var</span></span>
<span><span class="co">#&gt; Loading required package: purrr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'purrr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     set_names</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lift</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:kernlab':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cross</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:foreach':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accumulate, when</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lift</span></span>
<span><span class="co">#&gt; Loading required package: randomForest</span></span>
<span><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'randomForest'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:gridExtra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; Loading required package: reactable</span></span>
<span><span class="co">#&gt; Loading required package: reactablefmtr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'reactablefmtr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:randomForest':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:gt':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     google_font, html</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; Loading required package: readr</span></span>
<span><span class="co">#&gt; Loading required package: rpart</span></span>
<span><span class="co">#&gt; Loading required package: scales</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'scales'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:readr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     col_factor</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     discard</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:kernlab':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     alpha</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rescale</span></span>
<span><span class="co">#&gt; Loading required package: tibble</span></span>
<span><span class="co">#&gt; Loading required package: tidyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extract</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:Matrix':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     expand, pack, unpack</span></span>
<span><span class="co">#&gt; Loading required package: tree</span></span>
<span><span class="co">#&gt; Loading required package: tsibble</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tsibble'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, union</span></span>
<span><span class="co">#&gt; Loading required package: xgboost</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'xgboost'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     slice</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lebron</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;    top left  date qtr time_remaining result shot_type</span></span>
<span><span class="co">#&gt; 1  310  203 19283   2            566      0         3</span></span>
<span><span class="co">#&gt; 2  213  259 19283   2            518      0         2</span></span>
<span><span class="co">#&gt; 3  143  171 19283   2            490      0         2</span></span>
<span><span class="co">#&gt; 4   68  215 19283   2            324      1         2</span></span>
<span><span class="co">#&gt; 5   66  470 19283   2             62      0         3</span></span>
<span><span class="co">#&gt; 6   63  239 19283   4            690      1         2</span></span>
<span><span class="co">#&gt; 7  230   54 19283   4            630      0         3</span></span>
<span><span class="co">#&gt; 8   53  224 19283   4            605      1         2</span></span>
<span><span class="co">#&gt; 9  241   67 19283   4            570      0         3</span></span>
<span><span class="co">#&gt; 10 273  113 19283   4            535      0         3</span></span>
<span><span class="co">#&gt; 11  62  224 19283   4            426      0         2</span></span>
<span><span class="co">#&gt; 12  63  249 19283   4            233      1         2</span></span>
<span><span class="co">#&gt; 13 103  236 19283   4            154      0         2</span></span>
<span><span class="co">#&gt; 14  54  249 19283   4            108      1         2</span></span>
<span><span class="co">#&gt; 15  53  240 19283   4             58      0         2</span></span>
<span><span class="co">#&gt; 16 230   71 19283   5            649      1         3</span></span>
<span><span class="co">#&gt; 17 231  358 19283   5            540      0         2</span></span>
<span><span class="co">#&gt; 18  61  240 19283   5            524      1         2</span></span>
<span><span class="co">#&gt; 19  59  235 19283   5             71      1         2</span></span>
<span><span class="co">#&gt; 20 299  188 19283   5              6      1         3</span></span>
<span><span class="co">#&gt;    distance_ft lead lebron_team_score opponent_team_score</span></span>
<span><span class="co">#&gt; 1           26    0                 2                   2</span></span>
<span><span class="co">#&gt; 2           16    0                 4                   5</span></span>
<span><span class="co">#&gt; 3           11    0                 4                   7</span></span>
<span><span class="co">#&gt; 4            3    0                12                  19</span></span>
<span><span class="co">#&gt; 5           23    0                22                  23</span></span>
<span><span class="co">#&gt; 6            1    0                24                  25</span></span>
<span><span class="co">#&gt; 7           26    0                24                  27</span></span>
<span><span class="co">#&gt; 8            2    0                26                  27</span></span>
<span><span class="co">#&gt; 9           26    0                26                  29</span></span>
<span><span class="co">#&gt; 10          25    0                26                  32</span></span>
<span><span class="co">#&gt; 11           2    0                31                  39</span></span>
<span><span class="co">#&gt; 12           1    0                39                  49</span></span>
<span><span class="co">#&gt; 13           5    0                39                  51</span></span>
<span><span class="co">#&gt; 14           1    0                44                  53</span></span>
<span><span class="co">#&gt; 15           0    0                46                  55</span></span>
<span><span class="co">#&gt; 16          25    0                58                  63</span></span>
<span><span class="co">#&gt; 17          21    0                60                  70</span></span>
<span><span class="co">#&gt; 18           1    0                62                  70</span></span>
<span><span class="co">#&gt; 19           1    0                68                  91</span></span>
<span><span class="co">#&gt; 20          25    0                71                  91</span></span>
<span><span class="co">#&gt;    opponent</span></span>
<span><span class="co">#&gt; 1         9</span></span>
<span><span class="co">#&gt; 2         9</span></span>
<span><span class="co">#&gt; 3         9</span></span>
<span><span class="co">#&gt; 4         9</span></span>
<span><span class="co">#&gt; 5         9</span></span>
<span><span class="co">#&gt; 6         9</span></span>
<span><span class="co">#&gt; 7         9</span></span>
<span><span class="co">#&gt; 8         9</span></span>
<span><span class="co">#&gt; 9         9</span></span>
<span><span class="co">#&gt; 10        9</span></span>
<span><span class="co">#&gt; 11        9</span></span>
<span><span class="co">#&gt; 12        9</span></span>
<span><span class="co">#&gt; 13        9</span></span>
<span><span class="co">#&gt; 14        9</span></span>
<span><span class="co">#&gt; 15        9</span></span>
<span><span class="co">#&gt; 16        9</span></span>
<span><span class="co">#&gt; 17        9</span></span>
<span><span class="co">#&gt; 18        9</span></span>
<span><span class="co">#&gt; 19        9</span></span>
<span><span class="co">#&gt; 20        9</span></span></code></pre></div>
<p>Let’s look at the structure of the data:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lebron</span> <span class="op">&lt;-</span> <span class="fu">Ensembles</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Ensembles/man/lebron.html">lebron</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu">Ensembles</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Ensembles/man/lebron.html">lebron</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1533 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;  $ top                : int  310 213 143 68 66 63 230 53 241 273 ...</span></span>
<span><span class="co">#&gt;  $ left               : int  203 259 171 215 470 239 54 224 67 113 ...</span></span>
<span><span class="co">#&gt;  $ date               : num  19283 19283 19283 19283 19283 ...</span></span>
<span><span class="co">#&gt;  $ qtr                : num  2 2 2 2 2 4 4 4 4 4 ...</span></span>
<span><span class="co">#&gt;  $ time_remaining     : num  566 518 490 324 62 690 630 605 570 535 ...</span></span>
<span><span class="co">#&gt;  $ result             : num  0 0 0 1 0 1 0 1 0 0 ...</span></span>
<span><span class="co">#&gt;  $ shot_type          : int  3 2 2 2 3 2 3 2 3 3 ...</span></span>
<span><span class="co">#&gt;  $ distance_ft        : int  26 16 11 3 23 1 26 2 26 25 ...</span></span>
<span><span class="co">#&gt;  $ lead               : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ lebron_team_score  : int  2 4 4 12 22 24 24 26 26 26 ...</span></span>
<span><span class="co">#&gt;  $ opponent_team_score: int  2 5 7 19 23 25 27 27 29 32 ...</span></span>
<span><span class="co">#&gt;  $ opponent           : num  9 9 9 9 9 9 9 9 9 9 ...</span></span></code></pre></div>
<p>We see that all of these are numbers. It might be easier if “qtr” and “opponent” were changed to factors, so we’ll do that first.</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">lebron</span><span class="op">$</span><span class="va">qtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lebron</span><span class="op">$</span><span class="va">qtr</span><span class="op">)</span></span>
<span><span class="va">lebron</span><span class="op">$</span><span class="va">opponent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lebron</span><span class="op">$</span><span class="va">opponent</span><span class="op">)</span></span></code></pre></div>
<p>Now we’re ready to create an ensemble of models to make predictions about Lebron’s future performance. The new skill in this chapter will be saving all trained models to the Environment. This will allow us to look at the trained models, and use them to make the strongest evidence based recommendations.</p>
<p>We will use the following individual models and ensemble of models:</p>
<p>Individual models:</p>
<p>AdaBoost</p>
<p>BayesGLM</p>
<p>C50</p>
<p>Cubist</p>
<p>Generalized Linear Models (GLM)</p>
<p>Random Forest</p>
<p>XGBoost</p>
<p>We will make an ensemble of the predictions from those five models, and then use that ensemble to model predictions for Lebron’s performance.</p>
<p>We will also show the ROC curves for each of the results, and save all the trained models at the end.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load libraries - note these will work with individual and ensemble models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span> <span class="co"># to use with BayesGLM</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/C5.0/">C50</a></span><span class="op">)</span> <span class="co"># To use with C50</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/Cubist//">Cubist</a></span><span class="op">)</span> <span class="co"># To use with Cubist modeling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://brian-j-smith.github.io/MachineShop/">MachineShop</a></span><span class="op">)</span><span class="co"># To use with ADABoost</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span> <span class="co"># Random Forest models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># My favorite tool for data science!</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ purrr::accumulate()     masks foreach::accumulate()</span></span>
<span><span class="co">#&gt; ✖ scales::alpha()         masks kernlab::alpha(), ggplot2::alpha()</span></span>
<span><span class="co">#&gt; ✖ scales::col_factor()    masks readr::col_factor()</span></span>
<span><span class="co">#&gt; ✖ randomForest::combine() masks gridExtra::combine(), dplyr::combine()</span></span>
<span><span class="co">#&gt; ✖ neuralnet::compute()    masks dplyr::compute()</span></span>
<span><span class="co">#&gt; ✖ purrr::cross()          masks kernlab::cross()</span></span>
<span><span class="co">#&gt; ✖ scales::discard()       masks purrr::discard()</span></span>
<span><span class="co">#&gt; ✖ tidyr::expand()         masks Matrix::expand()</span></span>
<span><span class="co">#&gt; ✖ tidyr::extract()        masks magrittr::extract()</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter()         masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ lubridate::interval()   masks tsibble::interval()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()            masks stats::lag()</span></span>
<span><span class="co">#&gt; ✖ purrr::lift()           masks MachineShop::lift(), caret::lift()</span></span>
<span><span class="co">#&gt; ✖ reactablefmtr::margin() masks randomForest::margin(), ggplot2::margin()</span></span>
<span><span class="co">#&gt; ✖ tidyr::pack()           masks Matrix::pack()</span></span>
<span><span class="co">#&gt; ✖ gtExtras::select()      masks dplyr::select(), MASS::select()</span></span>
<span><span class="co">#&gt; ✖ purrr::set_names()      masks magrittr::set_names()</span></span>
<span><span class="co">#&gt; ✖ xgboost::slice()        masks dplyr::slice()</span></span>
<span><span class="co">#&gt; ✖ tidyr::unpack()         masks Matrix::unpack()</span></span>
<span><span class="co">#&gt; ✖ purrr::when()           masks foreach::when()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span> <span class="co"># To print ROC curves</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">adaboost_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">bayesglm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">C50_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">cubist_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">rf_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">xgb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span></span>
<span><span class="va">ensemble_adaboost_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_bayesglm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_C50_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_xgb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">logistic_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span><span class="co"># Set up random resampling</span></span>
<span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span><span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>  </span>
<span>  </span>
<span><span class="co"># ADABoost model</span></span>
<span><span class="va">adaboost_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MachineShop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MachineShop/man/fit-methods.html">fit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, model <span class="op">=</span> <span class="st">"AdaBoostModel"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adaboost_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">adaboost_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ADAboost Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">adaboost_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># BayesGLM</span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">arm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/bayesglm.html">bayesglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bayesglm_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">bayesglm_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Bayesglm Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">bayesglm_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># C50 model</span></span>
<span></span>
<span><span class="va">C50_train_fit</span> <span class="op">&lt;-</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html">C5.0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_train_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_train_table</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_test_table</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">C50_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">C50_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C50 ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">C50_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Cubist</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;-</span> <span class="fu">Cubist</span><span class="fu">::</span><span class="fu"><a href="http://topepo.github.io/Cubist/reference/cubist.default.html">cubist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">cubist_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_train_pred</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_train_table</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cubist_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_test_pred</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_test_table</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">cubist_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">cubist_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Cubist ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">cubist_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Random Forest</span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">rf_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_train_probabilities</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_train_table</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_test_table</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">rf_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Random Forest "</span>, <span class="st">"(AUC = "</span>, <span class="va">rf_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># XGBoost</span></span>
<span><span class="va">train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">train_y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">test_y</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define final train and test sets</span></span>
<span><span class="va">xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_x</span>, label <span class="op">=</span> <span class="va">train_y</span><span class="op">)</span></span>
<span><span class="va">xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_x</span>, label <span class="op">=</span> <span class="va">test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span><span class="op">)</span></span>
<span><span class="va">watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span>, test <span class="op">=</span> <span class="va">xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">train_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_train_table</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">test_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_test_table</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">xgb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"XGBoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">xgb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble</span></span>
<span></span>
<span><span class="va">ensemble1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">'ADABoost'</span> <span class="op">=</span> <span class="va">adaboost_test_predictions</span>,</span>
<span>  <span class="st">'BayesGLM'</span><span class="op">=</span> <span class="va">bayesglm_test_predictions</span>,</span>
<span>  <span class="st">'C50'</span> <span class="op">=</span> <span class="va">C50_test_predictions</span>,</span>
<span>  <span class="st">'Cubist'</span> <span class="op">=</span> <span class="va">cubist_test_pred</span>,</span>
<span>  <span class="st">'Random_Forest'</span> <span class="op">=</span> <span class="va">rf_test_pred</span>,</span>
<span>  <span class="st">'XGBoost'</span> <span class="op">=</span> <span class="va">xgb_test_predictions</span>,</span>
<span>  <span class="st">'y'</span> <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ensemble1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_train</span> <span class="op">&lt;-</span> <span class="va">ensemble1</span><span class="op">[</span><span class="va">ensemble_index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">ensemble_test</span> <span class="op">&lt;-</span> <span class="va">ensemble1</span><span class="op">[</span><span class="va">ensemble_index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="va">ensemble_y_train</span> <span class="op">&lt;-</span> <span class="va">ensemble_train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">ensemble_y_test</span> <span class="op">&lt;-</span> <span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span><span class="co"># Ensemble ADABoost</span></span>
<span><span class="va">ensemble_adaboost_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MachineShop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MachineShop/man/fit-methods.html">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ensemble_train</span>, model <span class="op">=</span> <span class="st">"AdaBoostModel"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_adaboost_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_adaboost_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_adaboost_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_adaboost_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_holdout_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_adaboost_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble Adaboostoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_adaboost_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Ensembles using C50</span></span>
<span><span class="va">ensemble_C50_train_fit</span> <span class="op">&lt;-</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html">C5.0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ensemble_y_train</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ensemble_train</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_C50_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_C50_train_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_C50_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_C50_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_C50_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_C50_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_C50_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_C50_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_C50_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_C50_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_C50_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_C50_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_C50_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_C50_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble_C50 "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_C50_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble Random Forest</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ensemble_train</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ensemble_y_train</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ensemble1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_rf_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_rf_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">ensemble_rf_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_rf_train_predictions</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_rf_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_rf_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_rf_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_rf_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_rf_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_rf_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">ensemble_rf_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_rf_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_rf_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_rf_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_rf_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_rf_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble_rf "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_rf_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble XGBoost</span></span>
<span></span>
<span><span class="va">ensemble_train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ensemble_train_y</span> <span class="op">&lt;-</span> <span class="va">ensemble_train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">ensemble_test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ensemble_test_y</span> <span class="op">&lt;-</span> <span class="va">ensemble_test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define final train and test sets</span></span>
<span><span class="va">ensemble_xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_train_x</span>, label <span class="op">=</span> <span class="va">ensemble_train_y</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_test_x</span>, label <span class="op">=</span> <span class="va">ensemble_test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">ensemble_watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">ensemble_xgb_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">ensemble_xgb_train</span>, test <span class="op">=</span> <span class="va">ensemble_xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">ensemble_watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgboost_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">ensemble_xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_train_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ensemble_xgb_model</span>, newdata <span class="op">=</span> <span class="va">ensemble_train_x</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_xgb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_xgb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ensemble_xgb_model</span>, newdata <span class="op">=</span> <span class="va">ensemble_test_x</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_xgb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_xgb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_xgb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble XGBoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_xgb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="co"># Save all trained models to the Environment</span></span>
<span><span class="va">adaboost_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">adaboost_train_fit</span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">bayesglm_train_fit</span></span>
<span><span class="va">C50_train_fit</span><span class="op">&lt;&lt;-</span> <span class="va">C50_train_fit</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">cubist_train_fit</span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">rf_train_fit</span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;&lt;-</span> <span class="va">xgb_model</span></span>
<span><span class="va">ensemble_adaboost_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_adaboost_train_fit</span></span>
<span><span class="va">ensemble_C50_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_C50_train_fit</span></span>
<span><span class="va">ensemble_rf_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_rf_train_fit</span></span>
<span><span class="va">ensemble_xgb_model</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_xgb_model</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">'Model'</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ADABoost'</span>, <span class="st">'BayesGLM'</span>, <span class="st">'C50'</span>, <span class="st">'Cubist'</span>, <span class="st">'Random_Forest'</span>, <span class="st">'XGBoost'</span>, <span class="st">'Ensemble_ADABoost'</span>, <span class="st">'Ensemble_C50'</span>, <span class="st">'Ensemble_Random_Forest'</span>, <span class="st">'Ensemble_XGBoost'</span><span class="op">)</span>,</span>
<span>  <span class="st">'Accuracy'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy_mean</span>, <span class="va">bayesglm_test_accuracy_mean</span>, <span class="va">C50_test_accuracy_mean</span>, <span class="va">cubist_test_accuracy_mean</span>, <span class="va">rf_test_accuracy_mean</span>, <span class="va">xgb_test_accuracy_mean</span>, <span class="va">ensemble_adaboost_holdout_accuracy_mean</span>, <span class="va">ensemble_C50_test_accuracy_mean</span>, <span class="va">ensemble_rf_test_accuracy_mean</span>, <span class="va">ensemble_xgb_test_accuracy_mean</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Accuracy</span><span class="op">)</span>, <span class="va">Model</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for numresamples</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for the function</span></span>
<span></span>
<span><span class="fu">logistic_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lebron</span>, colnum <span class="op">=</span> <span class="fl">6</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in rgl.init(initValue, onlyNULL): RGL: unable to</span></span>
<span><span class="co">#&gt; open X11 display</span></span>
<span><span class="co">#&gt; Warning: 'rgl.init' failed, running with 'rgl.useNULL =</span></span>
<span><span class="co">#&gt; TRUE'.</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-1.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-2.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-3.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-4.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.475192 test-rmse:0.478079 
#&gt; [2]  train-rmse:0.460745 test-rmse:0.465107 
#&gt; [3]  train-rmse:0.451388 test-rmse:0.459080 
#&gt; [4]  train-rmse:0.445489 test-rmse:0.455906 
#&gt; [5]  train-rmse:0.438896 test-rmse:0.454753 
#&gt; [6]  train-rmse:0.435170 test-rmse:0.454940 
#&gt; [7]  train-rmse:0.431544 test-rmse:0.454370 
#&gt; [8]  train-rmse:0.427571 test-rmse:0.452858 
#&gt; [9]  train-rmse:0.424162 test-rmse:0.453291 
#&gt; [10] train-rmse:0.420299 test-rmse:0.454480 
#&gt; [11] train-rmse:0.416102 test-rmse:0.456759 
#&gt; [12] train-rmse:0.411797 test-rmse:0.457650 
#&gt; [13] train-rmse:0.410482 test-rmse:0.457898 
#&gt; [14] train-rmse:0.408634 test-rmse:0.459100 
#&gt; [15] train-rmse:0.406348 test-rmse:0.460187 
#&gt; [16] train-rmse:0.402368 test-rmse:0.458932 
#&gt; [17] train-rmse:0.399812 test-rmse:0.458677 
#&gt; [18] train-rmse:0.397695 test-rmse:0.459359 
#&gt; [19] train-rmse:0.394028 test-rmse:0.461203 
#&gt; [20] train-rmse:0.391255 test-rmse:0.462953 
#&gt; [21] train-rmse:0.390029 test-rmse:0.463780 
#&gt; [22] train-rmse:0.386454 test-rmse:0.464364 
#&gt; [23] train-rmse:0.383933 test-rmse:0.464019 
#&gt; [24] train-rmse:0.380405 test-rmse:0.465352 
#&gt; [25] train-rmse:0.378997 test-rmse:0.465155 
#&gt; [26] train-rmse:0.378035 test-rmse:0.465882 
#&gt; [27] train-rmse:0.376297 test-rmse:0.467501 
#&gt; [28] train-rmse:0.373678 test-rmse:0.468427 
#&gt; [29] train-rmse:0.370551 test-rmse:0.469632 
#&gt; [30] train-rmse:0.368614 test-rmse:0.469647 
#&gt; [31] train-rmse:0.367087 test-rmse:0.468969 
#&gt; [32] train-rmse:0.365240 test-rmse:0.469454 
#&gt; [33] train-rmse:0.364351 test-rmse:0.469551 
#&gt; [34] train-rmse:0.363537 test-rmse:0.470564 
#&gt; [35] train-rmse:0.362598 test-rmse:0.470403 
#&gt; [36] train-rmse:0.360605 test-rmse:0.470439 
#&gt; [37] train-rmse:0.359448 test-rmse:0.471352 
#&gt; [38] train-rmse:0.357047 test-rmse:0.472299 
#&gt; [39] train-rmse:0.356753 test-rmse:0.472468 
#&gt; [40] train-rmse:0.356337 test-rmse:0.472618 
#&gt; [41] train-rmse:0.354152 test-rmse:0.472050 
#&gt; [42] train-rmse:0.353494 test-rmse:0.472129 
#&gt; [43] train-rmse:0.351278 test-rmse:0.473007 
#&gt; [44] train-rmse:0.349063 test-rmse:0.474251 
#&gt; [45] train-rmse:0.347140 test-rmse:0.475184 
#&gt; [46] train-rmse:0.344705 test-rmse:0.476496 
#&gt; [47] train-rmse:0.343971 test-rmse:0.476474 
#&gt; [48] train-rmse:0.342816 test-rmse:0.477032 
#&gt; [49] train-rmse:0.341562 test-rmse:0.476662 
#&gt; [50] train-rmse:0.338655 test-rmse:0.477149 
#&gt; [51] train-rmse:0.336345 test-rmse:0.478140 
#&gt; [52] train-rmse:0.334830 test-rmse:0.478396 
#&gt; [53] train-rmse:0.332630 test-rmse:0.479673 
#&gt; [54] train-rmse:0.330085 test-rmse:0.480057 
#&gt; [55] train-rmse:0.328973 test-rmse:0.480978 
#&gt; [56] train-rmse:0.327095 test-rmse:0.480589 
#&gt; [57] train-rmse:0.326709 test-rmse:0.480824 
#&gt; [58] train-rmse:0.325985 test-rmse:0.481004 
#&gt; [59] train-rmse:0.323679 test-rmse:0.480972 
#&gt; [60] train-rmse:0.322220 test-rmse:0.480484 
#&gt; [61] train-rmse:0.320199 test-rmse:0.480786 
#&gt; [62] train-rmse:0.318155 test-rmse:0.481231 
#&gt; [63] train-rmse:0.317449 test-rmse:0.482030 
#&gt; [64] train-rmse:0.316382 test-rmse:0.482857 
#&gt; [65] train-rmse:0.314298 test-rmse:0.484149 
#&gt; [66] train-rmse:0.313270 test-rmse:0.485328 
#&gt; [67] train-rmse:0.312403 test-rmse:0.485504 
#&gt; [68] train-rmse:0.310201 test-rmse:0.485571 
#&gt; [69] train-rmse:0.309894 test-rmse:0.485966 
#&gt; [70] train-rmse:0.308192 test-rmse:0.486661
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-5.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-6.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-7.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-8.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350836 test-rmse:0.350838 
#&gt; [2]  train-rmse:0.246171 test-rmse:0.246174 
#&gt; [3]  train-rmse:0.172731 test-rmse:0.172734 
#&gt; [4]  train-rmse:0.121201 test-rmse:0.121204 
#&gt; [5]  train-rmse:0.085043 test-rmse:0.085046 
#&gt; [6]  train-rmse:0.059672 test-rmse:0.059674 
#&gt; [7]  train-rmse:0.041870 test-rmse:0.041872 
#&gt; [8]  train-rmse:0.029379 test-rmse:0.029381 
#&gt; [9]  train-rmse:0.020615 test-rmse:0.020616 
#&gt; [10] train-rmse:0.014465 test-rmse:0.014466 
#&gt; [11] train-rmse:0.010149 test-rmse:0.010150 
#&gt; [12] train-rmse:0.007122 test-rmse:0.007122 
#&gt; [13] train-rmse:0.004997 test-rmse:0.004997 
#&gt; [14] train-rmse:0.003506 test-rmse:0.003507 
#&gt; [15] train-rmse:0.002460 test-rmse:0.002460 
#&gt; [16] train-rmse:0.001726 test-rmse:0.001726 
#&gt; [17] train-rmse:0.001211 test-rmse:0.001211 
#&gt; [18] train-rmse:0.000850 test-rmse:0.000850 
#&gt; [19] train-rmse:0.000596 test-rmse:0.000596 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000419 
#&gt; [21] train-rmse:0.000294 test-rmse:0.000294 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000145 test-rmse:0.000145 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-9.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-10.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-11.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-12.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-13.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-14.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.471288 test-rmse:0.480597 
#&gt; [2]  train-rmse:0.454148 test-rmse:0.471956 
#&gt; [3]  train-rmse:0.444279 test-rmse:0.468135 
#&gt; [4]  train-rmse:0.436460 test-rmse:0.466477 
#&gt; [5]  train-rmse:0.430706 test-rmse:0.465734 
#&gt; [6]  train-rmse:0.425711 test-rmse:0.466878 
#&gt; [7]  train-rmse:0.420403 test-rmse:0.466368 
#&gt; [8]  train-rmse:0.415413 test-rmse:0.466983 
#&gt; [9]  train-rmse:0.411158 test-rmse:0.468684 
#&gt; [10] train-rmse:0.408749 test-rmse:0.468528 
#&gt; [11] train-rmse:0.405317 test-rmse:0.468140 
#&gt; [12] train-rmse:0.401817 test-rmse:0.468375 
#&gt; [13] train-rmse:0.399431 test-rmse:0.469036 
#&gt; [14] train-rmse:0.395495 test-rmse:0.469593 
#&gt; [15] train-rmse:0.392010 test-rmse:0.470457 
#&gt; [16] train-rmse:0.388653 test-rmse:0.472501 
#&gt; [17] train-rmse:0.387409 test-rmse:0.472397 
#&gt; [18] train-rmse:0.383724 test-rmse:0.473634 
#&gt; [19] train-rmse:0.382593 test-rmse:0.474546 
#&gt; [20] train-rmse:0.378619 test-rmse:0.476287 
#&gt; [21] train-rmse:0.376242 test-rmse:0.476496 
#&gt; [22] train-rmse:0.374736 test-rmse:0.474994 
#&gt; [23] train-rmse:0.372731 test-rmse:0.476013 
#&gt; [24] train-rmse:0.369985 test-rmse:0.476399 
#&gt; [25] train-rmse:0.367332 test-rmse:0.477766 
#&gt; [26] train-rmse:0.364767 test-rmse:0.478064 
#&gt; [27] train-rmse:0.362684 test-rmse:0.478989 
#&gt; [28] train-rmse:0.360203 test-rmse:0.478573 
#&gt; [29] train-rmse:0.358111 test-rmse:0.478864 
#&gt; [30] train-rmse:0.357035 test-rmse:0.479190 
#&gt; [31] train-rmse:0.354377 test-rmse:0.480162 
#&gt; [32] train-rmse:0.351908 test-rmse:0.480480 
#&gt; [33] train-rmse:0.351209 test-rmse:0.480823 
#&gt; [34] train-rmse:0.348424 test-rmse:0.480542 
#&gt; [35] train-rmse:0.346924 test-rmse:0.480054 
#&gt; [36] train-rmse:0.344238 test-rmse:0.481170 
#&gt; [37] train-rmse:0.343246 test-rmse:0.481543 
#&gt; [38] train-rmse:0.342540 test-rmse:0.481763 
#&gt; [39] train-rmse:0.339574 test-rmse:0.481122 
#&gt; [40] train-rmse:0.337354 test-rmse:0.482510 
#&gt; [41] train-rmse:0.335757 test-rmse:0.482954 
#&gt; [42] train-rmse:0.333766 test-rmse:0.484287 
#&gt; [43] train-rmse:0.331758 test-rmse:0.484819 
#&gt; [44] train-rmse:0.331201 test-rmse:0.485416 
#&gt; [45] train-rmse:0.329451 test-rmse:0.485938 
#&gt; [46] train-rmse:0.327174 test-rmse:0.485647 
#&gt; [47] train-rmse:0.325412 test-rmse:0.486074 
#&gt; [48] train-rmse:0.323566 test-rmse:0.486410 
#&gt; [49] train-rmse:0.322551 test-rmse:0.487852 
#&gt; [50] train-rmse:0.320895 test-rmse:0.488615 
#&gt; [51] train-rmse:0.319681 test-rmse:0.489755 
#&gt; [52] train-rmse:0.318106 test-rmse:0.490562 
#&gt; [53] train-rmse:0.315893 test-rmse:0.490989 
#&gt; [54] train-rmse:0.314484 test-rmse:0.491501 
#&gt; [55] train-rmse:0.313154 test-rmse:0.492249 
#&gt; [56] train-rmse:0.310960 test-rmse:0.492431 
#&gt; [57] train-rmse:0.308151 test-rmse:0.492892 
#&gt; [58] train-rmse:0.305982 test-rmse:0.493646 
#&gt; [59] train-rmse:0.304090 test-rmse:0.493688 
#&gt; [60] train-rmse:0.301510 test-rmse:0.493719 
#&gt; [61] train-rmse:0.300066 test-rmse:0.494916 
#&gt; [62] train-rmse:0.297987 test-rmse:0.496096 
#&gt; [63] train-rmse:0.296870 test-rmse:0.496458 
#&gt; [64] train-rmse:0.296605 test-rmse:0.496525 
#&gt; [65] train-rmse:0.294505 test-rmse:0.497734 
#&gt; [66] train-rmse:0.292709 test-rmse:0.498562 
#&gt; [67] train-rmse:0.291528 test-rmse:0.498973 
#&gt; [68] train-rmse:0.289977 test-rmse:0.499720 
#&gt; [69] train-rmse:0.288232 test-rmse:0.500854 
#&gt; [70] train-rmse:0.286875 test-rmse:0.501465
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-15.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-16.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-17.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-18.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350806 test-rmse:0.350810 
#&gt; [2]  train-rmse:0.246130 test-rmse:0.246136 
#&gt; [3]  train-rmse:0.172688 test-rmse:0.172694 
#&gt; [4]  train-rmse:0.121160 test-rmse:0.121166 
#&gt; [5]  train-rmse:0.085008 test-rmse:0.085012 
#&gt; [6]  train-rmse:0.059642 test-rmse:0.059646 
#&gt; [7]  train-rmse:0.041846 test-rmse:0.041849 
#&gt; [8]  train-rmse:0.029360 test-rmse:0.029362 
#&gt; [9]  train-rmse:0.020599 test-rmse:0.020601 
#&gt; [10] train-rmse:0.014453 test-rmse:0.014454 
#&gt; [11] train-rmse:0.010140 test-rmse:0.010141 
#&gt; [12] train-rmse:0.007114 test-rmse:0.007115 
#&gt; [13] train-rmse:0.004992 test-rmse:0.004992 
#&gt; [14] train-rmse:0.003502 test-rmse:0.003503 
#&gt; [15] train-rmse:0.002457 test-rmse:0.002458 
#&gt; [16] train-rmse:0.001724 test-rmse:0.001724 
#&gt; [17] train-rmse:0.001210 test-rmse:0.001210 
#&gt; [18] train-rmse:0.000849 test-rmse:0.000849 
#&gt; [19] train-rmse:0.000595 test-rmse:0.000596 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-19.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-20.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-21.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-22.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-23.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-24.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.473801 test-rmse:0.480014 
#&gt; [2]  train-rmse:0.458215 test-rmse:0.469864 
#&gt; [3]  train-rmse:0.449741 test-rmse:0.466168 
#&gt; [4]  train-rmse:0.442625 test-rmse:0.464386 
#&gt; [5]  train-rmse:0.437502 test-rmse:0.463313 
#&gt; [6]  train-rmse:0.433406 test-rmse:0.465118 
#&gt; [7]  train-rmse:0.429744 test-rmse:0.465226 
#&gt; [8]  train-rmse:0.427812 test-rmse:0.464808 
#&gt; [9]  train-rmse:0.425196 test-rmse:0.465825 
#&gt; [10] train-rmse:0.422256 test-rmse:0.466677 
#&gt; [11] train-rmse:0.418247 test-rmse:0.467299 
#&gt; [12] train-rmse:0.414233 test-rmse:0.465835 
#&gt; [13] train-rmse:0.412075 test-rmse:0.467204 
#&gt; [14] train-rmse:0.410693 test-rmse:0.467586 
#&gt; [15] train-rmse:0.409503 test-rmse:0.468581 
#&gt; [16] train-rmse:0.408755 test-rmse:0.469685 
#&gt; [17] train-rmse:0.406969 test-rmse:0.469987 
#&gt; [18] train-rmse:0.404962 test-rmse:0.470371 
#&gt; [19] train-rmse:0.403384 test-rmse:0.471426 
#&gt; [20] train-rmse:0.400175 test-rmse:0.473795 
#&gt; [21] train-rmse:0.399097 test-rmse:0.473812 
#&gt; [22] train-rmse:0.396074 test-rmse:0.473160 
#&gt; [23] train-rmse:0.393537 test-rmse:0.472550 
#&gt; [24] train-rmse:0.390971 test-rmse:0.473480 
#&gt; [25] train-rmse:0.387452 test-rmse:0.473622 
#&gt; [26] train-rmse:0.384494 test-rmse:0.473356 
#&gt; [27] train-rmse:0.381861 test-rmse:0.474089 
#&gt; [28] train-rmse:0.377919 test-rmse:0.475059 
#&gt; [29] train-rmse:0.376196 test-rmse:0.474627 
#&gt; [30] train-rmse:0.375485 test-rmse:0.474749 
#&gt; [31] train-rmse:0.373193 test-rmse:0.475647 
#&gt; [32] train-rmse:0.372183 test-rmse:0.475989 
#&gt; [33] train-rmse:0.370839 test-rmse:0.475017 
#&gt; [34] train-rmse:0.368011 test-rmse:0.474879 
#&gt; [35] train-rmse:0.365786 test-rmse:0.476053 
#&gt; [36] train-rmse:0.361786 test-rmse:0.478188 
#&gt; [37] train-rmse:0.358594 test-rmse:0.479465 
#&gt; [38] train-rmse:0.357436 test-rmse:0.480038 
#&gt; [39] train-rmse:0.355393 test-rmse:0.480862 
#&gt; [40] train-rmse:0.352473 test-rmse:0.482852 
#&gt; [41] train-rmse:0.350967 test-rmse:0.483703 
#&gt; [42] train-rmse:0.349832 test-rmse:0.483414 
#&gt; [43] train-rmse:0.349549 test-rmse:0.483538 
#&gt; [44] train-rmse:0.347342 test-rmse:0.483293 
#&gt; [45] train-rmse:0.345605 test-rmse:0.483945 
#&gt; [46] train-rmse:0.344805 test-rmse:0.483469 
#&gt; [47] train-rmse:0.342493 test-rmse:0.483422 
#&gt; [48] train-rmse:0.339428 test-rmse:0.483950 
#&gt; [49] train-rmse:0.339030 test-rmse:0.484049 
#&gt; [50] train-rmse:0.336944 test-rmse:0.483367 
#&gt; [51] train-rmse:0.333893 test-rmse:0.482459 
#&gt; [52] train-rmse:0.331244 test-rmse:0.483001 
#&gt; [53] train-rmse:0.329855 test-rmse:0.482918 
#&gt; [54] train-rmse:0.329137 test-rmse:0.482874 
#&gt; [55] train-rmse:0.328487 test-rmse:0.483778 
#&gt; [56] train-rmse:0.327071 test-rmse:0.484555 
#&gt; [57] train-rmse:0.324390 test-rmse:0.485547 
#&gt; [58] train-rmse:0.322206 test-rmse:0.486124 
#&gt; [59] train-rmse:0.319892 test-rmse:0.487004 
#&gt; [60] train-rmse:0.317308 test-rmse:0.488051 
#&gt; [61] train-rmse:0.315291 test-rmse:0.487747 
#&gt; [62] train-rmse:0.314257 test-rmse:0.487359 
#&gt; [63] train-rmse:0.313193 test-rmse:0.487545 
#&gt; [64] train-rmse:0.310592 test-rmse:0.488525 
#&gt; [65] train-rmse:0.310393 test-rmse:0.488563 
#&gt; [66] train-rmse:0.308776 test-rmse:0.489347 
#&gt; [67] train-rmse:0.306880 test-rmse:0.489801 
#&gt; [68] train-rmse:0.306194 test-rmse:0.489683 
#&gt; [69] train-rmse:0.303963 test-rmse:0.490333 
#&gt; [70] train-rmse:0.302760 test-rmse:0.491298
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-25.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-26.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-27.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-28.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350779 test-rmse:0.350780 
#&gt; [2]  train-rmse:0.246092 test-rmse:0.246093 
#&gt; [3]  train-rmse:0.172648 test-rmse:0.172649 
#&gt; [4]  train-rmse:0.121123 test-rmse:0.121123 
#&gt; [5]  train-rmse:0.084975 test-rmse:0.084975 
#&gt; [6]  train-rmse:0.059615 test-rmse:0.059615 
#&gt; [7]  train-rmse:0.041823 test-rmse:0.041824 
#&gt; [8]  train-rmse:0.029341 test-rmse:0.029342 
#&gt; [9]  train-rmse:0.020585 test-rmse:0.020585 
#&gt; [10] train-rmse:0.014441 test-rmse:0.014442 
#&gt; [11] train-rmse:0.010131 test-rmse:0.010132 
#&gt; [12] train-rmse:0.007108 test-rmse:0.007108 
#&gt; [13] train-rmse:0.004987 test-rmse:0.004987 
#&gt; [14] train-rmse:0.003498 test-rmse:0.003498 
#&gt; [15] train-rmse:0.002454 test-rmse:0.002454 
#&gt; [16] train-rmse:0.001722 test-rmse:0.001722 
#&gt; [17] train-rmse:0.001208 test-rmse:0.001208 
#&gt; [18] train-rmse:0.000847 test-rmse:0.000847 
#&gt; [19] train-rmse:0.000595 test-rmse:0.000595 
#&gt; [20] train-rmse:0.000417 test-rmse:0.000417 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000205 test-rmse:0.000205 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-29.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-30.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-31.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-32.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-33.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-34.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.469345 test-rmse:0.483306 
#&gt; [2]  train-rmse:0.451129 test-rmse:0.475073 
#&gt; [3]  train-rmse:0.438859 test-rmse:0.472677 
#&gt; [4]  train-rmse:0.430394 test-rmse:0.474792 
#&gt; [5]  train-rmse:0.424651 test-rmse:0.474480 
#&gt; [6]  train-rmse:0.419686 test-rmse:0.476138 
#&gt; [7]  train-rmse:0.416104 test-rmse:0.477385 
#&gt; [8]  train-rmse:0.409485 test-rmse:0.479152 
#&gt; [9]  train-rmse:0.407226 test-rmse:0.477947 
#&gt; [10] train-rmse:0.403165 test-rmse:0.478425 
#&gt; [11] train-rmse:0.401277 test-rmse:0.479130 
#&gt; [12] train-rmse:0.396918 test-rmse:0.479524 
#&gt; [13] train-rmse:0.392692 test-rmse:0.481042 
#&gt; [14] train-rmse:0.389309 test-rmse:0.482407 
#&gt; [15] train-rmse:0.385995 test-rmse:0.483304 
#&gt; [16] train-rmse:0.382852 test-rmse:0.484639 
#&gt; [17] train-rmse:0.381596 test-rmse:0.485118 
#&gt; [18] train-rmse:0.379741 test-rmse:0.485999 
#&gt; [19] train-rmse:0.377448 test-rmse:0.486745 
#&gt; [20] train-rmse:0.373995 test-rmse:0.487018 
#&gt; [21] train-rmse:0.371236 test-rmse:0.487427 
#&gt; [22] train-rmse:0.367078 test-rmse:0.487029 
#&gt; [23] train-rmse:0.364324 test-rmse:0.487024 
#&gt; [24] train-rmse:0.361429 test-rmse:0.486409 
#&gt; [25] train-rmse:0.358355 test-rmse:0.486373 
#&gt; [26] train-rmse:0.356879 test-rmse:0.486452 
#&gt; [27] train-rmse:0.356182 test-rmse:0.486853 
#&gt; [28] train-rmse:0.353620 test-rmse:0.487637 
#&gt; [29] train-rmse:0.352210 test-rmse:0.487617 
#&gt; [30] train-rmse:0.349787 test-rmse:0.488029 
#&gt; [31] train-rmse:0.347052 test-rmse:0.488152 
#&gt; [32] train-rmse:0.344668 test-rmse:0.489566 
#&gt; [33] train-rmse:0.342204 test-rmse:0.489855 
#&gt; [34] train-rmse:0.340754 test-rmse:0.489307 
#&gt; [35] train-rmse:0.340022 test-rmse:0.489012 
#&gt; [36] train-rmse:0.337948 test-rmse:0.489216 
#&gt; [37] train-rmse:0.336364 test-rmse:0.489918 
#&gt; [38] train-rmse:0.335238 test-rmse:0.490907 
#&gt; [39] train-rmse:0.333505 test-rmse:0.490977 
#&gt; [40] train-rmse:0.331388 test-rmse:0.491889 
#&gt; [41] train-rmse:0.328998 test-rmse:0.492251 
#&gt; [42] train-rmse:0.327470 test-rmse:0.491634 
#&gt; [43] train-rmse:0.326239 test-rmse:0.492068 
#&gt; [44] train-rmse:0.324830 test-rmse:0.492400 
#&gt; [45] train-rmse:0.322450 test-rmse:0.492293 
#&gt; [46] train-rmse:0.321218 test-rmse:0.492800 
#&gt; [47] train-rmse:0.318764 test-rmse:0.493141 
#&gt; [48] train-rmse:0.316828 test-rmse:0.493773 
#&gt; [49] train-rmse:0.314391 test-rmse:0.493342 
#&gt; [50] train-rmse:0.312233 test-rmse:0.493425 
#&gt; [51] train-rmse:0.310441 test-rmse:0.493546 
#&gt; [52] train-rmse:0.309609 test-rmse:0.493152 
#&gt; [53] train-rmse:0.308001 test-rmse:0.493657 
#&gt; [54] train-rmse:0.306697 test-rmse:0.493582 
#&gt; [55] train-rmse:0.304640 test-rmse:0.493931 
#&gt; [56] train-rmse:0.303244 test-rmse:0.494351 
#&gt; [57] train-rmse:0.302286 test-rmse:0.494680 
#&gt; [58] train-rmse:0.301160 test-rmse:0.494775 
#&gt; [59] train-rmse:0.300158 test-rmse:0.494663 
#&gt; [60] train-rmse:0.297504 test-rmse:0.494739 
#&gt; [61] train-rmse:0.295155 test-rmse:0.495895 
#&gt; [62] train-rmse:0.293799 test-rmse:0.496655 
#&gt; [63] train-rmse:0.292051 test-rmse:0.496780 
#&gt; [64] train-rmse:0.288926 test-rmse:0.497473 
#&gt; [65] train-rmse:0.287236 test-rmse:0.497843 
#&gt; [66] train-rmse:0.285369 test-rmse:0.498784 
#&gt; [67] train-rmse:0.283905 test-rmse:0.499510 
#&gt; [68] train-rmse:0.283018 test-rmse:0.499894 
#&gt; [69] train-rmse:0.281572 test-rmse:0.499873 
#&gt; [70] train-rmse:0.281403 test-rmse:0.499882
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-35.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-36.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-37.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-38.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350752 test-rmse:0.350751 
#&gt; [2]  train-rmse:0.246054 test-rmse:0.246052 
#&gt; [3]  train-rmse:0.172608 test-rmse:0.172606 
#&gt; [4]  train-rmse:0.121085 test-rmse:0.121083 
#&gt; [5]  train-rmse:0.084942 test-rmse:0.084940 
#&gt; [6]  train-rmse:0.059587 test-rmse:0.059586 
#&gt; [7]  train-rmse:0.041800 test-rmse:0.041799 
#&gt; [8]  train-rmse:0.029323 test-rmse:0.029322 
#&gt; [9]  train-rmse:0.020570 test-rmse:0.020570 
#&gt; [10] train-rmse:0.014430 test-rmse:0.014430 
#&gt; [11] train-rmse:0.010123 test-rmse:0.010122 
#&gt; [12] train-rmse:0.007101 test-rmse:0.007101 
#&gt; [13] train-rmse:0.004982 test-rmse:0.004981 
#&gt; [14] train-rmse:0.003495 test-rmse:0.003494 
#&gt; [15] train-rmse:0.002451 test-rmse:0.002451 
#&gt; [16] train-rmse:0.001720 test-rmse:0.001720 
#&gt; [17] train-rmse:0.001206 test-rmse:0.001206 
#&gt; [18] train-rmse:0.000846 test-rmse:0.000846 
#&gt; [19] train-rmse:0.000594 test-rmse:0.000594 
#&gt; [20] train-rmse:0.000416 test-rmse:0.000416 
#&gt; [21] train-rmse:0.000292 test-rmse:0.000292 
#&gt; [22] train-rmse:0.000205 test-rmse:0.000205 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000049 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000049
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-39.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-40.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-41.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-42.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-43.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-44.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.469983 test-rmse:0.481825 
#&gt; [2]  train-rmse:0.453292 test-rmse:0.474652 
#&gt; [3]  train-rmse:0.442160 test-rmse:0.470276 
#&gt; [4]  train-rmse:0.434314 test-rmse:0.469678 
#&gt; [5]  train-rmse:0.429381 test-rmse:0.468875 
#&gt; [6]  train-rmse:0.425673 test-rmse:0.470175 
#&gt; [7]  train-rmse:0.422683 test-rmse:0.469549 
#&gt; [8]  train-rmse:0.419515 test-rmse:0.471713 
#&gt; [9]  train-rmse:0.418412 test-rmse:0.471700 
#&gt; [10] train-rmse:0.412741 test-rmse:0.473357 
#&gt; [11] train-rmse:0.410944 test-rmse:0.473120 
#&gt; [12] train-rmse:0.408424 test-rmse:0.473023 
#&gt; [13] train-rmse:0.405919 test-rmse:0.472233 
#&gt; [14] train-rmse:0.404462 test-rmse:0.472746 
#&gt; [15] train-rmse:0.403653 test-rmse:0.472729 
#&gt; [16] train-rmse:0.399715 test-rmse:0.472551 
#&gt; [17] train-rmse:0.396624 test-rmse:0.472368 
#&gt; [18] train-rmse:0.393517 test-rmse:0.471737 
#&gt; [19] train-rmse:0.392274 test-rmse:0.471105 
#&gt; [20] train-rmse:0.391304 test-rmse:0.471421 
#&gt; [21] train-rmse:0.388356 test-rmse:0.472729 
#&gt; [22] train-rmse:0.386881 test-rmse:0.473676 
#&gt; [23] train-rmse:0.383574 test-rmse:0.474620 
#&gt; [24] train-rmse:0.379972 test-rmse:0.475196 
#&gt; [25] train-rmse:0.379027 test-rmse:0.474874 
#&gt; [26] train-rmse:0.377911 test-rmse:0.475319 
#&gt; [27] train-rmse:0.374023 test-rmse:0.477312 
#&gt; [28] train-rmse:0.371324 test-rmse:0.477651 
#&gt; [29] train-rmse:0.369694 test-rmse:0.477372 
#&gt; [30] train-rmse:0.367384 test-rmse:0.476881 
#&gt; [31] train-rmse:0.365231 test-rmse:0.477780 
#&gt; [32] train-rmse:0.362514 test-rmse:0.477771 
#&gt; [33] train-rmse:0.361889 test-rmse:0.477999 
#&gt; [34] train-rmse:0.358611 test-rmse:0.477956 
#&gt; [35] train-rmse:0.357341 test-rmse:0.477890 
#&gt; [36] train-rmse:0.354910 test-rmse:0.477889 
#&gt; [37] train-rmse:0.352434 test-rmse:0.478723 
#&gt; [38] train-rmse:0.349446 test-rmse:0.479393 
#&gt; [39] train-rmse:0.348320 test-rmse:0.479751 
#&gt; [40] train-rmse:0.346057 test-rmse:0.479579 
#&gt; [41] train-rmse:0.344301 test-rmse:0.479321 
#&gt; [42] train-rmse:0.342503 test-rmse:0.479055 
#&gt; [43] train-rmse:0.341741 test-rmse:0.479281 
#&gt; [44] train-rmse:0.340278 test-rmse:0.479698 
#&gt; [45] train-rmse:0.338905 test-rmse:0.479804 
#&gt; [46] train-rmse:0.338534 test-rmse:0.479388 
#&gt; [47] train-rmse:0.338150 test-rmse:0.479594 
#&gt; [48] train-rmse:0.336896 test-rmse:0.479947 
#&gt; [49] train-rmse:0.334466 test-rmse:0.481629 
#&gt; [50] train-rmse:0.332821 test-rmse:0.482458 
#&gt; [51] train-rmse:0.330561 test-rmse:0.483253 
#&gt; [52] train-rmse:0.328776 test-rmse:0.482987 
#&gt; [53] train-rmse:0.327713 test-rmse:0.483217 
#&gt; [54] train-rmse:0.325673 test-rmse:0.483616 
#&gt; [55] train-rmse:0.323789 test-rmse:0.484530 
#&gt; [56] train-rmse:0.321965 test-rmse:0.485015 
#&gt; [57] train-rmse:0.321327 test-rmse:0.484828 
#&gt; [58] train-rmse:0.320789 test-rmse:0.484955 
#&gt; [59] train-rmse:0.319977 test-rmse:0.485544 
#&gt; [60] train-rmse:0.319336 test-rmse:0.485246 
#&gt; [61] train-rmse:0.317920 test-rmse:0.485508 
#&gt; [62] train-rmse:0.316384 test-rmse:0.486216 
#&gt; [63] train-rmse:0.314147 test-rmse:0.486477 
#&gt; [64] train-rmse:0.313547 test-rmse:0.487216 
#&gt; [65] train-rmse:0.311705 test-rmse:0.488294 
#&gt; [66] train-rmse:0.310588 test-rmse:0.488662 
#&gt; [67] train-rmse:0.308651 test-rmse:0.487913 
#&gt; [68] train-rmse:0.306966 test-rmse:0.488149 
#&gt; [69] train-rmse:0.305213 test-rmse:0.489127 
#&gt; [70] train-rmse:0.303103 test-rmse:0.489845
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-45.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-46.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-47.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-48.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350759 test-rmse:0.350760 
#&gt; [2]  train-rmse:0.246064 test-rmse:0.246065 
#&gt; [3]  train-rmse:0.172619 test-rmse:0.172619 
#&gt; [4]  train-rmse:0.121095 test-rmse:0.121096 
#&gt; [5]  train-rmse:0.084951 test-rmse:0.084951 
#&gt; [6]  train-rmse:0.059595 test-rmse:0.059595 
#&gt; [7]  train-rmse:0.041807 test-rmse:0.041807 
#&gt; [8]  train-rmse:0.029328 test-rmse:0.029328 
#&gt; [9]  train-rmse:0.020574 test-rmse:0.020574 
#&gt; [10] train-rmse:0.014433 test-rmse:0.014433 
#&gt; [11] train-rmse:0.010125 test-rmse:0.010125 
#&gt; [12] train-rmse:0.007103 test-rmse:0.007103 
#&gt; [13] train-rmse:0.004983 test-rmse:0.004983 
#&gt; [14] train-rmse:0.003496 test-rmse:0.003496 
#&gt; [15] train-rmse:0.002452 test-rmse:0.002452 
#&gt; [16] train-rmse:0.001720 test-rmse:0.001720 
#&gt; [17] train-rmse:0.001207 test-rmse:0.001207 
#&gt; [18] train-rmse:0.000847 test-rmse:0.000847 
#&gt; [19] train-rmse:0.000594 test-rmse:0.000594 
#&gt; [20] train-rmse:0.000417 test-rmse:0.000417 
#&gt; [21] train-rmse:0.000292 test-rmse:0.000292 
#&gt; [22] train-rmse:0.000205 test-rmse:0.000205 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<p><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-49.png" width="672"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-50.png" width="672"></p>
<pre><code><a href="https://rdrr.io/r/base/warnings.html">#&gt;                     Model  Accuracy
#&gt; 1                     C50 1.0000000
#&gt; 2                  Cubist 1.0000000
#&gt; 3       Ensemble_ADABoost 1.0000000
#&gt; 4            Ensemble_C50 1.0000000
#&gt; 5  Ensemble_Random_Forest 1.0000000
#&gt; 6        Ensemble_XGBoost 1.0000000
#&gt; 7           Random_Forest 1.0000000
#&gt; 8                BayesGLM 0.6430284
#&gt; 9                 XGBoost 0.6361022
#&gt; 10               ADABoost 0.6176642
warnings()</a></code></pre>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></div>
<div class="next"><a href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/InfinteCuriosity/EnsemblesBook/blob/master/07-Ensembles_of_Logistic_Models.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/InfinteCuriosity/EnsemblesBook/edit/master/07-Ensembles_of_Logistic_Models.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Ensembles: From Beginner to Expert</strong>" was written by Russ Conte. It was last built on 2024-06-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
