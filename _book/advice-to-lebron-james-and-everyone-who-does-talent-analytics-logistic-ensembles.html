<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert</title>
<meta name="author" content="Russ Conte">
<meta name="description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert">
<meta property="og:type" content="book">
<meta property="og:description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert">
<meta name="twitter:description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Ensembles: From Beginner to Expert</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></li>
<li><a class="" href="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions.html"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a></li>
<li><a class="" href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></li>
<li><a class="" href="classification-data-how-to-make-14-individual-classification-models.html"><span class="header-section-number">5</span> Classification data: How to make 14 individual classification models</a></li>
<li><a class="" href="building-ensembles-of-classification-models.html"><span class="header-section-number">6</span> Building ensembles of classification models</a></li>
<li><a class="" href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></li>
<li><a class="active" href="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles.html"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li>
<li><a class="" href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></li>
<li><a class="" href="ensembles-of-26-forecasting-models.html"><span class="header-section-number">10</span> Ensembles of 26 Forecasting Models</a></li>
<li><a class="" href="predicting-on-totally-new-data-with-individual-models-and-ensembles.html"><span class="header-section-number">11</span> Predicting on totally new data with individual models and ensembles</a></li>
<li><a class="" href="how-to-communicate-your-results.html"><span class="header-section-number">12</span> How to communicate your results</a></li>
<li><a class="" href="final-comprhensive-project.html"><span class="header-section-number">13</span> Final Comprhensive Project</a></li>
<li><a class="" href="building-your-own-no-code-solutions.html"><span class="header-section-number">14</span> Building your own no-code solutions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/InfiniteCuriosity/EnsemblesBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles<a class="anchor" aria-label="anchor" href="#advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles"><i class="fas fa-link"></i></a>
</h1>
<p>In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps:</p>
<blockquote>
<p>Load the library</p>
<p>Set initial values to 0</p>
<p>Create the function</p>
<p>Set up random resampling</p>
<p>Break the data into train and test</p>
<p>Fit the model on the training data, make predictions and measure error on the test data</p>
<p>Return the results</p>
<p>Check for errors or warnings</p>
<p>Test on a different data set</p>
</blockquote>
<p>Logistic ensembles can be used in an extremely wide range of fields. Previously we modeled diabetes in Pima Indian women. This chapter’s example will be the performance on the court of Lebron James.</p>
<p>Here’s an image of Lebron in play.</p>
<div class="float">
<img src="_book/images/LeBron_James_small.jpg" alt="Lebron James"><div class="figcaption">Lebron James</div>
</div>
<p>There is a LOT of data in sports and HR analytics (which are extremely similar in some ways). A lot of the data is set up as logistic data. For example, here is a data set of the performance of Lebron James. The main column of interest is “result”, which is either 1 or 0. Thus it perfectly fits our requirements for logistic analysis.</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://infinitecuriosity.github.io/Ensembles/">Ensembles</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: arm</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: lme4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arm (Version 1.14-4, built: 2024-4-1)</span></span>
<span><span class="co">#&gt; Working directory is /Users/russellconte/Library/Mobile Documents/com~apple~CloudDocs/Documents/Machine Learning templates in R/EnsemblesBook</span></span>
<span><span class="co">#&gt; Loading required package: brnn</span></span>
<span><span class="co">#&gt; Loading required package: Formula</span></span>
<span><span class="co">#&gt; Loading required package: truncnorm</span></span>
<span><span class="co">#&gt; Loading required package: broom</span></span>
<span><span class="co">#&gt; Loading required package: C50</span></span>
<span><span class="co">#&gt; Loading required package: caret</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="co">#&gt; Loading required package: class</span></span>
<span><span class="co">#&gt; Loading required package: corrplot</span></span>
<span><span class="co">#&gt; corrplot 0.92 loaded</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'corrplot'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     corrplot</span></span>
<span><span class="co">#&gt; Loading required package: Cubist</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="co">#&gt; Loading required package: e1071</span></span>
<span><span class="co">#&gt; Loading required package: fable</span></span>
<span><span class="co">#&gt; Loading required package: fabletools</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'tsibble':</span></span>
<span><span class="co">#&gt;   method          from</span></span>
<span><span class="co">#&gt;   format.interval inum</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'fabletools'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:e1071':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     interpolate</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     MAE, RMSE</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:lme4':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     refit</span></span>
<span><span class="co">#&gt; Loading required package: fable.prophet</span></span>
<span><span class="co">#&gt; Loading required package: Rcpp</span></span>
<span><span class="co">#&gt; Loading required package: feasts</span></span>
<span><span class="co">#&gt; Loading required package: gam</span></span>
<span><span class="co">#&gt; Loading required package: splines</span></span>
<span><span class="co">#&gt; Loaded gam 1.22-3</span></span>
<span><span class="co">#&gt; Loading required package: gbm</span></span>
<span><span class="co">#&gt; Loaded gbm 2.1.9</span></span>
<span><span class="co">#&gt; This version of gbm is no longer under development. Consider transitioning to gbm3, https://github.com/gbm-developers/gbm3</span></span>
<span><span class="co">#&gt; Loading required package: GGally</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: glmnet</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span>
<span><span class="co">#&gt; Loading required package: gridExtra</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'gridExtra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; Loading required package: gt</span></span>
<span><span class="co">#&gt; Loading required package: gtExtras</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'gtExtras'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; Loading required package: ipred</span></span>
<span><span class="co">#&gt; Loading required package: kernlab</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kernlab'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     alpha</span></span>
<span><span class="co">#&gt; Loading required package: klaR</span></span>
<span><span class="co">#&gt; Loading required package: leaps</span></span>
<span><span class="co">#&gt; Loading required package: MachineShop</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'MachineShop'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:fabletools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy, response</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     calibration, lift, precision, recall, rfe,</span></span>
<span><span class="co">#&gt;     sensitivity, specificity</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     ppr</span></span>
<span><span class="co">#&gt; Loading required package: magrittr</span></span>
<span><span class="co">#&gt; Loading required package: mda</span></span>
<span><span class="co">#&gt; Loaded mda 0.5-4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'mda'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     confusion</span></span>
<span><span class="co">#&gt; Loading required package: Metrics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Metrics'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy, auc, mae, mse, msle, precision, recall,</span></span>
<span><span class="co">#&gt;     rmse, rmsle</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:fabletools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     precision, recall</span></span>
<span><span class="co">#&gt; Loading required package: neuralnet</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'neuralnet'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     compute</span></span>
<span><span class="co">#&gt; Loading required package: pls</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pls'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:corrplot':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     R2</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     coefplot, corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span>
<span><span class="co">#&gt; Loading required package: pROC</span></span>
<span><span class="co">#&gt; Type 'citation("pROC")' for a citation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pROC'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:Metrics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     auc</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     auc</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cov, smooth, var</span></span>
<span><span class="co">#&gt; Loading required package: purrr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'purrr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     set_names</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lift</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:kernlab':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cross</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:foreach':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accumulate, when</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lift</span></span>
<span><span class="co">#&gt; Loading required package: randomForest</span></span>
<span><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'randomForest'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:gridExtra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; Loading required package: reactable</span></span>
<span><span class="co">#&gt; Loading required package: reactablefmtr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'reactablefmtr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:randomForest':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:gt':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     google_font, html</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; Loading required package: readr</span></span>
<span><span class="co">#&gt; Loading required package: rpart</span></span>
<span><span class="co">#&gt; Loading required package: scales</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'scales'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:readr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     col_factor</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     discard</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:kernlab':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     alpha</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rescale</span></span>
<span><span class="co">#&gt; Loading required package: tibble</span></span>
<span><span class="co">#&gt; Loading required package: tidyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extract</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:Matrix':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     expand, pack, unpack</span></span>
<span><span class="co">#&gt; Loading required package: tree</span></span>
<span><span class="co">#&gt; Loading required package: tsibble</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tsibble'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, union</span></span>
<span><span class="co">#&gt; Loading required package: xgboost</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'xgboost'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     slice</span></span></code></pre></div>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lebron</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;    top left  date qtr time_remaining result shot_type</span></span>
<span><span class="co">#&gt; 1  310  203 19283   2            566      0         3</span></span>
<span><span class="co">#&gt; 2  213  259 19283   2            518      0         2</span></span>
<span><span class="co">#&gt; 3  143  171 19283   2            490      0         2</span></span>
<span><span class="co">#&gt; 4   68  215 19283   2            324      1         2</span></span>
<span><span class="co">#&gt; 5   66  470 19283   2             62      0         3</span></span>
<span><span class="co">#&gt; 6   63  239 19283   4            690      1         2</span></span>
<span><span class="co">#&gt; 7  230   54 19283   4            630      0         3</span></span>
<span><span class="co">#&gt; 8   53  224 19283   4            605      1         2</span></span>
<span><span class="co">#&gt; 9  241   67 19283   4            570      0         3</span></span>
<span><span class="co">#&gt; 10 273  113 19283   4            535      0         3</span></span>
<span><span class="co">#&gt; 11  62  224 19283   4            426      0         2</span></span>
<span><span class="co">#&gt; 12  63  249 19283   4            233      1         2</span></span>
<span><span class="co">#&gt; 13 103  236 19283   4            154      0         2</span></span>
<span><span class="co">#&gt; 14  54  249 19283   4            108      1         2</span></span>
<span><span class="co">#&gt; 15  53  240 19283   4             58      0         2</span></span>
<span><span class="co">#&gt; 16 230   71 19283   5            649      1         3</span></span>
<span><span class="co">#&gt; 17 231  358 19283   5            540      0         2</span></span>
<span><span class="co">#&gt; 18  61  240 19283   5            524      1         2</span></span>
<span><span class="co">#&gt; 19  59  235 19283   5             71      1         2</span></span>
<span><span class="co">#&gt; 20 299  188 19283   5              6      1         3</span></span>
<span><span class="co">#&gt;    distance_ft lead lebron_team_score opponent_team_score</span></span>
<span><span class="co">#&gt; 1           26    0                 2                   2</span></span>
<span><span class="co">#&gt; 2           16    0                 4                   5</span></span>
<span><span class="co">#&gt; 3           11    0                 4                   7</span></span>
<span><span class="co">#&gt; 4            3    0                12                  19</span></span>
<span><span class="co">#&gt; 5           23    0                22                  23</span></span>
<span><span class="co">#&gt; 6            1    0                24                  25</span></span>
<span><span class="co">#&gt; 7           26    0                24                  27</span></span>
<span><span class="co">#&gt; 8            2    0                26                  27</span></span>
<span><span class="co">#&gt; 9           26    0                26                  29</span></span>
<span><span class="co">#&gt; 10          25    0                26                  32</span></span>
<span><span class="co">#&gt; 11           2    0                31                  39</span></span>
<span><span class="co">#&gt; 12           1    0                39                  49</span></span>
<span><span class="co">#&gt; 13           5    0                39                  51</span></span>
<span><span class="co">#&gt; 14           1    0                44                  53</span></span>
<span><span class="co">#&gt; 15           0    0                46                  55</span></span>
<span><span class="co">#&gt; 16          25    0                58                  63</span></span>
<span><span class="co">#&gt; 17          21    0                60                  70</span></span>
<span><span class="co">#&gt; 18           1    0                62                  70</span></span>
<span><span class="co">#&gt; 19           1    0                68                  91</span></span>
<span><span class="co">#&gt; 20          25    0                71                  91</span></span>
<span><span class="co">#&gt;    opponent</span></span>
<span><span class="co">#&gt; 1         9</span></span>
<span><span class="co">#&gt; 2         9</span></span>
<span><span class="co">#&gt; 3         9</span></span>
<span><span class="co">#&gt; 4         9</span></span>
<span><span class="co">#&gt; 5         9</span></span>
<span><span class="co">#&gt; 6         9</span></span>
<span><span class="co">#&gt; 7         9</span></span>
<span><span class="co">#&gt; 8         9</span></span>
<span><span class="co">#&gt; 9         9</span></span>
<span><span class="co">#&gt; 10        9</span></span>
<span><span class="co">#&gt; 11        9</span></span>
<span><span class="co">#&gt; 12        9</span></span>
<span><span class="co">#&gt; 13        9</span></span>
<span><span class="co">#&gt; 14        9</span></span>
<span><span class="co">#&gt; 15        9</span></span>
<span><span class="co">#&gt; 16        9</span></span>
<span><span class="co">#&gt; 17        9</span></span>
<span><span class="co">#&gt; 18        9</span></span>
<span><span class="co">#&gt; 19        9</span></span>
<span><span class="co">#&gt; 20        9</span></span></code></pre></div>
<p>Let’s look at the structure of the data:</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lebron</span> <span class="op">&lt;-</span> <span class="fu">Ensembles</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Ensembles/man/lebron.html">lebron</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu">Ensembles</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Ensembles/man/lebron.html">lebron</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1533 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;  $ top                : int  310 213 143 68 66 63 230 53 241 273 ...</span></span>
<span><span class="co">#&gt;  $ left               : int  203 259 171 215 470 239 54 224 67 113 ...</span></span>
<span><span class="co">#&gt;  $ date               : num  19283 19283 19283 19283 19283 ...</span></span>
<span><span class="co">#&gt;  $ qtr                : num  2 2 2 2 2 4 4 4 4 4 ...</span></span>
<span><span class="co">#&gt;  $ time_remaining     : num  566 518 490 324 62 690 630 605 570 535 ...</span></span>
<span><span class="co">#&gt;  $ result             : num  0 0 0 1 0 1 0 1 0 0 ...</span></span>
<span><span class="co">#&gt;  $ shot_type          : int  3 2 2 2 3 2 3 2 3 3 ...</span></span>
<span><span class="co">#&gt;  $ distance_ft        : int  26 16 11 3 23 1 26 2 26 25 ...</span></span>
<span><span class="co">#&gt;  $ lead               : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ lebron_team_score  : int  2 4 4 12 22 24 24 26 26 26 ...</span></span>
<span><span class="co">#&gt;  $ opponent_team_score: int  2 5 7 19 23 25 27 27 29 32 ...</span></span>
<span><span class="co">#&gt;  $ opponent           : num  9 9 9 9 9 9 9 9 9 9 ...</span></span></code></pre></div>
<p>We see that all of these are numbers. It might be easier if “qtr” and “opponent” were changed to factors, so we’ll do that first.</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">lebron</span><span class="op">$</span><span class="va">qtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lebron</span><span class="op">$</span><span class="va">qtr</span><span class="op">)</span></span>
<span><span class="va">lebron</span><span class="op">$</span><span class="va">opponent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lebron</span><span class="op">$</span><span class="va">opponent</span><span class="op">)</span></span></code></pre></div>
<p>Now we’re ready to create an ensemble of models to make predictions about Lebron’s future performance. The new skill in this chapter will be saving all trained models to the Environment. This will allow us to look at the trained models, and use them to make the strongest evidence based recommendations.</p>
<p>We will use the following individual models and ensemble of models:</p>
<p>Individual models:</p>
<p>AdaBoost</p>
<p>BayesGLM</p>
<p>C50</p>
<p>Cubist</p>
<p>Generalized Linear Models (GLM)</p>
<p>Random Forest</p>
<p>XGBoost</p>
<p>We will make an ensemble of the predictions from those five models, and then use that ensemble to model predictions for Lebron’s performance.</p>
<p>We will also show the ROC curves for each of the results, and save all the trained models at the end.</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load libraries - note these will work with individual and ensemble models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span> <span class="co"># to use with BayesGLM</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/C5.0/">C50</a></span><span class="op">)</span> <span class="co"># To use with C50</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/Cubist//">Cubist</a></span><span class="op">)</span> <span class="co"># To use with Cubist modeling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://brian-j-smith.github.io/MachineShop/">MachineShop</a></span><span class="op">)</span><span class="co"># To use with ADABoost</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span> <span class="co"># Random Forest models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># My favorite tool for data science!</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ purrr::accumulate()     masks foreach::accumulate()</span></span>
<span><span class="co">#&gt; ✖ scales::alpha()         masks kernlab::alpha(), ggplot2::alpha()</span></span>
<span><span class="co">#&gt; ✖ scales::col_factor()    masks readr::col_factor()</span></span>
<span><span class="co">#&gt; ✖ randomForest::combine() masks gridExtra::combine(), dplyr::combine()</span></span>
<span><span class="co">#&gt; ✖ neuralnet::compute()    masks dplyr::compute()</span></span>
<span><span class="co">#&gt; ✖ purrr::cross()          masks kernlab::cross()</span></span>
<span><span class="co">#&gt; ✖ scales::discard()       masks purrr::discard()</span></span>
<span><span class="co">#&gt; ✖ tidyr::expand()         masks Matrix::expand()</span></span>
<span><span class="co">#&gt; ✖ tidyr::extract()        masks magrittr::extract()</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter()         masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ lubridate::interval()   masks tsibble::interval()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()            masks stats::lag()</span></span>
<span><span class="co">#&gt; ✖ purrr::lift()           masks MachineShop::lift(), caret::lift()</span></span>
<span><span class="co">#&gt; ✖ reactablefmtr::margin() masks randomForest::margin(), ggplot2::margin()</span></span>
<span><span class="co">#&gt; ✖ tidyr::pack()           masks Matrix::pack()</span></span>
<span><span class="co">#&gt; ✖ gtExtras::select()      masks dplyr::select(), MASS::select()</span></span>
<span><span class="co">#&gt; ✖ purrr::set_names()      masks magrittr::set_names()</span></span>
<span><span class="co">#&gt; ✖ xgboost::slice()        masks dplyr::slice()</span></span>
<span><span class="co">#&gt; ✖ tidyr::unpack()         masks Matrix::unpack()</span></span>
<span><span class="co">#&gt; ✖ purrr::when()           masks foreach::when()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span></code></pre></div>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span> <span class="co"># To print ROC curves</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">adaboost_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">bayesglm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">C50_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">cubist_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">rf_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">xgb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span></span>
<span><span class="va">ensemble_adaboost_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_bayesglm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_C50_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_xgb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">logistic_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span><span class="co"># Set up random resampling</span></span>
<span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span><span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>  </span>
<span>  </span>
<span><span class="co"># ADABoost model</span></span>
<span><span class="va">adaboost_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MachineShop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MachineShop/man/fit-methods.html">fit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, model <span class="op">=</span> <span class="st">"AdaBoostModel"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adaboost_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">adaboost_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ADAboost Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">adaboost_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># BayesGLM</span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">arm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/bayesglm.html">bayesglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bayesglm_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">bayesglm_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Bayesglm Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">bayesglm_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># C50 model</span></span>
<span></span>
<span><span class="va">C50_train_fit</span> <span class="op">&lt;-</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html">C5.0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_train_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_train_table</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_test_table</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">C50_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">C50_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C50 ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">C50_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Cubist</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;-</span> <span class="fu">Cubist</span><span class="fu">::</span><span class="fu"><a href="http://topepo.github.io/Cubist/reference/cubist.default.html">cubist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">cubist_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_train_pred</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_train_table</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cubist_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_test_pred</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_test_table</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">cubist_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">cubist_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Cubist ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">cubist_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Random Forest</span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">rf_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_train_probabilities</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_train_table</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_test_table</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">rf_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Random Forest "</span>, <span class="st">"(AUC = "</span>, <span class="va">rf_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># XGBoost</span></span>
<span><span class="va">train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">train_y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">test_y</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define final train and test sets</span></span>
<span><span class="va">xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_x</span>, label <span class="op">=</span> <span class="va">train_y</span><span class="op">)</span></span>
<span><span class="va">xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_x</span>, label <span class="op">=</span> <span class="va">test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span><span class="op">)</span></span>
<span><span class="va">watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span>, test <span class="op">=</span> <span class="va">xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">train_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_train_table</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">test_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_test_table</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">xgb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"XGBoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">xgb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble</span></span>
<span></span>
<span><span class="va">ensemble1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">'ADABoost'</span> <span class="op">=</span> <span class="va">adaboost_test_predictions</span>,</span>
<span>  <span class="st">'BayesGLM'</span><span class="op">=</span> <span class="va">bayesglm_test_predictions</span>,</span>
<span>  <span class="st">'C50'</span> <span class="op">=</span> <span class="va">C50_test_predictions</span>,</span>
<span>  <span class="st">'Cubist'</span> <span class="op">=</span> <span class="va">cubist_test_pred</span>,</span>
<span>  <span class="st">'Random_Forest'</span> <span class="op">=</span> <span class="va">rf_test_pred</span>,</span>
<span>  <span class="st">'XGBoost'</span> <span class="op">=</span> <span class="va">xgb_test_predictions</span>,</span>
<span>  <span class="st">'y'</span> <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ensemble1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_train</span> <span class="op">&lt;-</span> <span class="va">ensemble1</span><span class="op">[</span><span class="va">ensemble_index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">ensemble_test</span> <span class="op">&lt;-</span> <span class="va">ensemble1</span><span class="op">[</span><span class="va">ensemble_index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="va">ensemble_y_train</span> <span class="op">&lt;-</span> <span class="va">ensemble_train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">ensemble_y_test</span> <span class="op">&lt;-</span> <span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span><span class="co"># Ensemble ADABoost</span></span>
<span><span class="va">ensemble_adaboost_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MachineShop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MachineShop/man/fit-methods.html">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ensemble_train</span>, model <span class="op">=</span> <span class="st">"AdaBoostModel"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_adaboost_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_adaboost_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_adaboost_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_adaboost_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_holdout_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_adaboost_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble Adaboostoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_adaboost_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Ensembles using C50</span></span>
<span><span class="va">ensemble_C50_train_fit</span> <span class="op">&lt;-</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html">C5.0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ensemble_y_train</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ensemble_train</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_C50_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_C50_train_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_C50_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_C50_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_C50_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_C50_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_C50_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_C50_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_C50_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_C50_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_C50_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_C50_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_C50_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_C50_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble_C50 "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_C50_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble Random Forest</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ensemble_train</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ensemble_y_train</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ensemble1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_rf_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_rf_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">ensemble_rf_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_rf_train_predictions</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_rf_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_rf_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_rf_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_rf_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_rf_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_rf_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">ensemble_rf_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_rf_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_rf_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_rf_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_rf_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_rf_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble_rf "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_rf_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble XGBoost</span></span>
<span></span>
<span><span class="va">ensemble_train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ensemble_train_y</span> <span class="op">&lt;-</span> <span class="va">ensemble_train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">ensemble_test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ensemble_test_y</span> <span class="op">&lt;-</span> <span class="va">ensemble_test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define final train and test sets</span></span>
<span><span class="va">ensemble_xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_train_x</span>, label <span class="op">=</span> <span class="va">ensemble_train_y</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_test_x</span>, label <span class="op">=</span> <span class="va">ensemble_test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">ensemble_watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">ensemble_xgb_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">ensemble_xgb_train</span>, test <span class="op">=</span> <span class="va">ensemble_xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">ensemble_watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgboost_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">ensemble_xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_train_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ensemble_xgb_model</span>, newdata <span class="op">=</span> <span class="va">ensemble_train_x</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_xgb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_xgb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ensemble_xgb_model</span>, newdata <span class="op">=</span> <span class="va">ensemble_test_x</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_xgb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_xgb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_xgb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble XGBoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_xgb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="co"># Save all trained models to the Environment</span></span>
<span><span class="va">adaboost_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">adaboost_train_fit</span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">bayesglm_train_fit</span></span>
<span><span class="va">C50_train_fit</span><span class="op">&lt;&lt;-</span> <span class="va">C50_train_fit</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">cubist_train_fit</span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">rf_train_fit</span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;&lt;-</span> <span class="va">xgb_model</span></span>
<span><span class="va">ensemble_adaboost_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_adaboost_train_fit</span></span>
<span><span class="va">ensemble_C50_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_C50_train_fit</span></span>
<span><span class="va">ensemble_rf_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_rf_train_fit</span></span>
<span><span class="va">ensemble_xgb_model</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_xgb_model</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">'Model'</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ADABoost'</span>, <span class="st">'BayesGLM'</span>, <span class="st">'C50'</span>, <span class="st">'Cubist'</span>, <span class="st">'Random_Forest'</span>, <span class="st">'XGBoost'</span>, <span class="st">'Ensemble_ADABoost'</span>, <span class="st">'Ensemble_C50'</span>, <span class="st">'Ensemble_Random_Forest'</span>, <span class="st">'Ensemble_XGBoost'</span><span class="op">)</span>,</span>
<span>  <span class="st">'Accuracy'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy_mean</span>, <span class="va">bayesglm_test_accuracy_mean</span>, <span class="va">C50_test_accuracy_mean</span>, <span class="va">cubist_test_accuracy_mean</span>, <span class="va">rf_test_accuracy_mean</span>, <span class="va">xgb_test_accuracy_mean</span>, <span class="va">ensemble_adaboost_holdout_accuracy_mean</span>, <span class="va">ensemble_C50_test_accuracy_mean</span>, <span class="va">ensemble_rf_test_accuracy_mean</span>, <span class="va">ensemble_xgb_test_accuracy_mean</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Accuracy</span><span class="op">)</span>, <span class="va">Model</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for numresamples</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for the function</span></span>
<span></span>
<span><span class="fu">logistic_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lebron</span>, colnum <span class="op">=</span> <span class="fl">6</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-1.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-2.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-3.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-4.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.473260 test-rmse:0.480928 
#&gt; [2]  train-rmse:0.456710 test-rmse:0.470992 
#&gt; [3]  train-rmse:0.447663 test-rmse:0.467005 
#&gt; [4]  train-rmse:0.440178 test-rmse:0.465661 
#&gt; [5]  train-rmse:0.434177 test-rmse:0.466090 
#&gt; [6]  train-rmse:0.428811 test-rmse:0.467722 
#&gt; [7]  train-rmse:0.423727 test-rmse:0.466571 
#&gt; [8]  train-rmse:0.421580 test-rmse:0.466593 
#&gt; [9]  train-rmse:0.417858 test-rmse:0.467885 
#&gt; [10] train-rmse:0.413965 test-rmse:0.467015 
#&gt; [11] train-rmse:0.410669 test-rmse:0.466459 
#&gt; [12] train-rmse:0.405800 test-rmse:0.467934 
#&gt; [13] train-rmse:0.402774 test-rmse:0.468156 
#&gt; [14] train-rmse:0.399552 test-rmse:0.468364 
#&gt; [15] train-rmse:0.396837 test-rmse:0.469123 
#&gt; [16] train-rmse:0.395868 test-rmse:0.468896 
#&gt; [17] train-rmse:0.393769 test-rmse:0.469476 
#&gt; [18] train-rmse:0.392662 test-rmse:0.469459 
#&gt; [19] train-rmse:0.388343 test-rmse:0.471196 
#&gt; [20] train-rmse:0.385616 test-rmse:0.473240 
#&gt; [21] train-rmse:0.382860 test-rmse:0.472697 
#&gt; [22] train-rmse:0.379975 test-rmse:0.472335 
#&gt; [23] train-rmse:0.376858 test-rmse:0.472360 
#&gt; [24] train-rmse:0.375869 test-rmse:0.472726 
#&gt; [25] train-rmse:0.373040 test-rmse:0.472583 
#&gt; [26] train-rmse:0.371312 test-rmse:0.472935 
#&gt; [27] train-rmse:0.370105 test-rmse:0.473267 
#&gt; [28] train-rmse:0.367494 test-rmse:0.473389 
#&gt; [29] train-rmse:0.364031 test-rmse:0.474244 
#&gt; [30] train-rmse:0.363426 test-rmse:0.474258 
#&gt; [31] train-rmse:0.361620 test-rmse:0.475409 
#&gt; [32] train-rmse:0.360143 test-rmse:0.477001 
#&gt; [33] train-rmse:0.357859 test-rmse:0.477171 
#&gt; [34] train-rmse:0.355857 test-rmse:0.476392 
#&gt; [35] train-rmse:0.353645 test-rmse:0.476856 
#&gt; [36] train-rmse:0.350245 test-rmse:0.477487 
#&gt; [37] train-rmse:0.349426 test-rmse:0.478119 
#&gt; [38] train-rmse:0.346989 test-rmse:0.479051 
#&gt; [39] train-rmse:0.344126 test-rmse:0.478877 
#&gt; [40] train-rmse:0.342363 test-rmse:0.479401 
#&gt; [41] train-rmse:0.340939 test-rmse:0.480583 
#&gt; [42] train-rmse:0.339069 test-rmse:0.481435 
#&gt; [43] train-rmse:0.338761 test-rmse:0.481577 
#&gt; [44] train-rmse:0.336075 test-rmse:0.482866 
#&gt; [45] train-rmse:0.334078 test-rmse:0.485063 
#&gt; [46] train-rmse:0.332140 test-rmse:0.485620 
#&gt; [47] train-rmse:0.329294 test-rmse:0.486408 
#&gt; [48] train-rmse:0.326892 test-rmse:0.487116 
#&gt; [49] train-rmse:0.325316 test-rmse:0.487400 
#&gt; [50] train-rmse:0.322989 test-rmse:0.487219 
#&gt; [51] train-rmse:0.322548 test-rmse:0.487497 
#&gt; [52] train-rmse:0.320879 test-rmse:0.486324 
#&gt; [53] train-rmse:0.319337 test-rmse:0.485726 
#&gt; [54] train-rmse:0.317468 test-rmse:0.485902 
#&gt; [55] train-rmse:0.316826 test-rmse:0.485982 
#&gt; [56] train-rmse:0.314655 test-rmse:0.486821 
#&gt; [57] train-rmse:0.312849 test-rmse:0.487355 
#&gt; [58] train-rmse:0.312045 test-rmse:0.487324 
#&gt; [59] train-rmse:0.310744 test-rmse:0.487221 
#&gt; [60] train-rmse:0.308556 test-rmse:0.488889 
#&gt; [61] train-rmse:0.306704 test-rmse:0.488557 
#&gt; [62] train-rmse:0.305717 test-rmse:0.488832 
#&gt; [63] train-rmse:0.302922 test-rmse:0.489763 
#&gt; [64] train-rmse:0.300995 test-rmse:0.490850 
#&gt; [65] train-rmse:0.299050 test-rmse:0.491371 
#&gt; [66] train-rmse:0.297149 test-rmse:0.492290 
#&gt; [67] train-rmse:0.295700 test-rmse:0.492574 
#&gt; [68] train-rmse:0.295242 test-rmse:0.492833 
#&gt; [69] train-rmse:0.294881 test-rmse:0.492807 
#&gt; [70] train-rmse:0.293163 test-rmse:0.493658
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-5.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-6.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-7.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-8.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350802 test-rmse:0.350804 
#&gt; [2]  train-rmse:0.246124 test-rmse:0.246126 
#&gt; [3]  train-rmse:0.172682 test-rmse:0.172684 
#&gt; [4]  train-rmse:0.121154 test-rmse:0.121156 
#&gt; [5]  train-rmse:0.085002 test-rmse:0.085004 
#&gt; [6]  train-rmse:0.059638 test-rmse:0.059640 
#&gt; [7]  train-rmse:0.041842 test-rmse:0.041844 
#&gt; [8]  train-rmse:0.029357 test-rmse:0.029358 
#&gt; [9]  train-rmse:0.020597 test-rmse:0.020598 
#&gt; [10] train-rmse:0.014451 test-rmse:0.014451 
#&gt; [11] train-rmse:0.010139 test-rmse:0.010139 
#&gt; [12] train-rmse:0.007113 test-rmse:0.007114 
#&gt; [13] train-rmse:0.004991 test-rmse:0.004991 
#&gt; [14] train-rmse:0.003502 test-rmse:0.003502 
#&gt; [15] train-rmse:0.002457 test-rmse:0.002457 
#&gt; [16] train-rmse:0.001724 test-rmse:0.001724 
#&gt; [17] train-rmse:0.001209 test-rmse:0.001209 
#&gt; [18] train-rmse:0.000848 test-rmse:0.000849 
#&gt; [19] train-rmse:0.000595 test-rmse:0.000595 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-9.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-10.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-11.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-12.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-13.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-14.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.475826 test-rmse:0.481500 
#&gt; [2]  train-rmse:0.459657 test-rmse:0.472443 
#&gt; [3]  train-rmse:0.450397 test-rmse:0.465385 
#&gt; [4]  train-rmse:0.442450 test-rmse:0.462061 
#&gt; [5]  train-rmse:0.434957 test-rmse:0.462729 
#&gt; [6]  train-rmse:0.429407 test-rmse:0.461732 
#&gt; [7]  train-rmse:0.424977 test-rmse:0.462985 
#&gt; [8]  train-rmse:0.420224 test-rmse:0.462965 
#&gt; [9]  train-rmse:0.415484 test-rmse:0.462735 
#&gt; [10] train-rmse:0.413699 test-rmse:0.462835 
#&gt; [11] train-rmse:0.408541 test-rmse:0.464830 
#&gt; [12] train-rmse:0.405177 test-rmse:0.462881 
#&gt; [13] train-rmse:0.403092 test-rmse:0.464161 
#&gt; [14] train-rmse:0.400489 test-rmse:0.465113 
#&gt; [15] train-rmse:0.399295 test-rmse:0.465720 
#&gt; [16] train-rmse:0.396391 test-rmse:0.467182 
#&gt; [17] train-rmse:0.393456 test-rmse:0.469140 
#&gt; [18] train-rmse:0.390611 test-rmse:0.468779 
#&gt; [19] train-rmse:0.388942 test-rmse:0.468704 
#&gt; [20] train-rmse:0.384047 test-rmse:0.470124 
#&gt; [21] train-rmse:0.381096 test-rmse:0.470402 
#&gt; [22] train-rmse:0.380055 test-rmse:0.470720 
#&gt; [23] train-rmse:0.377648 test-rmse:0.470391 
#&gt; [24] train-rmse:0.374757 test-rmse:0.470524 
#&gt; [25] train-rmse:0.372815 test-rmse:0.470675 
#&gt; [26] train-rmse:0.372197 test-rmse:0.471392 
#&gt; [27] train-rmse:0.370336 test-rmse:0.472008 
#&gt; [28] train-rmse:0.369157 test-rmse:0.472623 
#&gt; [29] train-rmse:0.367782 test-rmse:0.473329 
#&gt; [30] train-rmse:0.365917 test-rmse:0.473106 
#&gt; [31] train-rmse:0.363801 test-rmse:0.474664 
#&gt; [32] train-rmse:0.361328 test-rmse:0.474565 
#&gt; [33] train-rmse:0.359178 test-rmse:0.474916 
#&gt; [34] train-rmse:0.357302 test-rmse:0.475243 
#&gt; [35] train-rmse:0.354064 test-rmse:0.476413 
#&gt; [36] train-rmse:0.351931 test-rmse:0.477776 
#&gt; [37] train-rmse:0.350072 test-rmse:0.478116 
#&gt; [38] train-rmse:0.349207 test-rmse:0.478193 
#&gt; [39] train-rmse:0.346550 test-rmse:0.479690 
#&gt; [40] train-rmse:0.343628 test-rmse:0.478700 
#&gt; [41] train-rmse:0.343019 test-rmse:0.478809 
#&gt; [42] train-rmse:0.340757 test-rmse:0.480682 
#&gt; [43] train-rmse:0.338739 test-rmse:0.481500 
#&gt; [44] train-rmse:0.337990 test-rmse:0.481779 
#&gt; [45] train-rmse:0.335377 test-rmse:0.482366 
#&gt; [46] train-rmse:0.334332 test-rmse:0.482275 
#&gt; [47] train-rmse:0.332337 test-rmse:0.484199 
#&gt; [48] train-rmse:0.331546 test-rmse:0.484268 
#&gt; [49] train-rmse:0.330369 test-rmse:0.484690 
#&gt; [50] train-rmse:0.329295 test-rmse:0.484644 
#&gt; [51] train-rmse:0.326743 test-rmse:0.486167 
#&gt; [52] train-rmse:0.324712 test-rmse:0.486878 
#&gt; [53] train-rmse:0.322148 test-rmse:0.487101 
#&gt; [54] train-rmse:0.320578 test-rmse:0.486838 
#&gt; [55] train-rmse:0.319698 test-rmse:0.487108 
#&gt; [56] train-rmse:0.318283 test-rmse:0.487043 
#&gt; [57] train-rmse:0.315816 test-rmse:0.486793 
#&gt; [58] train-rmse:0.314033 test-rmse:0.487445 
#&gt; [59] train-rmse:0.312157 test-rmse:0.487611 
#&gt; [60] train-rmse:0.311287 test-rmse:0.487606 
#&gt; [61] train-rmse:0.310028 test-rmse:0.487976 
#&gt; [62] train-rmse:0.308745 test-rmse:0.489266 
#&gt; [63] train-rmse:0.307336 test-rmse:0.489580 
#&gt; [64] train-rmse:0.306699 test-rmse:0.490017 
#&gt; [65] train-rmse:0.306391 test-rmse:0.490565 
#&gt; [66] train-rmse:0.305921 test-rmse:0.490665 
#&gt; [67] train-rmse:0.303994 test-rmse:0.490936 
#&gt; [68] train-rmse:0.302247 test-rmse:0.490894 
#&gt; [69] train-rmse:0.301744 test-rmse:0.491388 
#&gt; [70] train-rmse:0.299744 test-rmse:0.492478
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-15.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-16.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-17.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-18.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350798 test-rmse:0.350798 
#&gt; [2]  train-rmse:0.246118 test-rmse:0.246119 
#&gt; [3]  train-rmse:0.172676 test-rmse:0.172676 
#&gt; [4]  train-rmse:0.121148 test-rmse:0.121149 
#&gt; [5]  train-rmse:0.084997 test-rmse:0.084998 
#&gt; [6]  train-rmse:0.059634 test-rmse:0.059634 
#&gt; [7]  train-rmse:0.041839 test-rmse:0.041839 
#&gt; [8]  train-rmse:0.029354 test-rmse:0.029354 
#&gt; [9]  train-rmse:0.020595 test-rmse:0.020595 
#&gt; [10] train-rmse:0.014449 test-rmse:0.014449 
#&gt; [11] train-rmse:0.010137 test-rmse:0.010138 
#&gt; [12] train-rmse:0.007112 test-rmse:0.007112 
#&gt; [13] train-rmse:0.004990 test-rmse:0.004990 
#&gt; [14] train-rmse:0.003501 test-rmse:0.003501 
#&gt; [15] train-rmse:0.002456 test-rmse:0.002456 
#&gt; [16] train-rmse:0.001723 test-rmse:0.001723 
#&gt; [17] train-rmse:0.001209 test-rmse:0.001209 
#&gt; [18] train-rmse:0.000848 test-rmse:0.000848 
#&gt; [19] train-rmse:0.000595 test-rmse:0.000595 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-19.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-20.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-21.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-22.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-23.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-24.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.472769 test-rmse:0.482654 
#&gt; [2]  train-rmse:0.455927 test-rmse:0.474974 
#&gt; [3]  train-rmse:0.445050 test-rmse:0.471813 
#&gt; [4]  train-rmse:0.437652 test-rmse:0.470455 
#&gt; [5]  train-rmse:0.432534 test-rmse:0.472091 
#&gt; [6]  train-rmse:0.427086 test-rmse:0.471085 
#&gt; [7]  train-rmse:0.424693 test-rmse:0.470329 
#&gt; [8]  train-rmse:0.423074 test-rmse:0.469975 
#&gt; [9]  train-rmse:0.419267 test-rmse:0.468250 
#&gt; [10] train-rmse:0.416963 test-rmse:0.468207 
#&gt; [11] train-rmse:0.413444 test-rmse:0.467577 
#&gt; [12] train-rmse:0.410447 test-rmse:0.468505 
#&gt; [13] train-rmse:0.406754 test-rmse:0.468206 
#&gt; [14] train-rmse:0.403631 test-rmse:0.469170 
#&gt; [15] train-rmse:0.402640 test-rmse:0.469300 
#&gt; [16] train-rmse:0.401049 test-rmse:0.469462 
#&gt; [17] train-rmse:0.397761 test-rmse:0.469707 
#&gt; [18] train-rmse:0.395251 test-rmse:0.469630 
#&gt; [19] train-rmse:0.392317 test-rmse:0.468573 
#&gt; [20] train-rmse:0.389907 test-rmse:0.468384 
#&gt; [21] train-rmse:0.386263 test-rmse:0.467207 
#&gt; [22] train-rmse:0.385092 test-rmse:0.466582 
#&gt; [23] train-rmse:0.382947 test-rmse:0.468251 
#&gt; [24] train-rmse:0.379480 test-rmse:0.469186 
#&gt; [25] train-rmse:0.377447 test-rmse:0.469316 
#&gt; [26] train-rmse:0.374702 test-rmse:0.469646 
#&gt; [27] train-rmse:0.371630 test-rmse:0.469389 
#&gt; [28] train-rmse:0.369563 test-rmse:0.469242 
#&gt; [29] train-rmse:0.367447 test-rmse:0.469919 
#&gt; [30] train-rmse:0.364762 test-rmse:0.468792 
#&gt; [31] train-rmse:0.362708 test-rmse:0.469501 
#&gt; [32] train-rmse:0.359730 test-rmse:0.469661 
#&gt; [33] train-rmse:0.357905 test-rmse:0.469505 
#&gt; [34] train-rmse:0.356490 test-rmse:0.470354 
#&gt; [35] train-rmse:0.355746 test-rmse:0.470424 
#&gt; [36] train-rmse:0.353715 test-rmse:0.470998 
#&gt; [37] train-rmse:0.352081 test-rmse:0.471469 
#&gt; [38] train-rmse:0.348582 test-rmse:0.472291 
#&gt; [39] train-rmse:0.347687 test-rmse:0.472313 
#&gt; [40] train-rmse:0.345912 test-rmse:0.472007 
#&gt; [41] train-rmse:0.345686 test-rmse:0.471909 
#&gt; [42] train-rmse:0.343115 test-rmse:0.470923 
#&gt; [43] train-rmse:0.341945 test-rmse:0.470430 
#&gt; [44] train-rmse:0.340025 test-rmse:0.470453 
#&gt; [45] train-rmse:0.338328 test-rmse:0.470725 
#&gt; [46] train-rmse:0.337134 test-rmse:0.471166 
#&gt; [47] train-rmse:0.335030 test-rmse:0.471723 
#&gt; [48] train-rmse:0.333215 test-rmse:0.472744 
#&gt; [49] train-rmse:0.332176 test-rmse:0.472636 
#&gt; [50] train-rmse:0.330275 test-rmse:0.472985 
#&gt; [51] train-rmse:0.328481 test-rmse:0.473944 
#&gt; [52] train-rmse:0.328104 test-rmse:0.474638 
#&gt; [53] train-rmse:0.326592 test-rmse:0.474324 
#&gt; [54] train-rmse:0.325568 test-rmse:0.474741 
#&gt; [55] train-rmse:0.323967 test-rmse:0.474859 
#&gt; [56] train-rmse:0.322216 test-rmse:0.475386 
#&gt; [57] train-rmse:0.320249 test-rmse:0.477011 
#&gt; [58] train-rmse:0.318805 test-rmse:0.477852 
#&gt; [59] train-rmse:0.318007 test-rmse:0.478533 
#&gt; [60] train-rmse:0.314959 test-rmse:0.478792 
#&gt; [61] train-rmse:0.313552 test-rmse:0.478426 
#&gt; [62] train-rmse:0.311992 test-rmse:0.477958 
#&gt; [63] train-rmse:0.309770 test-rmse:0.477936 
#&gt; [64] train-rmse:0.308589 test-rmse:0.477971 
#&gt; [65] train-rmse:0.307905 test-rmse:0.478684 
#&gt; [66] train-rmse:0.305894 test-rmse:0.479162 
#&gt; [67] train-rmse:0.304314 test-rmse:0.479473 
#&gt; [68] train-rmse:0.302703 test-rmse:0.479354 
#&gt; [69] train-rmse:0.301543 test-rmse:0.479396 
#&gt; [70] train-rmse:0.301132 test-rmse:0.479597
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-25.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-26.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-27.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-28.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350787 test-rmse:0.350788 
#&gt; [2]  train-rmse:0.246104 test-rmse:0.246105 
#&gt; [3]  train-rmse:0.172660 test-rmse:0.172661 
#&gt; [4]  train-rmse:0.121134 test-rmse:0.121135 
#&gt; [5]  train-rmse:0.084985 test-rmse:0.084986 
#&gt; [6]  train-rmse:0.059623 test-rmse:0.059624 
#&gt; [7]  train-rmse:0.041830 test-rmse:0.041831 
#&gt; [8]  train-rmse:0.029347 test-rmse:0.029347 
#&gt; [9]  train-rmse:0.020589 test-rmse:0.020590 
#&gt; [10] train-rmse:0.014445 test-rmse:0.014445 
#&gt; [11] train-rmse:0.010134 test-rmse:0.010134 
#&gt; [12] train-rmse:0.007110 test-rmse:0.007110 
#&gt; [13] train-rmse:0.004988 test-rmse:0.004988 
#&gt; [14] train-rmse:0.003500 test-rmse:0.003500 
#&gt; [15] train-rmse:0.002455 test-rmse:0.002455 
#&gt; [16] train-rmse:0.001722 test-rmse:0.001723 
#&gt; [17] train-rmse:0.001208 test-rmse:0.001209 
#&gt; [18] train-rmse:0.000848 test-rmse:0.000848 
#&gt; [19] train-rmse:0.000595 test-rmse:0.000595 
#&gt; [20] train-rmse:0.000417 test-rmse:0.000417 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000205 test-rmse:0.000205 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-29.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-30.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-31.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-32.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-33.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-34.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.475532 test-rmse:0.479722 
#&gt; [2]  train-rmse:0.461715 test-rmse:0.469507 
#&gt; [3]  train-rmse:0.450855 test-rmse:0.461037 
#&gt; [4]  train-rmse:0.443802 test-rmse:0.459167 
#&gt; [5]  train-rmse:0.438438 test-rmse:0.457998 
#&gt; [6]  train-rmse:0.434583 test-rmse:0.458561 
#&gt; [7]  train-rmse:0.431620 test-rmse:0.455979 
#&gt; [8]  train-rmse:0.428429 test-rmse:0.455833 
#&gt; [9]  train-rmse:0.426257 test-rmse:0.456038 
#&gt; [10] train-rmse:0.422599 test-rmse:0.456239 
#&gt; [11] train-rmse:0.418804 test-rmse:0.455760 
#&gt; [12] train-rmse:0.417226 test-rmse:0.455697 
#&gt; [13] train-rmse:0.414559 test-rmse:0.456316 
#&gt; [14] train-rmse:0.411412 test-rmse:0.455462 
#&gt; [15] train-rmse:0.408283 test-rmse:0.455988 
#&gt; [16] train-rmse:0.407567 test-rmse:0.455761 
#&gt; [17] train-rmse:0.405276 test-rmse:0.456471 
#&gt; [18] train-rmse:0.403403 test-rmse:0.457584 
#&gt; [19] train-rmse:0.400764 test-rmse:0.457745 
#&gt; [20] train-rmse:0.399792 test-rmse:0.458031 
#&gt; [21] train-rmse:0.396750 test-rmse:0.458245 
#&gt; [22] train-rmse:0.393334 test-rmse:0.459049 
#&gt; [23] train-rmse:0.391641 test-rmse:0.460172 
#&gt; [24] train-rmse:0.390145 test-rmse:0.459686 
#&gt; [25] train-rmse:0.386848 test-rmse:0.461748 
#&gt; [26] train-rmse:0.383815 test-rmse:0.462019 
#&gt; [27] train-rmse:0.382860 test-rmse:0.461958 
#&gt; [28] train-rmse:0.380752 test-rmse:0.462361 
#&gt; [29] train-rmse:0.379025 test-rmse:0.463454 
#&gt; [30] train-rmse:0.376613 test-rmse:0.463279 
#&gt; [31] train-rmse:0.375179 test-rmse:0.462394 
#&gt; [32] train-rmse:0.372078 test-rmse:0.462297 
#&gt; [33] train-rmse:0.370390 test-rmse:0.461997 
#&gt; [34] train-rmse:0.367370 test-rmse:0.461258 
#&gt; [35] train-rmse:0.365171 test-rmse:0.461642 
#&gt; [36] train-rmse:0.364556 test-rmse:0.462097 
#&gt; [37] train-rmse:0.362250 test-rmse:0.463210 
#&gt; [38] train-rmse:0.360822 test-rmse:0.463464 
#&gt; [39] train-rmse:0.359736 test-rmse:0.464817 
#&gt; [40] train-rmse:0.357757 test-rmse:0.465533 
#&gt; [41] train-rmse:0.355711 test-rmse:0.464467 
#&gt; [42] train-rmse:0.353179 test-rmse:0.464570 
#&gt; [43] train-rmse:0.350284 test-rmse:0.465779 
#&gt; [44] train-rmse:0.348136 test-rmse:0.466365 
#&gt; [45] train-rmse:0.346818 test-rmse:0.466977 
#&gt; [46] train-rmse:0.344784 test-rmse:0.466445 
#&gt; [47] train-rmse:0.343106 test-rmse:0.466392 
#&gt; [48] train-rmse:0.340745 test-rmse:0.466662 
#&gt; [49] train-rmse:0.338533 test-rmse:0.466695 
#&gt; [50] train-rmse:0.337674 test-rmse:0.466918 
#&gt; [51] train-rmse:0.335752 test-rmse:0.467161 
#&gt; [52] train-rmse:0.333461 test-rmse:0.467704 
#&gt; [53] train-rmse:0.331401 test-rmse:0.467842 
#&gt; [54] train-rmse:0.329978 test-rmse:0.468242 
#&gt; [55] train-rmse:0.328074 test-rmse:0.469040 
#&gt; [56] train-rmse:0.327299 test-rmse:0.469125 
#&gt; [57] train-rmse:0.326539 test-rmse:0.469162 
#&gt; [58] train-rmse:0.325743 test-rmse:0.469178 
#&gt; [59] train-rmse:0.323197 test-rmse:0.468921 
#&gt; [60] train-rmse:0.321051 test-rmse:0.469180 
#&gt; [61] train-rmse:0.318822 test-rmse:0.468901 
#&gt; [62] train-rmse:0.317071 test-rmse:0.468493 
#&gt; [63] train-rmse:0.315341 test-rmse:0.469553 
#&gt; [64] train-rmse:0.313901 test-rmse:0.470131 
#&gt; [65] train-rmse:0.312277 test-rmse:0.470533 
#&gt; [66] train-rmse:0.310928 test-rmse:0.470303 
#&gt; [67] train-rmse:0.309997 test-rmse:0.470076 
#&gt; [68] train-rmse:0.309665 test-rmse:0.470048 
#&gt; [69] train-rmse:0.308328 test-rmse:0.470354 
#&gt; [70] train-rmse:0.306956 test-rmse:0.470402
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-35.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-36.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-37.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-38.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350813 test-rmse:0.350813 
#&gt; [2]  train-rmse:0.246140 test-rmse:0.246140 
#&gt; [3]  train-rmse:0.172698 test-rmse:0.172698 
#&gt; [4]  train-rmse:0.121169 test-rmse:0.121170 
#&gt; [5]  train-rmse:0.085016 test-rmse:0.085016 
#&gt; [6]  train-rmse:0.059649 test-rmse:0.059649 
#&gt; [7]  train-rmse:0.041851 test-rmse:0.041851 
#&gt; [8]  train-rmse:0.029364 test-rmse:0.029364 
#&gt; [9]  train-rmse:0.020603 test-rmse:0.020603 
#&gt; [10] train-rmse:0.014455 test-rmse:0.014455 
#&gt; [11] train-rmse:0.010142 test-rmse:0.010142 
#&gt; [12] train-rmse:0.007116 test-rmse:0.007116 
#&gt; [13] train-rmse:0.004993 test-rmse:0.004993 
#&gt; [14] train-rmse:0.003503 test-rmse:0.003503 
#&gt; [15] train-rmse:0.002458 test-rmse:0.002458 
#&gt; [16] train-rmse:0.001724 test-rmse:0.001724 
#&gt; [17] train-rmse:0.001210 test-rmse:0.001210 
#&gt; [18] train-rmse:0.000849 test-rmse:0.000849 
#&gt; [19] train-rmse:0.000596 test-rmse:0.000596 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-39.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-40.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-41.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-42.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-43.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-44.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.473850 test-rmse:0.479414 
#&gt; [2]  train-rmse:0.459094 test-rmse:0.469794 
#&gt; [3]  train-rmse:0.449354 test-rmse:0.461877 
#&gt; [4]  train-rmse:0.443149 test-rmse:0.459174 
#&gt; [5]  train-rmse:0.437627 test-rmse:0.459811 
#&gt; [6]  train-rmse:0.432413 test-rmse:0.460721 
#&gt; [7]  train-rmse:0.428558 test-rmse:0.462380 
#&gt; [8]  train-rmse:0.425258 test-rmse:0.462570 
#&gt; [9]  train-rmse:0.423077 test-rmse:0.461556 
#&gt; [10] train-rmse:0.418896 test-rmse:0.462989 
#&gt; [11] train-rmse:0.416189 test-rmse:0.464328 
#&gt; [12] train-rmse:0.414683 test-rmse:0.463995 
#&gt; [13] train-rmse:0.411538 test-rmse:0.462447 
#&gt; [14] train-rmse:0.410403 test-rmse:0.462092 
#&gt; [15] train-rmse:0.407792 test-rmse:0.463728 
#&gt; [16] train-rmse:0.404779 test-rmse:0.464408 
#&gt; [17] train-rmse:0.402084 test-rmse:0.464279 
#&gt; [18] train-rmse:0.398376 test-rmse:0.464539 
#&gt; [19] train-rmse:0.395787 test-rmse:0.464975 
#&gt; [20] train-rmse:0.393919 test-rmse:0.466032 
#&gt; [21] train-rmse:0.391891 test-rmse:0.465225 
#&gt; [22] train-rmse:0.390346 test-rmse:0.464729 
#&gt; [23] train-rmse:0.387206 test-rmse:0.465898 
#&gt; [24] train-rmse:0.384101 test-rmse:0.465737 
#&gt; [25] train-rmse:0.383148 test-rmse:0.465977 
#&gt; [26] train-rmse:0.382018 test-rmse:0.465669 
#&gt; [27] train-rmse:0.378659 test-rmse:0.467162 
#&gt; [28] train-rmse:0.376657 test-rmse:0.469619 
#&gt; [29] train-rmse:0.373677 test-rmse:0.468774 
#&gt; [30] train-rmse:0.371718 test-rmse:0.469019 
#&gt; [31] train-rmse:0.368742 test-rmse:0.469019 
#&gt; [32] train-rmse:0.365627 test-rmse:0.470020 
#&gt; [33] train-rmse:0.363830 test-rmse:0.472418 
#&gt; [34] train-rmse:0.360158 test-rmse:0.473165 
#&gt; [35] train-rmse:0.357578 test-rmse:0.472734 
#&gt; [36] train-rmse:0.356505 test-rmse:0.473035 
#&gt; [37] train-rmse:0.353059 test-rmse:0.472369 
#&gt; [38] train-rmse:0.351706 test-rmse:0.472498 
#&gt; [39] train-rmse:0.351316 test-rmse:0.472638 
#&gt; [40] train-rmse:0.350547 test-rmse:0.473132 
#&gt; [41] train-rmse:0.347650 test-rmse:0.473525 
#&gt; [42] train-rmse:0.345427 test-rmse:0.475680 
#&gt; [43] train-rmse:0.343986 test-rmse:0.476514 
#&gt; [44] train-rmse:0.342900 test-rmse:0.477205 
#&gt; [45] train-rmse:0.341841 test-rmse:0.478580 
#&gt; [46] train-rmse:0.340976 test-rmse:0.478855 
#&gt; [47] train-rmse:0.338885 test-rmse:0.478731 
#&gt; [48] train-rmse:0.336912 test-rmse:0.478227 
#&gt; [49] train-rmse:0.333370 test-rmse:0.479379 
#&gt; [50] train-rmse:0.331511 test-rmse:0.480517 
#&gt; [51] train-rmse:0.328791 test-rmse:0.480654 
#&gt; [52] train-rmse:0.327809 test-rmse:0.480366 
#&gt; [53] train-rmse:0.325429 test-rmse:0.481282 
#&gt; [54] train-rmse:0.324589 test-rmse:0.481796 
#&gt; [55] train-rmse:0.323163 test-rmse:0.482088 
#&gt; [56] train-rmse:0.322723 test-rmse:0.482131 
#&gt; [57] train-rmse:0.320544 test-rmse:0.482739 
#&gt; [58] train-rmse:0.318653 test-rmse:0.484235 
#&gt; [59] train-rmse:0.316577 test-rmse:0.484282 
#&gt; [60] train-rmse:0.315825 test-rmse:0.484865 
#&gt; [61] train-rmse:0.315498 test-rmse:0.484841 
#&gt; [62] train-rmse:0.313831 test-rmse:0.485849 
#&gt; [63] train-rmse:0.313020 test-rmse:0.486368 
#&gt; [64] train-rmse:0.311073 test-rmse:0.487467 
#&gt; [65] train-rmse:0.309329 test-rmse:0.488293 
#&gt; [66] train-rmse:0.308715 test-rmse:0.488110 
#&gt; [67] train-rmse:0.307195 test-rmse:0.487954 
#&gt; [68] train-rmse:0.304213 test-rmse:0.488320 
#&gt; [69] train-rmse:0.301896 test-rmse:0.487969 
#&gt; [70] train-rmse:0.299934 test-rmse:0.489176
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-45.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-46.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-47.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-48.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350824 test-rmse:0.350826 
#&gt; [2]  train-rmse:0.246155 test-rmse:0.246158 
#&gt; [3]  train-rmse:0.172714 test-rmse:0.172718 
#&gt; [4]  train-rmse:0.121185 test-rmse:0.121188 
#&gt; [5]  train-rmse:0.085029 test-rmse:0.085032 
#&gt; [6]  train-rmse:0.059660 test-rmse:0.059663 
#&gt; [7]  train-rmse:0.041861 test-rmse:0.041863 
#&gt; [8]  train-rmse:0.029371 test-rmse:0.029373 
#&gt; [9]  train-rmse:0.020608 test-rmse:0.020610 
#&gt; [10] train-rmse:0.014460 test-rmse:0.014461 
#&gt; [11] train-rmse:0.010146 test-rmse:0.010146 
#&gt; [12] train-rmse:0.007119 test-rmse:0.007119 
#&gt; [13] train-rmse:0.004995 test-rmse:0.004995 
#&gt; [14] train-rmse:0.003505 test-rmse:0.003505 
#&gt; [15] train-rmse:0.002459 test-rmse:0.002459 
#&gt; [16] train-rmse:0.001725 test-rmse:0.001726 
#&gt; [17] train-rmse:0.001211 test-rmse:0.001211 
#&gt; [18] train-rmse:0.000849 test-rmse:0.000850 
#&gt; [19] train-rmse:0.000596 test-rmse:0.000596 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<p><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-49.png" width="672"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-50.png" width="672"></p>
<pre><code>#&gt;                     Model  Accuracy
#&gt; 1                     C50 1.0000000
#&gt; 2                  Cubist 1.0000000
#&gt; 3       Ensemble_ADABoost 1.0000000
#&gt; 4            Ensemble_C50 1.0000000
#&gt; 5  Ensemble_Random_Forest 1.0000000
#&gt; 6        Ensemble_XGBoost 1.0000000
#&gt; 7           Random_Forest 1.0000000
#&gt; 8                BayesGLM 0.6479583
#&gt; 9                 XGBoost 0.6437120
#&gt; 10               ADABoost 0.6191110</code></pre>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></div>
<div class="next"><a href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/InfiniteCuriosity/EnsemblesBook/blob/master/07-Ensembles_of_Logistic_Models.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/InfiniteCuriosity/EnsemblesBook/edit/master/07-Ensembles_of_Logistic_Models.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Ensembles: From Beginner to Expert</strong>" was written by Russ Conte. It was last built on 2024-06-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
