<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert</title>
<meta name="author" content="Russ Conte">
<meta name="description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert">
<meta property="og:type" content="book">
<meta property="og:description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles | Ensembles: From Beginner to Expert">
<meta name="twitter:description" content="In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps: Load the library...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Ensembles: From Beginner to Expert</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></li>
<li><a class="" href="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions.html"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a></li>
<li><a class="" href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></li>
<li><a class="" href="classification-data-how-to-make-14-individual-classification-models.html"><span class="header-section-number">5</span> Classification data: How to make 14 individual classification models</a></li>
<li><a class="" href="building-ensembles-of-classification-models.html"><span class="header-section-number">6</span> Building ensembles of classification models</a></li>
<li><a class="" href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></li>
<li><a class="active" href="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles.html"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li>
<li><a class="" href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></li>
<li><a class="" href="ensembles-of-26-forecasting-models.html"><span class="header-section-number">10</span> Ensembles of 26 Forecasting Models</a></li>
<li><a class="" href="predicting-on-totally-new-data-with-individual-models-and-ensembles.html"><span class="header-section-number">11</span> Predicting on totally new data with individual models and ensembles</a></li>
<li><a class="" href="how-to-communicate-your-results.html"><span class="header-section-number">12</span> How to communicate your results</a></li>
<li><a class="" href="final-comprhensive-project.html"><span class="header-section-number">13</span> Final Comprhensive Project</a></li>
<li><a class="" href="summary-and-charge-to-the-graduates-of-the-class.html"><span class="header-section-number">14</span> Summary and Charge to the Graduates of the Class!</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/InfinteCuriosity/EnsemblesBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles<a class="anchor" aria-label="anchor" href="#advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles"><i class="fas fa-link"></i></a>
</h1>
<p>In this section we’re going to take the lessons of the previous chapter and move them into making ensembles of models. The process is extremely similar, and follows these steps:</p>
<blockquote>
<p>Load the library</p>
<p>Set initial values to 0</p>
<p>Create the function</p>
<p>Set up random resampling</p>
<p>Break the data into train and test</p>
<p>Fit the model on the training data, make predictions and measure error on the test data</p>
<p>Return the results</p>
<p>Check for errors or warnings</p>
<p>Test on a different data set</p>
</blockquote>
<p>Logistic ensembles can be used in an extremely wide range of fields. Previously we modeled diabetes in Pima Indian women. This chapter’s example will be the performance on the court of Lebron James.</p>
<p>Here’s an image of Lebron in play.</p>
<div class="float">
<img src="_book/images/LeBron_James_small.jpg" alt="Lebron James"><div class="figcaption">Lebron James</div>
</div>
<p>There is a LOT of data in sports and HR analytics (which are extremely similar in some ways). A lot of the data is set up as logistic data. For example, here is a data set of the performance of Lebron James. The main column of interest is “result”, which is either 1 or 0. Thus it perfectly fits our requirements for logistic analysis.</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://infinitecuriosity.github.io/Ensembles/">Ensembles</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: arm</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: lme4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arm (Version 1.14-4, built: 2024-4-1)</span></span>
<span><span class="co">#&gt; Working directory is /Users/russellconte/Library/Mobile Documents/com~apple~CloudDocs/Documents/Machine Learning templates in R/EnsemblesBook</span></span>
<span><span class="co">#&gt; Loading required package: brnn</span></span>
<span><span class="co">#&gt; Loading required package: Formula</span></span>
<span><span class="co">#&gt; Loading required package: truncnorm</span></span>
<span><span class="co">#&gt; Loading required package: broom</span></span>
<span><span class="co">#&gt; Loading required package: C50</span></span>
<span><span class="co">#&gt; Loading required package: caret</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span>
<span><span class="co">#&gt; Loading required package: class</span></span>
<span><span class="co">#&gt; Loading required package: corrplot</span></span>
<span><span class="co">#&gt; corrplot 0.92 loaded</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'corrplot'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     corrplot</span></span>
<span><span class="co">#&gt; Loading required package: Cubist</span></span>
<span><span class="co">#&gt; Loading required package: doParallel</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; Loading required package: iterators</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="co">#&gt; Loading required package: e1071</span></span>
<span><span class="co">#&gt; Loading required package: fable</span></span>
<span><span class="co">#&gt; Loading required package: fabletools</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'tsibble':</span></span>
<span><span class="co">#&gt;   method          from</span></span>
<span><span class="co">#&gt;   format.interval inum</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'fabletools'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:e1071':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     interpolate</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     MAE, RMSE</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:lme4':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     refit</span></span>
<span><span class="co">#&gt; Loading required package: fable.prophet</span></span>
<span><span class="co">#&gt; Loading required package: Rcpp</span></span>
<span><span class="co">#&gt; Loading required package: feasts</span></span>
<span><span class="co">#&gt; Loading required package: gam</span></span>
<span><span class="co">#&gt; Loading required package: splines</span></span>
<span><span class="co">#&gt; Loaded gam 1.22-3</span></span>
<span><span class="co">#&gt; Loading required package: gbm</span></span>
<span><span class="co">#&gt; Loaded gbm 2.1.9</span></span>
<span><span class="co">#&gt; This version of gbm is no longer under development. Consider transitioning to gbm3, https://github.com/gbm-developers/gbm3</span></span>
<span><span class="co">#&gt; Loading required package: GGally</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span>
<span><span class="co">#&gt; Loading required package: glmnet</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span>
<span><span class="co">#&gt; Loading required package: gridExtra</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'gridExtra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; Loading required package: gt</span></span>
<span><span class="co">#&gt; Loading required package: gtExtras</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'gtExtras'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MASS':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; Loading required package: ipred</span></span>
<span><span class="co">#&gt; Loading required package: kernlab</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kernlab'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     alpha</span></span>
<span><span class="co">#&gt; Loading required package: klaR</span></span>
<span><span class="co">#&gt; Loading required package: leaps</span></span>
<span><span class="co">#&gt; Loading required package: MachineShop</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'MachineShop'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:fabletools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy, response</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     calibration, lift, precision, recall, rfe,</span></span>
<span><span class="co">#&gt;     sensitivity, specificity</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     ppr</span></span>
<span><span class="co">#&gt; Loading required package: magrittr</span></span>
<span><span class="co">#&gt; Loading required package: mda</span></span>
<span><span class="co">#&gt; Loaded mda 0.5-4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'mda'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     confusion</span></span>
<span><span class="co">#&gt; Loading required package: Metrics</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Metrics'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy, auc, mae, mse, msle, precision, recall,</span></span>
<span><span class="co">#&gt;     rmse, rmsle</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:fabletools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accuracy</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     precision, recall</span></span>
<span><span class="co">#&gt; Loading required package: neuralnet</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'neuralnet'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     compute</span></span>
<span><span class="co">#&gt; Loading required package: pls</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pls'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:corrplot':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     R2</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     coefplot, corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span>
<span><span class="co">#&gt; Loading required package: pROC</span></span>
<span><span class="co">#&gt; Type 'citation("pROC")' for a citation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pROC'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:Metrics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     auc</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     auc</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cov, smooth, var</span></span>
<span><span class="co">#&gt; Loading required package: purrr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'purrr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     set_names</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:MachineShop':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lift</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:kernlab':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cross</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:foreach':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accumulate, when</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:caret':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lift</span></span>
<span><span class="co">#&gt; Loading required package: randomForest</span></span>
<span><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'randomForest'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:gridExtra':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; Loading required package: reactable</span></span>
<span><span class="co">#&gt; Loading required package: reactablefmtr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'reactablefmtr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:randomForest':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:gt':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     google_font, html</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span>
<span><span class="co">#&gt; Loading required package: readr</span></span>
<span><span class="co">#&gt; Loading required package: rpart</span></span>
<span><span class="co">#&gt; Loading required package: scales</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'scales'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:readr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     col_factor</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     discard</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:kernlab':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     alpha</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rescale</span></span>
<span><span class="co">#&gt; Loading required package: tibble</span></span>
<span><span class="co">#&gt; Loading required package: tidyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:magrittr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extract</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:Matrix':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     expand, pack, unpack</span></span>
<span><span class="co">#&gt; Loading required package: tree</span></span>
<span><span class="co">#&gt; Loading required package: tsibble</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tsibble'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, union</span></span>
<span><span class="co">#&gt; Loading required package: xgboost</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'xgboost'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     slice</span></span></code></pre></div>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">lebron</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;    top left  date qtr time_remaining result shot_type</span></span>
<span><span class="co">#&gt; 1  310  203 19283   2            566      0         3</span></span>
<span><span class="co">#&gt; 2  213  259 19283   2            518      0         2</span></span>
<span><span class="co">#&gt; 3  143  171 19283   2            490      0         2</span></span>
<span><span class="co">#&gt; 4   68  215 19283   2            324      1         2</span></span>
<span><span class="co">#&gt; 5   66  470 19283   2             62      0         3</span></span>
<span><span class="co">#&gt; 6   63  239 19283   4            690      1         2</span></span>
<span><span class="co">#&gt; 7  230   54 19283   4            630      0         3</span></span>
<span><span class="co">#&gt; 8   53  224 19283   4            605      1         2</span></span>
<span><span class="co">#&gt; 9  241   67 19283   4            570      0         3</span></span>
<span><span class="co">#&gt; 10 273  113 19283   4            535      0         3</span></span>
<span><span class="co">#&gt; 11  62  224 19283   4            426      0         2</span></span>
<span><span class="co">#&gt; 12  63  249 19283   4            233      1         2</span></span>
<span><span class="co">#&gt; 13 103  236 19283   4            154      0         2</span></span>
<span><span class="co">#&gt; 14  54  249 19283   4            108      1         2</span></span>
<span><span class="co">#&gt; 15  53  240 19283   4             58      0         2</span></span>
<span><span class="co">#&gt; 16 230   71 19283   5            649      1         3</span></span>
<span><span class="co">#&gt; 17 231  358 19283   5            540      0         2</span></span>
<span><span class="co">#&gt; 18  61  240 19283   5            524      1         2</span></span>
<span><span class="co">#&gt; 19  59  235 19283   5             71      1         2</span></span>
<span><span class="co">#&gt; 20 299  188 19283   5              6      1         3</span></span>
<span><span class="co">#&gt;    distance_ft lead lebron_team_score opponent_team_score</span></span>
<span><span class="co">#&gt; 1           26    0                 2                   2</span></span>
<span><span class="co">#&gt; 2           16    0                 4                   5</span></span>
<span><span class="co">#&gt; 3           11    0                 4                   7</span></span>
<span><span class="co">#&gt; 4            3    0                12                  19</span></span>
<span><span class="co">#&gt; 5           23    0                22                  23</span></span>
<span><span class="co">#&gt; 6            1    0                24                  25</span></span>
<span><span class="co">#&gt; 7           26    0                24                  27</span></span>
<span><span class="co">#&gt; 8            2    0                26                  27</span></span>
<span><span class="co">#&gt; 9           26    0                26                  29</span></span>
<span><span class="co">#&gt; 10          25    0                26                  32</span></span>
<span><span class="co">#&gt; 11           2    0                31                  39</span></span>
<span><span class="co">#&gt; 12           1    0                39                  49</span></span>
<span><span class="co">#&gt; 13           5    0                39                  51</span></span>
<span><span class="co">#&gt; 14           1    0                44                  53</span></span>
<span><span class="co">#&gt; 15           0    0                46                  55</span></span>
<span><span class="co">#&gt; 16          25    0                58                  63</span></span>
<span><span class="co">#&gt; 17          21    0                60                  70</span></span>
<span><span class="co">#&gt; 18           1    0                62                  70</span></span>
<span><span class="co">#&gt; 19           1    0                68                  91</span></span>
<span><span class="co">#&gt; 20          25    0                71                  91</span></span>
<span><span class="co">#&gt;    opponent</span></span>
<span><span class="co">#&gt; 1         9</span></span>
<span><span class="co">#&gt; 2         9</span></span>
<span><span class="co">#&gt; 3         9</span></span>
<span><span class="co">#&gt; 4         9</span></span>
<span><span class="co">#&gt; 5         9</span></span>
<span><span class="co">#&gt; 6         9</span></span>
<span><span class="co">#&gt; 7         9</span></span>
<span><span class="co">#&gt; 8         9</span></span>
<span><span class="co">#&gt; 9         9</span></span>
<span><span class="co">#&gt; 10        9</span></span>
<span><span class="co">#&gt; 11        9</span></span>
<span><span class="co">#&gt; 12        9</span></span>
<span><span class="co">#&gt; 13        9</span></span>
<span><span class="co">#&gt; 14        9</span></span>
<span><span class="co">#&gt; 15        9</span></span>
<span><span class="co">#&gt; 16        9</span></span>
<span><span class="co">#&gt; 17        9</span></span>
<span><span class="co">#&gt; 18        9</span></span>
<span><span class="co">#&gt; 19        9</span></span>
<span><span class="co">#&gt; 20        9</span></span></code></pre></div>
<p>Let’s look at the structure of the data:</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lebron</span> <span class="op">&lt;-</span> <span class="fu">Ensembles</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Ensembles/man/lebron.html">lebron</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu">Ensembles</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/Ensembles/man/lebron.html">lebron</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1533 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;  $ top                : int  310 213 143 68 66 63 230 53 241 273 ...</span></span>
<span><span class="co">#&gt;  $ left               : int  203 259 171 215 470 239 54 224 67 113 ...</span></span>
<span><span class="co">#&gt;  $ date               : num  19283 19283 19283 19283 19283 ...</span></span>
<span><span class="co">#&gt;  $ qtr                : num  2 2 2 2 2 4 4 4 4 4 ...</span></span>
<span><span class="co">#&gt;  $ time_remaining     : num  566 518 490 324 62 690 630 605 570 535 ...</span></span>
<span><span class="co">#&gt;  $ result             : num  0 0 0 1 0 1 0 1 0 0 ...</span></span>
<span><span class="co">#&gt;  $ shot_type          : int  3 2 2 2 3 2 3 2 3 3 ...</span></span>
<span><span class="co">#&gt;  $ distance_ft        : int  26 16 11 3 23 1 26 2 26 25 ...</span></span>
<span><span class="co">#&gt;  $ lead               : num  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ lebron_team_score  : int  2 4 4 12 22 24 24 26 26 26 ...</span></span>
<span><span class="co">#&gt;  $ opponent_team_score: int  2 5 7 19 23 25 27 27 29 32 ...</span></span>
<span><span class="co">#&gt;  $ opponent           : num  9 9 9 9 9 9 9 9 9 9 ...</span></span></code></pre></div>
<p>We see that all of these are numbers. It might be easier if “qtr” and “opponent” were changed to factors, so we’ll do that first.</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">lebron</span><span class="op">$</span><span class="va">qtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lebron</span><span class="op">$</span><span class="va">qtr</span><span class="op">)</span></span>
<span><span class="va">lebron</span><span class="op">$</span><span class="va">opponent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">lebron</span><span class="op">$</span><span class="va">opponent</span><span class="op">)</span></span></code></pre></div>
<p>Now we’re ready to create an ensemble of models to make predictions about Lebron’s future performance. The new skill in this chapter will be saving all trained models to the Environment. This will allow us to look at the trained models, and use them to make the strongest evidence based recommendations.</p>
<p>We will use the following individual models and ensemble of models:</p>
<p>Individual models:</p>
<p>AdaBoost</p>
<p>BayesGLM</p>
<p>C50</p>
<p>Cubist</p>
<p>Generalized Linear Models (GLM)</p>
<p>Random Forest</p>
<p>XGBoost</p>
<p>We will make an ensemble of the predictions from those five models, and then use that ensemble to model predictions for Lebron’s performance.</p>
<p>We will also show the ROC curves for each of the results, and save all the trained models at the end.</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load libraries - note these will work with individual and ensemble models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span> <span class="co"># to use with BayesGLM</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/C5.0/">C50</a></span><span class="op">)</span> <span class="co"># To use with C50</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/Cubist//">Cubist</a></span><span class="op">)</span> <span class="co"># To use with Cubist modeling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://brian-j-smith.github.io/MachineShop/">MachineShop</a></span><span class="op">)</span><span class="co"># To use with ADABoost</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span> <span class="co"># Random Forest models</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># My favorite tool for data science!</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ purrr::accumulate()     masks foreach::accumulate()</span></span>
<span><span class="co">#&gt; ✖ scales::alpha()         masks kernlab::alpha(), ggplot2::alpha()</span></span>
<span><span class="co">#&gt; ✖ scales::col_factor()    masks readr::col_factor()</span></span>
<span><span class="co">#&gt; ✖ randomForest::combine() masks gridExtra::combine(), dplyr::combine()</span></span>
<span><span class="co">#&gt; ✖ neuralnet::compute()    masks dplyr::compute()</span></span>
<span><span class="co">#&gt; ✖ purrr::cross()          masks kernlab::cross()</span></span>
<span><span class="co">#&gt; ✖ scales::discard()       masks purrr::discard()</span></span>
<span><span class="co">#&gt; ✖ tidyr::expand()         masks Matrix::expand()</span></span>
<span><span class="co">#&gt; ✖ tidyr::extract()        masks magrittr::extract()</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter()         masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ lubridate::interval()   masks tsibble::interval()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()            masks stats::lag()</span></span>
<span><span class="co">#&gt; ✖ purrr::lift()           masks MachineShop::lift(), caret::lift()</span></span>
<span><span class="co">#&gt; ✖ reactablefmtr::margin() masks randomForest::margin(), ggplot2::margin()</span></span>
<span><span class="co">#&gt; ✖ tidyr::pack()           masks Matrix::pack()</span></span>
<span><span class="co">#&gt; ✖ gtExtras::select()      masks dplyr::select(), MASS::select()</span></span>
<span><span class="co">#&gt; ✖ purrr::set_names()      masks magrittr::set_names()</span></span>
<span><span class="co">#&gt; ✖ xgboost::slice()        masks dplyr::slice()</span></span>
<span><span class="co">#&gt; ✖ tidyr::unpack()         masks Matrix::unpack()</span></span>
<span><span class="co">#&gt; ✖ purrr::when()           masks foreach::when()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span></code></pre></div>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span> <span class="co"># To print ROC curves</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">adaboost_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">bayesglm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">C50_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">cubist_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">rf_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">xgb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span></span>
<span><span class="va">ensemble_adaboost_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_bayesglm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_bayesglm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_C50_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_C50_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_rf_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">ensemble_xgb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ensemble_xgb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">logistic_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span><span class="co"># Set up random resampling</span></span>
<span>  </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span><span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>  </span>
<span>  </span>
<span><span class="co"># ADABoost model</span></span>
<span><span class="va">adaboost_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MachineShop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MachineShop/man/fit-methods.html">fit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, model <span class="op">=</span> <span class="st">"AdaBoostModel"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adaboost_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">adaboost_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ADAboost Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">adaboost_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># BayesGLM</span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">arm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/bayesglm.html">bayesglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bayesglm_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">bayesglm_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Bayesglm Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">bayesglm_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># C50 model</span></span>
<span></span>
<span><span class="va">C50_train_fit</span> <span class="op">&lt;-</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html">C5.0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_train_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_train_table</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_test_table</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">C50_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">C50_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C50 ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">C50_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Cubist</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;-</span> <span class="fu">Cubist</span><span class="fu">::</span><span class="fu"><a href="http://topepo.github.io/Cubist/reference/cubist.default.html">cubist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">cubist_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_train_pred</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_train_table</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cubist_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_test_pred</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_test_table</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">cubist_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">cubist_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Cubist ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">cubist_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Random Forest</span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">rf_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_train_probabilities</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_train_table</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_test_table</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">rf_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Random Forest "</span>, <span class="st">"(AUC = "</span>, <span class="va">rf_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># XGBoost</span></span>
<span><span class="va">train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">train_y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">test_y</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define final train and test sets</span></span>
<span><span class="va">xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_x</span>, label <span class="op">=</span> <span class="va">train_y</span><span class="op">)</span></span>
<span><span class="va">xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_x</span>, label <span class="op">=</span> <span class="va">test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span><span class="op">)</span></span>
<span><span class="va">watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span>, test <span class="op">=</span> <span class="va">xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">train_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_train_table</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">test_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_test_table</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">xgb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"XGBoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">xgb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble</span></span>
<span></span>
<span><span class="va">ensemble1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">'ADABoost'</span> <span class="op">=</span> <span class="va">adaboost_test_predictions</span>,</span>
<span>  <span class="st">'BayesGLM'</span><span class="op">=</span> <span class="va">bayesglm_test_predictions</span>,</span>
<span>  <span class="st">'C50'</span> <span class="op">=</span> <span class="va">C50_test_predictions</span>,</span>
<span>  <span class="st">'Cubist'</span> <span class="op">=</span> <span class="va">cubist_test_pred</span>,</span>
<span>  <span class="st">'Random_Forest'</span> <span class="op">=</span> <span class="va">rf_test_pred</span>,</span>
<span>  <span class="st">'XGBoost'</span> <span class="op">=</span> <span class="va">xgb_test_predictions</span>,</span>
<span>  <span class="st">'y'</span> <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ensemble1</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_train</span> <span class="op">&lt;-</span> <span class="va">ensemble1</span><span class="op">[</span><span class="va">ensemble_index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">ensemble_test</span> <span class="op">&lt;-</span> <span class="va">ensemble1</span><span class="op">[</span><span class="va">ensemble_index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="va">ensemble_y_train</span> <span class="op">&lt;-</span> <span class="va">ensemble_train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">ensemble_y_test</span> <span class="op">&lt;-</span> <span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span><span class="co"># Ensemble ADABoost</span></span>
<span><span class="va">ensemble_adaboost_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MachineShop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MachineShop/man/fit-methods.html">fit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ensemble_train</span>, model <span class="op">=</span> <span class="st">"AdaBoostModel"</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_adaboost_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_adaboost_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_adaboost_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_adaboost_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_adaboost_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_holdout_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">ensemble_adaboost_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_adaboost_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_adaboost_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_adaboost_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble Adaboostoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_adaboost_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Ensembles using C50</span></span>
<span><span class="va">ensemble_C50_train_fit</span> <span class="op">&lt;-</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html">C5.0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ensemble_y_train</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">ensemble_train</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_C50_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_C50_train_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_C50_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_C50_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_C50_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_C50_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_C50_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_C50_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_C50_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_C50_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_C50_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_C50_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_C50_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_C50_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_C50_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_C50_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble_C50 "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_C50_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble Random Forest</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ensemble_train</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">ensemble_y_train</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">ensemble1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_rf_train_fit</span>, <span class="va">ensemble_train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_rf_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">ensemble_rf_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_rf_train_predictions</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_rf_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_rf_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_rf_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_rf_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ensemble_rf_train_fit</span>, <span class="va">ensemble_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_rf_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">ensemble_rf_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_rf_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_rf_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_rf_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_rf_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_rf_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_rf_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_rf_test_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_rf_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble_rf "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_rf_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ensemble XGBoost</span></span>
<span></span>
<span><span class="va">ensemble_train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ensemble_train_y</span> <span class="op">&lt;-</span> <span class="va">ensemble_train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_train</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">ensemble_test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ensemble_test_y</span> <span class="op">&lt;-</span> <span class="va">ensemble_test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define final train and test sets</span></span>
<span><span class="va">ensemble_xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_train_x</span>, label <span class="op">=</span> <span class="va">ensemble_train_y</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_test_x</span>, label <span class="op">=</span> <span class="va">ensemble_test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">ensemble_watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">ensemble_xgb_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">ensemble_xgb_train</span>, test <span class="op">=</span> <span class="va">ensemble_xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ensemble_xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">ensemble_watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgboost_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">ensemble_xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_train_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ensemble_xgb_model</span>, newdata <span class="op">=</span> <span class="va">ensemble_train_x</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_probabilities</span>, <span class="va">ensemble_y_train</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_xgb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_xgb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_xgb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ensemble_xgb_model</span>, newdata <span class="op">=</span> <span class="va">ensemble_test_x</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_probabilities</span>, <span class="va">ensemble_y_test</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">ensemble_xgb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">ensemble_xgb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_table</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ensemble_xgb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ensemble_xgb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ensemble_xgb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">ensemble_xgb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Ensemble XGBoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">ensemble_xgb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="co"># Save all trained models to the Environment</span></span>
<span><span class="va">adaboost_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">adaboost_train_fit</span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">bayesglm_train_fit</span></span>
<span><span class="va">C50_train_fit</span><span class="op">&lt;&lt;-</span> <span class="va">C50_train_fit</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">cubist_train_fit</span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">rf_train_fit</span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;&lt;-</span> <span class="va">xgb_model</span></span>
<span><span class="va">ensemble_adaboost_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_adaboost_train_fit</span></span>
<span><span class="va">ensemble_C50_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_C50_train_fit</span></span>
<span><span class="va">ensemble_rf_train_fit</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_rf_train_fit</span></span>
<span><span class="va">ensemble_xgb_model</span> <span class="op">&lt;&lt;-</span> <span class="va">ensemble_xgb_model</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">'Model'</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ADABoost'</span>, <span class="st">'BayesGLM'</span>, <span class="st">'C50'</span>, <span class="st">'Cubist'</span>, <span class="st">'Random_Forest'</span>, <span class="st">'XGBoost'</span>, <span class="st">'Ensemble_ADABoost'</span>, <span class="st">'Ensemble_C50'</span>, <span class="st">'Ensemble_Random_Forest'</span>, <span class="st">'Ensemble_XGBoost'</span><span class="op">)</span>,</span>
<span>  <span class="st">'Accuracy'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy_mean</span>, <span class="va">bayesglm_test_accuracy_mean</span>, <span class="va">C50_test_accuracy_mean</span>, <span class="va">cubist_test_accuracy_mean</span>, <span class="va">rf_test_accuracy_mean</span>, <span class="va">xgb_test_accuracy_mean</span>, <span class="va">ensemble_adaboost_holdout_accuracy_mean</span>, <span class="va">ensemble_C50_test_accuracy_mean</span>, <span class="va">ensemble_rf_test_accuracy_mean</span>, <span class="va">ensemble_xgb_test_accuracy_mean</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">Accuracy</span><span class="op">)</span>, <span class="va">Model</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for numresamples</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for the function</span></span>
<span></span>
<span><span class="fu">logistic_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lebron</span>, colnum <span class="op">=</span> <span class="fl">6</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-1.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-2.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-3.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-4.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.476144 test-rmse:0.478562 
#&gt; [2]  train-rmse:0.463574 test-rmse:0.467503 
#&gt; [3]  train-rmse:0.454959 test-rmse:0.460474 
#&gt; [4]  train-rmse:0.448993 test-rmse:0.455963 
#&gt; [5]  train-rmse:0.444821 test-rmse:0.452101 
#&gt; [6]  train-rmse:0.440419 test-rmse:0.451403 
#&gt; [7]  train-rmse:0.436667 test-rmse:0.450788 
#&gt; [8]  train-rmse:0.433511 test-rmse:0.449871 
#&gt; [9]  train-rmse:0.431663 test-rmse:0.450169 
#&gt; [10] train-rmse:0.427720 test-rmse:0.450046 
#&gt; [11] train-rmse:0.424788 test-rmse:0.450895 
#&gt; [12] train-rmse:0.422744 test-rmse:0.449402 
#&gt; [13] train-rmse:0.419597 test-rmse:0.450385 
#&gt; [14] train-rmse:0.417344 test-rmse:0.450237 
#&gt; [15] train-rmse:0.413427 test-rmse:0.450686 
#&gt; [16] train-rmse:0.411022 test-rmse:0.450659 
#&gt; [17] train-rmse:0.409211 test-rmse:0.450818 
#&gt; [18] train-rmse:0.405904 test-rmse:0.452264 
#&gt; [19] train-rmse:0.403075 test-rmse:0.452364 
#&gt; [20] train-rmse:0.402247 test-rmse:0.453080 
#&gt; [21] train-rmse:0.398977 test-rmse:0.452725 
#&gt; [22] train-rmse:0.397407 test-rmse:0.453944 
#&gt; [23] train-rmse:0.393930 test-rmse:0.453229 
#&gt; [24] train-rmse:0.389994 test-rmse:0.452871 
#&gt; [25] train-rmse:0.388467 test-rmse:0.453027 
#&gt; [26] train-rmse:0.386738 test-rmse:0.452534 
#&gt; [27] train-rmse:0.384467 test-rmse:0.452899 
#&gt; [28] train-rmse:0.382570 test-rmse:0.453100 
#&gt; [29] train-rmse:0.379445 test-rmse:0.454196 
#&gt; [30] train-rmse:0.377415 test-rmse:0.454774 
#&gt; [31] train-rmse:0.376504 test-rmse:0.455492 
#&gt; [32] train-rmse:0.375392 test-rmse:0.455794 
#&gt; [33] train-rmse:0.373634 test-rmse:0.455489 
#&gt; [34] train-rmse:0.371433 test-rmse:0.455733 
#&gt; [35] train-rmse:0.368571 test-rmse:0.456959 
#&gt; [36] train-rmse:0.367051 test-rmse:0.457008 
#&gt; [37] train-rmse:0.363892 test-rmse:0.458813 
#&gt; [38] train-rmse:0.361112 test-rmse:0.458801 
#&gt; [39] train-rmse:0.359866 test-rmse:0.458274 
#&gt; [40] train-rmse:0.358560 test-rmse:0.457887 
#&gt; [41] train-rmse:0.358106 test-rmse:0.458127 
#&gt; [42] train-rmse:0.355921 test-rmse:0.458705 
#&gt; [43] train-rmse:0.353788 test-rmse:0.459461 
#&gt; [44] train-rmse:0.353182 test-rmse:0.459651 
#&gt; [45] train-rmse:0.352354 test-rmse:0.459765 
#&gt; [46] train-rmse:0.350558 test-rmse:0.460158 
#&gt; [47] train-rmse:0.348136 test-rmse:0.458902 
#&gt; [48] train-rmse:0.346172 test-rmse:0.459073 
#&gt; [49] train-rmse:0.345309 test-rmse:0.460300 
#&gt; [50] train-rmse:0.342630 test-rmse:0.460079 
#&gt; [51] train-rmse:0.341311 test-rmse:0.461742 
#&gt; [52] train-rmse:0.339357 test-rmse:0.462133 
#&gt; [53] train-rmse:0.337334 test-rmse:0.462307 
#&gt; [54] train-rmse:0.334896 test-rmse:0.463136 
#&gt; [55] train-rmse:0.333012 test-rmse:0.463257 
#&gt; [56] train-rmse:0.332788 test-rmse:0.463209 
#&gt; [57] train-rmse:0.330628 test-rmse:0.464458 
#&gt; [58] train-rmse:0.328841 test-rmse:0.464871 
#&gt; [59] train-rmse:0.327336 test-rmse:0.466450 
#&gt; [60] train-rmse:0.325394 test-rmse:0.467173 
#&gt; [61] train-rmse:0.323361 test-rmse:0.467378 
#&gt; [62] train-rmse:0.321633 test-rmse:0.467970 
#&gt; [63] train-rmse:0.319833 test-rmse:0.468894 
#&gt; [64] train-rmse:0.317659 test-rmse:0.470018 
#&gt; [65] train-rmse:0.316241 test-rmse:0.470120 
#&gt; [66] train-rmse:0.314436 test-rmse:0.471113 
#&gt; [67] train-rmse:0.312160 test-rmse:0.471866 
#&gt; [68] train-rmse:0.311475 test-rmse:0.472474 
#&gt; [69] train-rmse:0.309364 test-rmse:0.473537 
#&gt; [70] train-rmse:0.308724 test-rmse:0.473588
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-5.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-6.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-7.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-8.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350824 test-rmse:0.350826 
#&gt; [2]  train-rmse:0.246155 test-rmse:0.246158 
#&gt; [3]  train-rmse:0.172714 test-rmse:0.172718 
#&gt; [4]  train-rmse:0.121185 test-rmse:0.121188 
#&gt; [5]  train-rmse:0.085029 test-rmse:0.085032 
#&gt; [6]  train-rmse:0.059661 test-rmse:0.059663 
#&gt; [7]  train-rmse:0.041861 test-rmse:0.041863 
#&gt; [8]  train-rmse:0.029372 test-rmse:0.029373 
#&gt; [9]  train-rmse:0.020608 test-rmse:0.020610 
#&gt; [10] train-rmse:0.014460 test-rmse:0.014461 
#&gt; [11] train-rmse:0.010146 test-rmse:0.010146 
#&gt; [12] train-rmse:0.007119 test-rmse:0.007119 
#&gt; [13] train-rmse:0.004995 test-rmse:0.004995 
#&gt; [14] train-rmse:0.003505 test-rmse:0.003505 
#&gt; [15] train-rmse:0.002459 test-rmse:0.002459 
#&gt; [16] train-rmse:0.001725 test-rmse:0.001726 
#&gt; [17] train-rmse:0.001211 test-rmse:0.001211 
#&gt; [18] train-rmse:0.000849 test-rmse:0.000849 
#&gt; [19] train-rmse:0.000596 test-rmse:0.000596 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-9.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-10.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-11.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-12.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-13.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-14.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.470376 test-rmse:0.479959 
#&gt; [2]  train-rmse:0.453387 test-rmse:0.471480 
#&gt; [3]  train-rmse:0.442872 test-rmse:0.467979 
#&gt; [4]  train-rmse:0.435073 test-rmse:0.467341 
#&gt; [5]  train-rmse:0.431218 test-rmse:0.466991 
#&gt; [6]  train-rmse:0.425888 test-rmse:0.467568 
#&gt; [7]  train-rmse:0.423895 test-rmse:0.466266 
#&gt; [8]  train-rmse:0.419954 test-rmse:0.466441 
#&gt; [9]  train-rmse:0.417434 test-rmse:0.465230 
#&gt; [10] train-rmse:0.413718 test-rmse:0.466888 
#&gt; [11] train-rmse:0.410281 test-rmse:0.466853 
#&gt; [12] train-rmse:0.407585 test-rmse:0.468813 
#&gt; [13] train-rmse:0.406435 test-rmse:0.468586 
#&gt; [14] train-rmse:0.405209 test-rmse:0.469302 
#&gt; [15] train-rmse:0.401530 test-rmse:0.468692 
#&gt; [16] train-rmse:0.398126 test-rmse:0.468722 
#&gt; [17] train-rmse:0.395889 test-rmse:0.469836 
#&gt; [18] train-rmse:0.392163 test-rmse:0.470516 
#&gt; [19] train-rmse:0.387945 test-rmse:0.471069 
#&gt; [20] train-rmse:0.386932 test-rmse:0.471384 
#&gt; [21] train-rmse:0.384878 test-rmse:0.472052 
#&gt; [22] train-rmse:0.382496 test-rmse:0.472522 
#&gt; [23] train-rmse:0.379117 test-rmse:0.473605 
#&gt; [24] train-rmse:0.375649 test-rmse:0.473835 
#&gt; [25] train-rmse:0.373457 test-rmse:0.474532 
#&gt; [26] train-rmse:0.370817 test-rmse:0.474590 
#&gt; [27] train-rmse:0.368762 test-rmse:0.476130 
#&gt; [28] train-rmse:0.366161 test-rmse:0.476836 
#&gt; [29] train-rmse:0.363188 test-rmse:0.477363 
#&gt; [30] train-rmse:0.361532 test-rmse:0.476964 
#&gt; [31] train-rmse:0.360264 test-rmse:0.477921 
#&gt; [32] train-rmse:0.357790 test-rmse:0.477276 
#&gt; [33] train-rmse:0.355311 test-rmse:0.478001 
#&gt; [34] train-rmse:0.352196 test-rmse:0.477349 
#&gt; [35] train-rmse:0.350114 test-rmse:0.477405 
#&gt; [36] train-rmse:0.349005 test-rmse:0.477194 
#&gt; [37] train-rmse:0.347719 test-rmse:0.477163 
#&gt; [38] train-rmse:0.346784 test-rmse:0.477026 
#&gt; [39] train-rmse:0.345636 test-rmse:0.477004 
#&gt; [40] train-rmse:0.343623 test-rmse:0.477453 
#&gt; [41] train-rmse:0.340926 test-rmse:0.477200 
#&gt; [42] train-rmse:0.339610 test-rmse:0.477063 
#&gt; [43] train-rmse:0.338114 test-rmse:0.476603 
#&gt; [44] train-rmse:0.337161 test-rmse:0.477081 
#&gt; [45] train-rmse:0.335310 test-rmse:0.477718 
#&gt; [46] train-rmse:0.333155 test-rmse:0.478709 
#&gt; [47] train-rmse:0.331283 test-rmse:0.479318 
#&gt; [48] train-rmse:0.328594 test-rmse:0.479546 
#&gt; [49] train-rmse:0.327513 test-rmse:0.480445 
#&gt; [50] train-rmse:0.327141 test-rmse:0.481062 
#&gt; [51] train-rmse:0.325709 test-rmse:0.481752 
#&gt; [52] train-rmse:0.323339 test-rmse:0.482711 
#&gt; [53] train-rmse:0.320991 test-rmse:0.483422 
#&gt; [54] train-rmse:0.320335 test-rmse:0.483969 
#&gt; [55] train-rmse:0.318912 test-rmse:0.484782 
#&gt; [56] train-rmse:0.317346 test-rmse:0.485648 
#&gt; [57] train-rmse:0.316029 test-rmse:0.485568 
#&gt; [58] train-rmse:0.314046 test-rmse:0.486434 
#&gt; [59] train-rmse:0.311916 test-rmse:0.487268 
#&gt; [60] train-rmse:0.309432 test-rmse:0.487138 
#&gt; [61] train-rmse:0.308339 test-rmse:0.487302 
#&gt; [62] train-rmse:0.307715 test-rmse:0.487245 
#&gt; [63] train-rmse:0.306562 test-rmse:0.487641 
#&gt; [64] train-rmse:0.305473 test-rmse:0.487510 
#&gt; [65] train-rmse:0.303432 test-rmse:0.487882 
#&gt; [66] train-rmse:0.301222 test-rmse:0.488623 
#&gt; [67] train-rmse:0.298861 test-rmse:0.489104 
#&gt; [68] train-rmse:0.297184 test-rmse:0.490484 
#&gt; [69] train-rmse:0.295459 test-rmse:0.490403 
#&gt; [70] train-rmse:0.294919 test-rmse:0.490425
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-15.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-16.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-17.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-18.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350822 test-rmse:0.350821 
#&gt; [2]  train-rmse:0.246152 test-rmse:0.246151 
#&gt; [3]  train-rmse:0.172711 test-rmse:0.172710 
#&gt; [4]  train-rmse:0.121182 test-rmse:0.121180 
#&gt; [5]  train-rmse:0.085026 test-rmse:0.085025 
#&gt; [6]  train-rmse:0.059658 test-rmse:0.059657 
#&gt; [7]  train-rmse:0.041859 test-rmse:0.041858 
#&gt; [8]  train-rmse:0.029370 test-rmse:0.029369 
#&gt; [9]  train-rmse:0.020607 test-rmse:0.020607 
#&gt; [10] train-rmse:0.014459 test-rmse:0.014459 
#&gt; [11] train-rmse:0.010145 test-rmse:0.010145 
#&gt; [12] train-rmse:0.007118 test-rmse:0.007118 
#&gt; [13] train-rmse:0.004994 test-rmse:0.004994 
#&gt; [14] train-rmse:0.003504 test-rmse:0.003504 
#&gt; [15] train-rmse:0.002459 test-rmse:0.002459 
#&gt; [16] train-rmse:0.001725 test-rmse:0.001725 
#&gt; [17] train-rmse:0.001210 test-rmse:0.001210 
#&gt; [18] train-rmse:0.000849 test-rmse:0.000849 
#&gt; [19] train-rmse:0.000596 test-rmse:0.000596 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-19.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-20.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-21.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-22.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-23.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-24.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.471391 test-rmse:0.481189 
#&gt; [2]  train-rmse:0.455547 test-rmse:0.469744 
#&gt; [3]  train-rmse:0.445057 test-rmse:0.466894 
#&gt; [4]  train-rmse:0.438664 test-rmse:0.466114 
#&gt; [5]  train-rmse:0.432583 test-rmse:0.464660 
#&gt; [6]  train-rmse:0.427073 test-rmse:0.466880 
#&gt; [7]  train-rmse:0.421625 test-rmse:0.464989 
#&gt; [8]  train-rmse:0.417663 test-rmse:0.464809 
#&gt; [9]  train-rmse:0.415027 test-rmse:0.465373 
#&gt; [10] train-rmse:0.409836 test-rmse:0.466984 
#&gt; [11] train-rmse:0.405816 test-rmse:0.469168 
#&gt; [12] train-rmse:0.403440 test-rmse:0.470523 
#&gt; [13] train-rmse:0.401912 test-rmse:0.471266 
#&gt; [14] train-rmse:0.398924 test-rmse:0.472400 
#&gt; [15] train-rmse:0.395019 test-rmse:0.472489 
#&gt; [16] train-rmse:0.393648 test-rmse:0.471867 
#&gt; [17] train-rmse:0.391375 test-rmse:0.473183 
#&gt; [18] train-rmse:0.388984 test-rmse:0.472980 
#&gt; [19] train-rmse:0.388284 test-rmse:0.473698 
#&gt; [20] train-rmse:0.386324 test-rmse:0.474739 
#&gt; [21] train-rmse:0.385213 test-rmse:0.474960 
#&gt; [22] train-rmse:0.382278 test-rmse:0.474498 
#&gt; [23] train-rmse:0.378827 test-rmse:0.476668 
#&gt; [24] train-rmse:0.377884 test-rmse:0.477570 
#&gt; [25] train-rmse:0.374871 test-rmse:0.477621 
#&gt; [26] train-rmse:0.372707 test-rmse:0.477877 
#&gt; [27] train-rmse:0.370127 test-rmse:0.477583 
#&gt; [28] train-rmse:0.367759 test-rmse:0.476749 
#&gt; [29] train-rmse:0.366066 test-rmse:0.476368 
#&gt; [30] train-rmse:0.363867 test-rmse:0.476622 
#&gt; [31] train-rmse:0.362045 test-rmse:0.477304 
#&gt; [32] train-rmse:0.358841 test-rmse:0.476316 
#&gt; [33] train-rmse:0.356543 test-rmse:0.476612 
#&gt; [34] train-rmse:0.353660 test-rmse:0.476929 
#&gt; [35] train-rmse:0.352077 test-rmse:0.477073 
#&gt; [36] train-rmse:0.351153 test-rmse:0.477482 
#&gt; [37] train-rmse:0.348208 test-rmse:0.477965 
#&gt; [38] train-rmse:0.346105 test-rmse:0.477946 
#&gt; [39] train-rmse:0.344032 test-rmse:0.477134 
#&gt; [40] train-rmse:0.341681 test-rmse:0.477221 
#&gt; [41] train-rmse:0.338970 test-rmse:0.478715 
#&gt; [42] train-rmse:0.336918 test-rmse:0.479090 
#&gt; [43] train-rmse:0.335588 test-rmse:0.479170 
#&gt; [44] train-rmse:0.333278 test-rmse:0.480013 
#&gt; [45] train-rmse:0.332120 test-rmse:0.480946 
#&gt; [46] train-rmse:0.329920 test-rmse:0.481960 
#&gt; [47] train-rmse:0.328341 test-rmse:0.482355 
#&gt; [48] train-rmse:0.326399 test-rmse:0.483102 
#&gt; [49] train-rmse:0.324738 test-rmse:0.484285 
#&gt; [50] train-rmse:0.324118 test-rmse:0.484037 
#&gt; [51] train-rmse:0.321977 test-rmse:0.485103 
#&gt; [52] train-rmse:0.320736 test-rmse:0.485361 
#&gt; [53] train-rmse:0.318751 test-rmse:0.487033 
#&gt; [54] train-rmse:0.316191 test-rmse:0.488110 
#&gt; [55] train-rmse:0.314172 test-rmse:0.487651 
#&gt; [56] train-rmse:0.313694 test-rmse:0.488266 
#&gt; [57] train-rmse:0.311423 test-rmse:0.488294 
#&gt; [58] train-rmse:0.310172 test-rmse:0.488361 
#&gt; [59] train-rmse:0.308348 test-rmse:0.488932 
#&gt; [60] train-rmse:0.306982 test-rmse:0.489724 
#&gt; [61] train-rmse:0.305282 test-rmse:0.490384 
#&gt; [62] train-rmse:0.303546 test-rmse:0.490633 
#&gt; [63] train-rmse:0.302081 test-rmse:0.490621 
#&gt; [64] train-rmse:0.301427 test-rmse:0.490028 
#&gt; [65] train-rmse:0.300181 test-rmse:0.490678 
#&gt; [66] train-rmse:0.298538 test-rmse:0.492055 
#&gt; [67] train-rmse:0.297295 test-rmse:0.492493 
#&gt; [68] train-rmse:0.296920 test-rmse:0.492876 
#&gt; [69] train-rmse:0.295868 test-rmse:0.493036 
#&gt; [70] train-rmse:0.295132 test-rmse:0.493147
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-25.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-26.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-27.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-28.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350732 test-rmse:0.350737 
#&gt; [2]  train-rmse:0.246025 test-rmse:0.246032 
#&gt; [3]  train-rmse:0.172578 test-rmse:0.172585 
#&gt; [4]  train-rmse:0.121057 test-rmse:0.121064 
#&gt; [5]  train-rmse:0.084917 test-rmse:0.084923 
#&gt; [6]  train-rmse:0.059566 test-rmse:0.059571 
#&gt; [7]  train-rmse:0.041784 test-rmse:0.041788 
#&gt; [8]  train-rmse:0.029310 test-rmse:0.029313 
#&gt; [9]  train-rmse:0.020560 test-rmse:0.020562 
#&gt; [10] train-rmse:0.014422 test-rmse:0.014424 
#&gt; [11] train-rmse:0.010116 test-rmse:0.010118 
#&gt; [12] train-rmse:0.007096 test-rmse:0.007097 
#&gt; [13] train-rmse:0.004978 test-rmse:0.004979 
#&gt; [14] train-rmse:0.003492 test-rmse:0.003492 
#&gt; [15] train-rmse:0.002449 test-rmse:0.002450 
#&gt; [16] train-rmse:0.001718 test-rmse:0.001718 
#&gt; [17] train-rmse:0.001205 test-rmse:0.001205 
#&gt; [18] train-rmse:0.000845 test-rmse:0.000846 
#&gt; [19] train-rmse:0.000593 test-rmse:0.000593 
#&gt; [20] train-rmse:0.000416 test-rmse:0.000416 
#&gt; [21] train-rmse:0.000292 test-rmse:0.000292 
#&gt; [22] train-rmse:0.000205 test-rmse:0.000205 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000049 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-29.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-30.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-31.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-32.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-33.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-34.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.474806 test-rmse:0.477327 
#&gt; [2]  train-rmse:0.460194 test-rmse:0.468567 
#&gt; [3]  train-rmse:0.451103 test-rmse:0.464446 
#&gt; [4]  train-rmse:0.444766 test-rmse:0.461353 
#&gt; [5]  train-rmse:0.439933 test-rmse:0.459735 
#&gt; [6]  train-rmse:0.434587 test-rmse:0.458148 
#&gt; [7]  train-rmse:0.432074 test-rmse:0.456628 
#&gt; [8]  train-rmse:0.428070 test-rmse:0.456919 
#&gt; [9]  train-rmse:0.425809 test-rmse:0.457126 
#&gt; [10] train-rmse:0.423424 test-rmse:0.457745 
#&gt; [11] train-rmse:0.421371 test-rmse:0.457869 
#&gt; [12] train-rmse:0.418730 test-rmse:0.457889 
#&gt; [13] train-rmse:0.415050 test-rmse:0.457260 
#&gt; [14] train-rmse:0.410685 test-rmse:0.458697 
#&gt; [15] train-rmse:0.406654 test-rmse:0.458959 
#&gt; [16] train-rmse:0.402437 test-rmse:0.459619 
#&gt; [17] train-rmse:0.398835 test-rmse:0.460915 
#&gt; [18] train-rmse:0.396471 test-rmse:0.461584 
#&gt; [19] train-rmse:0.395539 test-rmse:0.461310 
#&gt; [20] train-rmse:0.392449 test-rmse:0.462386 
#&gt; [21] train-rmse:0.388385 test-rmse:0.463716 
#&gt; [22] train-rmse:0.386142 test-rmse:0.464954 
#&gt; [23] train-rmse:0.383937 test-rmse:0.466150 
#&gt; [24] train-rmse:0.383189 test-rmse:0.467036 
#&gt; [25] train-rmse:0.381766 test-rmse:0.467289 
#&gt; [26] train-rmse:0.379216 test-rmse:0.467775 
#&gt; [27] train-rmse:0.376576 test-rmse:0.468056 
#&gt; [28] train-rmse:0.374455 test-rmse:0.468093 
#&gt; [29] train-rmse:0.372813 test-rmse:0.468241 
#&gt; [30] train-rmse:0.371925 test-rmse:0.468451 
#&gt; [31] train-rmse:0.370339 test-rmse:0.468939 
#&gt; [32] train-rmse:0.368483 test-rmse:0.469352 
#&gt; [33] train-rmse:0.365769 test-rmse:0.470102 
#&gt; [34] train-rmse:0.363748 test-rmse:0.470834 
#&gt; [35] train-rmse:0.362648 test-rmse:0.470980 
#&gt; [36] train-rmse:0.359854 test-rmse:0.471540 
#&gt; [37] train-rmse:0.358168 test-rmse:0.472813 
#&gt; [38] train-rmse:0.355880 test-rmse:0.472769 
#&gt; [39] train-rmse:0.353999 test-rmse:0.472446 
#&gt; [40] train-rmse:0.351588 test-rmse:0.473530 
#&gt; [41] train-rmse:0.349368 test-rmse:0.472972 
#&gt; [42] train-rmse:0.348816 test-rmse:0.473473 
#&gt; [43] train-rmse:0.346445 test-rmse:0.474530 
#&gt; [44] train-rmse:0.344027 test-rmse:0.474449 
#&gt; [45] train-rmse:0.341265 test-rmse:0.476748 
#&gt; [46] train-rmse:0.338787 test-rmse:0.477893 
#&gt; [47] train-rmse:0.336858 test-rmse:0.478158 
#&gt; [48] train-rmse:0.335004 test-rmse:0.479104 
#&gt; [49] train-rmse:0.334594 test-rmse:0.478971 
#&gt; [50] train-rmse:0.333463 test-rmse:0.478899 
#&gt; [51] train-rmse:0.332069 test-rmse:0.479791 
#&gt; [52] train-rmse:0.331328 test-rmse:0.481001 
#&gt; [53] train-rmse:0.329724 test-rmse:0.481301 
#&gt; [54] train-rmse:0.327866 test-rmse:0.481444 
#&gt; [55] train-rmse:0.325509 test-rmse:0.481943 
#&gt; [56] train-rmse:0.323790 test-rmse:0.482850 
#&gt; [57] train-rmse:0.322412 test-rmse:0.483244 
#&gt; [58] train-rmse:0.320115 test-rmse:0.483289 
#&gt; [59] train-rmse:0.319143 test-rmse:0.483689 
#&gt; [60] train-rmse:0.318132 test-rmse:0.483346 
#&gt; [61] train-rmse:0.317056 test-rmse:0.483574 
#&gt; [62] train-rmse:0.314811 test-rmse:0.484470 
#&gt; [63] train-rmse:0.313338 test-rmse:0.485339 
#&gt; [64] train-rmse:0.310976 test-rmse:0.485383 
#&gt; [65] train-rmse:0.309806 test-rmse:0.486243 
#&gt; [66] train-rmse:0.307857 test-rmse:0.486291 
#&gt; [67] train-rmse:0.306005 test-rmse:0.486813 
#&gt; [68] train-rmse:0.303882 test-rmse:0.486972 
#&gt; [69] train-rmse:0.303206 test-rmse:0.487281 
#&gt; [70] train-rmse:0.301917 test-rmse:0.487293
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-35.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-36.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-37.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-38.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350811 test-rmse:0.350811 
#&gt; [2]  train-rmse:0.246136 test-rmse:0.246136 
#&gt; [3]  train-rmse:0.172695 test-rmse:0.172695 
#&gt; [4]  train-rmse:0.121166 test-rmse:0.121166 
#&gt; [5]  train-rmse:0.085013 test-rmse:0.085013 
#&gt; [6]  train-rmse:0.059647 test-rmse:0.059647 
#&gt; [7]  train-rmse:0.041850 test-rmse:0.041850 
#&gt; [8]  train-rmse:0.029363 test-rmse:0.029363 
#&gt; [9]  train-rmse:0.020601 test-rmse:0.020601 
#&gt; [10] train-rmse:0.014454 test-rmse:0.014454 
#&gt; [11] train-rmse:0.010141 test-rmse:0.010141 
#&gt; [12] train-rmse:0.007115 test-rmse:0.007115 
#&gt; [13] train-rmse:0.004992 test-rmse:0.004992 
#&gt; [14] train-rmse:0.003503 test-rmse:0.003503 
#&gt; [15] train-rmse:0.002458 test-rmse:0.002458 
#&gt; [16] train-rmse:0.001724 test-rmse:0.001724 
#&gt; [17] train-rmse:0.001210 test-rmse:0.001210 
#&gt; [18] train-rmse:0.000849 test-rmse:0.000849 
#&gt; [19] train-rmse:0.000596 test-rmse:0.000596 
#&gt; [20] train-rmse:0.000418 test-rmse:0.000418 
#&gt; [21] train-rmse:0.000293 test-rmse:0.000293 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000144 test-rmse:0.000144 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-39.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-40.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-41.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-42.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-43.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-44.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.471577 test-rmse:0.480744 
#&gt; [2]  train-rmse:0.454265 test-rmse:0.471583 
#&gt; [3]  train-rmse:0.444762 test-rmse:0.468178 
#&gt; [4]  train-rmse:0.438154 test-rmse:0.465017 
#&gt; [5]  train-rmse:0.434042 test-rmse:0.464051 
#&gt; [6]  train-rmse:0.429515 test-rmse:0.463162 
#&gt; [7]  train-rmse:0.424879 test-rmse:0.462757 
#&gt; [8]  train-rmse:0.422605 test-rmse:0.463300 
#&gt; [9]  train-rmse:0.418741 test-rmse:0.463332 
#&gt; [10] train-rmse:0.415888 test-rmse:0.465554 
#&gt; [11] train-rmse:0.412331 test-rmse:0.465948 
#&gt; [12] train-rmse:0.409270 test-rmse:0.466338 
#&gt; [13] train-rmse:0.407598 test-rmse:0.464630 
#&gt; [14] train-rmse:0.405619 test-rmse:0.465577 
#&gt; [15] train-rmse:0.403221 test-rmse:0.465341 
#&gt; [16] train-rmse:0.401821 test-rmse:0.465707 
#&gt; [17] train-rmse:0.400564 test-rmse:0.466053 
#&gt; [18] train-rmse:0.399474 test-rmse:0.465748 
#&gt; [19] train-rmse:0.397441 test-rmse:0.465750 
#&gt; [20] train-rmse:0.394472 test-rmse:0.466224 
#&gt; [21] train-rmse:0.393116 test-rmse:0.466412 
#&gt; [22] train-rmse:0.390620 test-rmse:0.465684 
#&gt; [23] train-rmse:0.387416 test-rmse:0.466095 
#&gt; [24] train-rmse:0.386378 test-rmse:0.466550 
#&gt; [25] train-rmse:0.384605 test-rmse:0.466656 
#&gt; [26] train-rmse:0.381410 test-rmse:0.466764 
#&gt; [27] train-rmse:0.378212 test-rmse:0.465584 
#&gt; [28] train-rmse:0.377111 test-rmse:0.465691 
#&gt; [29] train-rmse:0.374755 test-rmse:0.466208 
#&gt; [30] train-rmse:0.371775 test-rmse:0.466713 
#&gt; [31] train-rmse:0.370571 test-rmse:0.466772 
#&gt; [32] train-rmse:0.369029 test-rmse:0.468559 
#&gt; [33] train-rmse:0.368610 test-rmse:0.468287 
#&gt; [34] train-rmse:0.367808 test-rmse:0.468524 
#&gt; [35] train-rmse:0.367062 test-rmse:0.468352 
#&gt; [36] train-rmse:0.366186 test-rmse:0.468407 
#&gt; [37] train-rmse:0.363883 test-rmse:0.467376 
#&gt; [38] train-rmse:0.361354 test-rmse:0.468753 
#&gt; [39] train-rmse:0.359755 test-rmse:0.469330 
#&gt; [40] train-rmse:0.357923 test-rmse:0.469506 
#&gt; [41] train-rmse:0.354185 test-rmse:0.469816 
#&gt; [42] train-rmse:0.352034 test-rmse:0.471337 
#&gt; [43] train-rmse:0.348321 test-rmse:0.471297 
#&gt; [44] train-rmse:0.344673 test-rmse:0.471338 
#&gt; [45] train-rmse:0.341964 test-rmse:0.471260 
#&gt; [46] train-rmse:0.339466 test-rmse:0.471782 
#&gt; [47] train-rmse:0.338032 test-rmse:0.471911 
#&gt; [48] train-rmse:0.335915 test-rmse:0.471929 
#&gt; [49] train-rmse:0.333468 test-rmse:0.472566 
#&gt; [50] train-rmse:0.331806 test-rmse:0.472157 
#&gt; [51] train-rmse:0.328948 test-rmse:0.472021 
#&gt; [52] train-rmse:0.326076 test-rmse:0.472872 
#&gt; [53] train-rmse:0.323846 test-rmse:0.473045 
#&gt; [54] train-rmse:0.321768 test-rmse:0.473011 
#&gt; [55] train-rmse:0.320399 test-rmse:0.472836 
#&gt; [56] train-rmse:0.318842 test-rmse:0.472671 
#&gt; [57] train-rmse:0.316777 test-rmse:0.473612 
#&gt; [58] train-rmse:0.316078 test-rmse:0.473772 
#&gt; [59] train-rmse:0.315315 test-rmse:0.473332 
#&gt; [60] train-rmse:0.313517 test-rmse:0.473501 
#&gt; [61] train-rmse:0.312084 test-rmse:0.474112 
#&gt; [62] train-rmse:0.310038 test-rmse:0.473522 
#&gt; [63] train-rmse:0.309017 test-rmse:0.473653 
#&gt; [64] train-rmse:0.307556 test-rmse:0.473114 
#&gt; [65] train-rmse:0.305566 test-rmse:0.472764 
#&gt; [66] train-rmse:0.303763 test-rmse:0.472985 
#&gt; [67] train-rmse:0.302499 test-rmse:0.473220 
#&gt; [68] train-rmse:0.300772 test-rmse:0.474625 
#&gt; [69] train-rmse:0.298926 test-rmse:0.475909 
#&gt; [70] train-rmse:0.297109 test-rmse:0.475763
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-45.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-46.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-47.png" width="672"></div>
<pre><code>#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<div class="inline-figure"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-48.png" width="672"></div>
<pre><code>#&gt; [1]  train-rmse:0.350845 test-rmse:0.350845 
#&gt; [2]  train-rmse:0.246185 test-rmse:0.246185 
#&gt; [3]  train-rmse:0.172745 test-rmse:0.172745 
#&gt; [4]  train-rmse:0.121214 test-rmse:0.121214 
#&gt; [5]  train-rmse:0.085054 test-rmse:0.085055 
#&gt; [6]  train-rmse:0.059682 test-rmse:0.059682 
#&gt; [7]  train-rmse:0.041878 test-rmse:0.041878 
#&gt; [8]  train-rmse:0.029385 test-rmse:0.029386 
#&gt; [9]  train-rmse:0.020620 test-rmse:0.020620 
#&gt; [10] train-rmse:0.014469 test-rmse:0.014469 
#&gt; [11] train-rmse:0.010152 test-rmse:0.010152 
#&gt; [12] train-rmse:0.007124 test-rmse:0.007124 
#&gt; [13] train-rmse:0.004999 test-rmse:0.004999 
#&gt; [14] train-rmse:0.003508 test-rmse:0.003508 
#&gt; [15] train-rmse:0.002461 test-rmse:0.002461 
#&gt; [16] train-rmse:0.001727 test-rmse:0.001727 
#&gt; [17] train-rmse:0.001212 test-rmse:0.001212 
#&gt; [18] train-rmse:0.000850 test-rmse:0.000850 
#&gt; [19] train-rmse:0.000597 test-rmse:0.000597 
#&gt; [20] train-rmse:0.000419 test-rmse:0.000419 
#&gt; [21] train-rmse:0.000294 test-rmse:0.000294 
#&gt; [22] train-rmse:0.000206 test-rmse:0.000206 
#&gt; [23] train-rmse:0.000145 test-rmse:0.000145 
#&gt; [24] train-rmse:0.000101 test-rmse:0.000101 
#&gt; [25] train-rmse:0.000071 test-rmse:0.000071 
#&gt; [26] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [27] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [28] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [29] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [30] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [31] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [32] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [33] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [34] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [35] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [36] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [37] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [38] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [39] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [40] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [41] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [42] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [43] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [44] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [45] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [46] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [47] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [48] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [49] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [50] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [51] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [52] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [53] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [54] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [55] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [56] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [57] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [58] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [59] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [60] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [61] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [62] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [63] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [64] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [65] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [66] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [67] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [68] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [69] train-rmse:0.000050 test-rmse:0.000050 
#&gt; [70] train-rmse:0.000050 test-rmse:0.000050
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases
#&gt; Setting levels: control = 0, case = 1
#&gt; Setting direction: controls &lt; cases</code></pre>
<p><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-49.png" width="672"><img src="07-Ensembles_of_Logistic_Models_files/figure-html/Logistic%20ensemble-50.png" width="672"></p>
<pre><code>#&gt;                     Model  Accuracy
#&gt; 1                     C50 1.0000000
#&gt; 2                  Cubist 1.0000000
#&gt; 3       Ensemble_ADABoost 1.0000000
#&gt; 4            Ensemble_C50 1.0000000
#&gt; 5  Ensemble_Random_Forest 1.0000000
#&gt; 6        Ensemble_XGBoost 1.0000000
#&gt; 7           Random_Forest 1.0000000
#&gt; 8                BayesGLM 0.6455523
#&gt; 9                 XGBoost 0.6441496
#&gt; 10               ADABoost 0.6086781</code></pre>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>

</div>
  <div class="chapter-nav">
<div class="prev"><a href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></div>
<div class="next"><a href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li><a class="nav-link" href="#advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/InfinteCuriosity/EnsemblesBook/blob/master/07-Ensembles_of_Logistic_Models.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/InfinteCuriosity/EnsemblesBook/edit/master/07-Ensembles_of_Logistic_Models.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Ensembles: From Beginner to Expert</strong>" was written by Russ Conte. It was last built on 2024-06-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
