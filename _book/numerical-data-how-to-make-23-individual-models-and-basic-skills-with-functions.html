<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Numerical data: How to make 23 individual models, and basic skills with functions | Ensembles: From Beginner to Expert</title>
<meta name="author" content="Russ Conte">
<meta name="description" content="This is where we will begin building the skills to make ensembles of models of numerical data. However, this is going to be much easier than it might appear at first. Let’s see how we can make...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 3 Numerical data: How to make 23 individual models, and basic skills with functions | Ensembles: From Beginner to Expert">
<meta property="og:type" content="book">
<meta property="og:description" content="This is where we will begin building the skills to make ensembles of models of numerical data. However, this is going to be much easier than it might appear at first. Let’s see how we can make...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Numerical data: How to make 23 individual models, and basic skills with functions | Ensembles: From Beginner to Expert">
<meta name="twitter:description" content="This is where we will begin building the skills to make ensembles of models of numerical data. However, this is going to be much easier than it might appear at first. Let’s see how we can make...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Ensembles: From Beginner to Expert</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></li>
<li><a class="active" href="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions.html"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a></li>
<li><a class="" href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></li>
<li><a class="" href="classification-data-how-to-make-14-individual-classification-models.html"><span class="header-section-number">5</span> Classification data: How to make 14 individual classification models</a></li>
<li><a class="" href="building-ensembles-of-classification-models.html"><span class="header-section-number">6</span> Building ensembles of classification models</a></li>
<li><a class="" href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></li>
<li><a class="" href="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles.html"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li>
<li><a class="" href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></li>
<li><a class="" href="ensembles-of-26-forecasting-models.html"><span class="header-section-number">10</span> Ensembles of 26 Forecasting Models</a></li>
<li><a class="" href="predicting-on-totally-new-data-with-individual-models-and-ensembles.html"><span class="header-section-number">11</span> Predicting on totally new data with individual models and ensembles</a></li>
<li><a class="" href="how-to-communicate-your-results.html"><span class="header-section-number">12</span> How to communicate your results</a></li>
<li><a class="" href="final-comprhensive-project.html"><span class="header-section-number">13</span> Final Comprhensive Project</a></li>
<li><a class="" href="building-your-own-no-code-solutions.html"><span class="header-section-number">14</span> Building your own no-code solutions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/InfiniteCuriosity/EnsemblesBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions<a class="anchor" aria-label="anchor" href="#numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions"><i class="fas fa-link"></i></a>
</h1>
<p>This is where we will begin building the skills to make ensembles of
models of numerical data. However, this is going to be much easier than
it might appear at first. Let’s see how we can make this as easy as
possible.</p>
<p>How to work backwards and make the function we need: Start from the end</p>
<p>We are going to start at the ending, not at the beginning, and work
backwards from there. This method is much, much easier than working
forward, as you will see throughout this book. While it might be a
little uncomfortable at first, this skill will allow you to complete
your work at a faster rate than if you work forward.</p>
<p>We’ll use the Boston Housing data set, and we’ll start with the Bagged
Random Forest function. For now we’re only going to work with one
function, to keep everything simple. In essence, we are going to run
this like an assembly line.</p>
<p>We want the ending to be the error rate by model. Virtually any customer
you work with is going to want to know, “How accurate is it?” That’s our
starting point.</p>
<p>How do we determine model accuracy? We already did this in the previous
chapter, finding the root mean squared error for the individual models
and the ensemble models. We’re going to do the same steps here, so the
process is familiar to you.</p>
<p>To get the error rate by model on the holdout data sets (test and
validation), we’re going to need a model (Bagged Random Forest in this
first example), fit to the training data, and use that model to make
predictions on the test data. We can then measure the error in the
predictions, just as we did before. These steps should be familiar to
you. If not, please re-read the previous chapter.</p>
<p>But what do we need to complete those steps? We’re going to have to go
backward (a little) and make a function that will allow us to work with
any data set.</p>
<p>What does our function need? Let’s make a list:</p>
<ul>
<li><p>The data (such as Boston housing)</p></li>
<li><p>Column number (such as 14, the median value of the property)</p></li>
<li><p>Train amount</p></li>
<li><p>Test amount</p></li>
<li><p>Validation amount</p></li>
<li><p>Number of times to resample</p></li>
</ul>
<p>One of the key steps here is to change the name of the target variable
to y. The initial name could be nearly anything, but this method changes
the name of the target variable to y. This allows us to make one small
change that will allow this to be the easiest possible solution:</p>
<div id="all-our-models-will-be-structured-the-same-way-y-.-data-train" class="section level3" number="3.0.1">
<h3>
<span class="header-section-number">3.0.1</span> All our models will be structured the same way: y ~ ., data = train<a class="anchor" aria-label="anchor" href="#all-our-models-will-be-structured-the-same-way-y-.-data-train"><i class="fas fa-link"></i></a>
</h3>
<p>This means that y (our target value) is a function of the other
features, and the data set is the training data set. While there will be
some variations on this in our 27 models, the basic structure is the
same.</p>
</div>
<div id="having-the-same-structure-for-all-the-models-makes-it-much-easier-to-build-debug-and-deploy-the-completed-models." class="section level3" number="3.0.2">
<h3>
<span class="header-section-number">3.0.2</span> Having the same structure for all the models makes it much easier to build, debug, and deploy the completed models.<a class="anchor" aria-label="anchor" href="#having-the-same-structure-for-all-the-models-makes-it-much-easier-to-build-debug-and-deploy-the-completed-models."><i class="fas fa-link"></i></a>
</h3>
<p>Then we only need to start with our initial values, and it will run.</p>
<p>One extremely nice part about creating models this way is the enormous
efficiency it gives us. Once we have the Bagged Random Forest model
working, we will be able to use very similar (and identical in many
cases!) processes with other models (such as Support Vector Machines).</p>
<p>The rock solid foundation we lay at the beginning will allow us to have
a smooth and easy experience once the foundation is solid and we use it
to build more models. The other models will mainly be almost exact
duplicates of our fist example.’</p>
<p>Here are the steps we will follow:</p>
<ul>
<li><p>Load the library</p></li>
<li><p>Set initial values to 0</p></li>
<li><p>Create the function</p></li>
<li><p>Set up random resampling</p></li>
<li><p>Break the data into train and test</p></li>
<li><p>Fit the model on the training data, make predictions and measure
error on the test data</p></li>
<li><p>Return the results</p></li>
<li><p>Check for errors or warnings</p></li>
<li><p>Test on a different data set</p></li>
</ul>
</div>
<div id="exercise-re-read-the-steps-above-how-we-will-work-backwards-to-come-up-with-the-function-we-need." class="section level3" number="3.0.3">
<h3>
<span class="header-section-number">3.0.3</span> Exercise: Re-read the steps above how we will work backwards to come up with the function we need.<a class="anchor" aria-label="anchor" href="#exercise-re-read-the-steps-above-how-we-will-work-backwards-to-come-up-with-the-function-we-need."><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="bagged-random-forest" class="section level3" number="3.0.4">
<h3>
<span class="header-section-number">3.0.4</span> 1. Bagged Random Forest<a class="anchor" aria-label="anchor" href="#bagged-random-forest"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span> <span class="co"># will allow us to use a tuned random forest model</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfrasco/Metrics">Metrics</a></span><span class="op">)</span> <span class="co"># Will allow us to calculate the root mean squared error</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span> <span class="co"># To use the random forest function</span></span>
<span><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># Amazing set of tools for data science</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.5.1     ✔ tibble    3.2.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     ✔ tidyr     1.3.1</span></span>
<span><span class="co">#&gt; ✔ purrr     1.0.2</span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::combine()  masks randomForest::combine()</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter()   masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()      masks stats::lag()</span></span>
<span><span class="co">#&gt; ✖ ggplot2::margin() masks randomForest::margin()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set initial values to 0. The function will return an error if any of these are left out.</span></span>
<span></span>
<span><span class="va">bag_rf_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Define the function</span></span>
<span></span>
<span><span class="va">numerical_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co">#Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model to the training data, make predictions on the testing data, then calculate the error rates on the testing data sets.</span></span>
<span><span class="va">bag_rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">bag_rf_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">bag_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bag_rf_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bag_rf_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bag_rf_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">bag_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bag_rf_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bag_rf_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Itemize the error on the holdout data sets, and calculate the mean of the results</span></span>
<span><span class="va">bag_rf_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bag_rf_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">bag_rf_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bag_rf_holdout_RMSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># These are the predictions we will need when we make the ensembles</span></span>
<span><span class="va">bag_rf_test_predict_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bag_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Return the mean of the results to the user</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bag_rf_holdout_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numerical_1 function</span></span>
<span></span>
<span><span class="co"># Here is our first numerical function in actual use. We will use 25 resamples</span></span>
<span></span>
<span><span class="fu">numerical_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3043472</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings, the best possible result</span></span></code></pre></div>
<p>Exercise: Try it yourself: Change the values of train, test and
validation, and the number of resamples. See how those change the
result.</p>
<p>One of your own: Find any numerical data set, and make a bagged random
forest function for that data set. (For example, you may use the Auto
data set in the ISLR package. You will need to remove the last column,
vehicle name. Model mpg as a function of the other features using the
Bagged Random Forest function, but any numerical data set will work).</p>
<p>Post: Share on social your first results making a numerical function
(screen shot/video optional at this stage, we will be learning how to do
those later)</p>
<p>For example, “Did my first data science function building up to making
ensembles later on. Got everything to run, no errors. #AIEnsembles”</p>
<p>Now we will build the remaining 22 models for numerical data. They are
all built using the same structure, on the same foundation.</p>
<p>Now that we know how to build a basic function, let’s build the 22 other
sets of tools we will need to make our ensemble, starting with bagging:</p>
</div>
<div id="bagging-bootstrap-aggregating" class="section level3" number="3.0.5">
<h3>
<span class="header-section-number">3.0.5</span> 2. Bagging (bootstrap aggregating)<a class="anchor" aria-label="anchor" href="#bagging-bootstrap-aggregating"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ipred</span><span class="op">)</span> <span class="co">#for the bagging function</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">bagging_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co">#Create the function:</span></span>
<span></span>
<span><span class="va">bagging_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model to the training data, calculate error, make predictions on the holdout data</span></span>
<span></span>
<span><span class="va">bagging_train_fit</span> <span class="op">&lt;-</span> <span class="fu">ipred</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ipred/man/bagging.html">bagging</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">bagging_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bagging_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bagging_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bagging_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bagging_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bagging_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">bagging_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">bagging_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">y_hat_bagging</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bagging_test_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for the resampling function</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bagging_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for the bagging function</span></span>
<span></span>
<span><span class="co"># Test the function:</span></span>
<span><span class="fu">bagging_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.20</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.012994</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings</span></span></code></pre></div>
</div>
<div id="bayesglm" class="section level3" number="3.0.6">
<h3>
<span class="header-section-number">3.0.6</span> 3. BayesGLM<a class="anchor" aria-label="anchor" href="#bayesglm"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span> <span class="co"># to use bayesglm function</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'MASS'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Matrix'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:tidyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     expand, pack, unpack</span></span>
<span><span class="co">#&gt; Loading required package: lme4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arm (Version 1.14-4, built: 2024-4-1)</span></span>
<span><span class="co">#&gt; Working directory is /Users/russellconte/Library/Mobile Documents/com~apple~CloudDocs/Documents/Machine Learning templates in R/EnsemblesBook</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">bayesglm_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">bayesglm_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co">#Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co">#Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">arm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/bayesglm.html">bayesglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesglm_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesglm_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_test_RMSE</span><span class="op">)</span> </span>
<span><span class="va">y_hat_bayesglm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for resampling</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bayesglm_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for the function</span></span>
<span></span>
<span><span class="fu">bayesglm_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.20</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.766784</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings</span></span></code></pre></div>
</div>
<div id="bayesrnn" class="section level3" number="3.0.7">
<h3>
<span class="header-section-number">3.0.7</span> 4. BayesRNN<a class="anchor" aria-label="anchor" href="#bayesrnn"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">brnn</span><span class="op">)</span> <span class="co"># so we can use the BayesRNN function</span></span>
<span><span class="co">#&gt; Loading required package: Formula</span></span>
<span><span class="co">#&gt; Loading required package: truncnorm</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span></span>
<span><span class="va">bayesrnn_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span></span>
<span><span class="va">bayesrnn_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model on the training data, make predictions on the testing data</span></span>
<span><span class="va">bayesrnn_train_fit</span> <span class="op">&lt;-</span> <span class="fu">brnn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/brnn/man/brnn.html">brnn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesrnn_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesrnn_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesrnn_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesrnn_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_hat_bayesrnn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesrnn_test_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for number of resamples </span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bayesrnn_test_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="fu">bayesrnn_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016579 </span></span>
<span><span class="co">#&gt; gamma= 30.9146    alpha= 4.5072   beta= 19287.31 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7017412 </span></span>
<span><span class="co">#&gt; gamma= 31.0361    alpha= 3.1851   beta= 14704.06 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015619 </span></span>
<span><span class="co">#&gt; gamma= 31.2686    alpha= 5.5043   beta= 14369.86 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016138 </span></span>
<span><span class="co">#&gt; gamma= 31.5051    alpha= 3.2518   beta= 14287.47 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016246 </span></span>
<span><span class="co">#&gt; gamma= 31.4638    alpha= 5.7484   beta= 14045.49 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016751 </span></span>
<span><span class="co">#&gt; gamma= 31.6047    alpha= 5.2739   beta= 13583.82 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015323 </span></span>
<span><span class="co">#&gt; gamma= 30.2174    alpha= 3.217    beta= 19069.97 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016694 </span></span>
<span><span class="co">#&gt; gamma= 30.7135    alpha= 5.0462   beta= 15276.49 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.701572 </span></span>
<span><span class="co">#&gt; gamma= 30.4745    alpha= 4.9501   beta= 18702.41 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016356 </span></span>
<span><span class="co">#&gt; gamma= 30.4193    alpha= 4.9632   beta= 18163.57 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015132 </span></span>
<span><span class="co">#&gt; gamma= 31.4395    alpha= 5.3713   beta= 14690.09 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015874 </span></span>
<span><span class="co">#&gt; gamma= 30.9879    alpha= 4.5776   beta= 33212.92 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016694 </span></span>
<span><span class="co">#&gt; gamma= 30.3109    alpha= 5.1169   beta= 22330 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7014674 </span></span>
<span><span class="co">#&gt; gamma= 31.0504    alpha= 5.3045   beta= 16203.19 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016579 </span></span>
<span><span class="co">#&gt; gamma= 31.3034    alpha= 5.5572   beta= 14265.58 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015323 </span></span>
<span><span class="co">#&gt; gamma= 31.5195    alpha= 5.4152   beta= 16280.12 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016246 </span></span>
<span><span class="co">#&gt; gamma= 29.1298    alpha= 4.4154   beta= 19890.05 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016523 </span></span>
<span><span class="co">#&gt; gamma= 31.4777    alpha= 5.7411   beta= 14662.8 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7014899 </span></span>
<span><span class="co">#&gt; gamma= 31.6415    alpha= 4.6533   beta= 17256.76 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015469 </span></span>
<span><span class="co">#&gt; gamma= 31.3987    alpha= 5.3242   beta= 14257.68 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016246 </span></span>
<span><span class="co">#&gt; gamma= 31.5294    alpha= 5.1328   beta= 14909.11 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016356 </span></span>
<span><span class="co">#&gt; gamma= 31.3673    alpha= 5.0348   beta= 16423.81 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015771 </span></span>
<span><span class="co">#&gt; gamma= 31.6411    alpha= 5.7092   beta= 14018.46 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015519 </span></span>
<span><span class="co">#&gt; gamma= 31.3911    alpha= 5.5519   beta= 15234.52 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7017288 </span></span>
<span><span class="co">#&gt; gamma= 30.9045    alpha= 4.9779   beta= 14752.83</span></span>
<span><span class="co">#&gt; [1] 0.1430853</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for BayesRNN function</span></span></code></pre></div>
</div>
<div id="boosted-random-forest" class="section level3" number="3.0.8">
<h3>
<span class="header-section-number">3.0.8</span> 5. Boosted Random Forest<a class="anchor" aria-label="anchor" href="#boosted-random-forest"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span><span class="va">boost_rf_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co">#Create the function:</span></span>
<span><span class="va">boost_rf_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co">#Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit boosted random forest model on the training data, make predictions on holdout data</span></span>
<span></span>
<span><span class="va">boost_rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">boost_rf_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">boost_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">boost_rf_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">boost_rf_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">boost_rf_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">boost_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">boost_rf_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">boost_rf_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">boost_rf_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the function</span></span>
<span></span>
<span><span class="fu">boost_rf_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3278237</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for Boosted Random Forest function</span></span></code></pre></div>
</div>
<div id="cubist" class="section level3" number="3.0.9">
<h3>
<span class="header-section-number">3.0.9</span> 6. Cubist<a class="anchor" aria-label="anchor" href="#cubist"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/Cubist//">Cubist</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">cubist_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span></span>
<span><span class="va">cubist_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model on the training data, make predictions on the holdout data</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;-</span> <span class="fu">Cubist</span><span class="fu">::</span><span class="fu"><a href="http://topepo.github.io/Cubist/reference/cubist.default.html">cubist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">cubist_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">cubist_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">cubist_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">cubist_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cubist_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for the function</span></span>
<span></span>
<span><span class="fu">cubist_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.400205</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual cubist function</span></span></code></pre></div>
</div>
<div id="elastic" class="section level3" number="3.0.10">
<h3>
<span class="header-section-number">3.0.10</span> 7. Elastic<a class="anchor" aria-label="anchor" href="#elastic"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu">glmnet</a></span><span class="op">)</span> <span class="co"># So we can run the elastic model</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">elastic_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">elastic_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_validation_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">elastic_validation_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">elastic_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up the elastic model</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">elastic_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">elastic_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html">cv.glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">best_elastic_lambda</span> <span class="op">&lt;-</span> <span class="va">elastic_cv</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="va">best_elastic_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">best_elastic_lambda</span><span class="op">)</span></span>
<span><span class="va">elastic_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">best_elastic_model</span>, s <span class="op">=</span> <span class="va">best_elastic_lambda</span>, newx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_test_RMSE</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">elastic_test_pred</span><span class="op">)</span></span>
<span><span class="va">elastic_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_df</span>, <span class="va">elastic_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_df</span><span class="op">$</span><span class="va">elastic_test_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">elastic_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_df</span>, <span class="va">elastic_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_df</span><span class="op">$</span><span class="va">elastic_holdout_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresample</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the elastic function</span></span>
<span></span>
<span><span class="fu">elastic_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.060079</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual elastic function</span></span></code></pre></div>
</div>
<div id="generalized-additive-models-with-smoothing-splines" class="section level3" number="3.0.11">
<h3>
<span class="header-section-number">3.0.11</span> 8. Generalized Additive Models with smoothing splines<a class="anchor" aria-label="anchor" href="#generalized-additive-models-with-smoothing-splines"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gam</span><span class="op">)</span> <span class="co"># for fitting generalized additive models</span></span>
<span><span class="co">#&gt; Loading required package: splines</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'foreach'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accumulate, when</span></span>
<span><span class="co">#&gt; Loaded gam 1.22-3</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">gam_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gam_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gam_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gam_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">gam1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up to fit the model on the training data</span></span>
<span></span>
<span><span class="va">n_unique_vals</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Names of columns with &gt;= 4 unique vals</span></span>
<span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">n_unique_vals</span><span class="op">)</span><span class="op">[</span><span class="va">n_unique_vals</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="va">gam_data</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model data</span></span>
<span></span>
<span><span class="va">train1</span> <span class="op">&lt;-</span> <span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test1</span> <span class="op">&lt;-</span> <span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">names_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gam_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">gam_data</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"y ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gam::s("</span>, <span class="va">names_df</span>, <span class="st">")"</span>, collapse <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gam_train_fit</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span><span class="op">(</span><span class="va">f2</span>, data <span class="op">=</span> <span class="va">train1</span><span class="op">)</span></span>
<span><span class="va">gam_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gam_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gam_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">gam_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gam_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gam_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">gam_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">gam_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gam_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for gam function</span></span>
<span></span>
<span><span class="fu">gam1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.051043</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual gam function</span></span></code></pre></div>
</div>
<div id="gradient-boosted" class="section level3" number="3.0.12">
<h3>
<span class="header-section-number">3.0.12</span> 9. Gradient Boosted<a class="anchor" aria-label="anchor" href="#gradient-boosted"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gbm-developers/gbm">gbm</a></span><span class="op">)</span> <span class="co"># to allow use of gradient boosted models</span></span>
<span><span class="co">#&gt; Loaded gbm 2.1.9</span></span>
<span><span class="co">#&gt; This version of gbm is no longer under development. Consider transitioning to gbm3, https://github.com/gbm-developers/gbm3</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">gb_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">gb1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">gb_train_fit</span> <span class="op">&lt;-</span> <span class="fu">gbm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gbm/man/gbm.html">gbm</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, distribution <span class="op">=</span> <span class="st">"gaussian"</span>, n.trees <span class="op">=</span> <span class="fl">100</span>, shrinkage <span class="op">=</span> <span class="fl">0.1</span>, interaction.depth <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">gb_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gb_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gb_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gb_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">gb_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gb_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gb_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gb_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gb_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for gb1 function</span></span>
<span></span>
<span><span class="fu">gb1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; [1] 3.579291</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual gradient boosted function</span></span></code></pre></div>
</div>
<div id="k-nearest-neighbors-tuned" class="section level3" number="3.0.13">
<h3>
<span class="header-section-number">3.0.13</span> 10. K-Nearest Neighbors (tuned)<a class="anchor" aria-label="anchor" href="#k-nearest-neighbors-tuned"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">knn_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">knn1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">knn_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.gknn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best.model</span>,</span>
<span>    newdata <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, k <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">k</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knn_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">knn_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best.model</span>,</span>
<span>    k <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">k</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knn_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">knn_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">knn_test_RMSE_mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knn_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">knn_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for knn1 function</span></span>
<span></span>
<span><span class="fu">knn1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.052156</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual knn function</span></span></code></pre></div>
</div>
<div id="lasso" class="section level3" number="3.0.14">
<h3>
<span class="header-section-number">3.0.14</span> 11. Lasso<a class="anchor" aria-label="anchor" href="#lasso"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu">glmnet</a></span><span class="op">)</span> <span class="co"># So we can run the lasso model</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">lasso_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">lasso_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_validation_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">lasso_validation_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">lasso_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up the lasso model</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lasso_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">lasso_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html">cv.glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">best_lasso_lambda</span> <span class="op">&lt;-</span> <span class="va">lasso_cv</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="va">best_lasso_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">best_lasso_lambda</span><span class="op">)</span></span>
<span><span class="va">lasso_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">best_lasso_model</span>, s <span class="op">=</span> <span class="va">best_lasso_lambda</span>, newx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lasso_test_RMSE</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">lasso_test_pred</span><span class="op">)</span></span>
<span><span class="va">lasso_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_df</span>, <span class="va">lasso_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_df</span><span class="op">$</span><span class="va">lasso_test_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lasso_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">lasso_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_df</span>, <span class="va">lasso_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_df</span><span class="op">$</span><span class="va">lasso_holdout_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresample</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the lasso_1 function</span></span>
<span></span>
<span><span class="fu">lasso_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.010819</span></span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual lasso function</span></span></code></pre></div>
</div>
<div id="linear-tuned" class="section level3" number="3.0.15">
<h3>
<span class="header-section-number">3.0.15</span> 12. Linear (tuned)<a class="anchor" aria-label="anchor" href="#linear-tuned"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span> <span class="co"># for tuned linear models</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">linear_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">linear_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">linear_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Set up the function</span></span>
<span><span class="va">linear1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">linear_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.rpart</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">linear_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">linear_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">linear_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">linear_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">linear_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">linear_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">linear_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">linear_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">linear_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for linear1 function</span></span>
<span></span>
<span><span class="fu">linear1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.805244</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual lasso function</span></span></code></pre></div>
</div>
<div id="lqs" class="section level3" number="3.0.16">
<h3>
<span class="header-section-number">3.0.16</span> 13. LQS<a class="anchor" aria-label="anchor" href="#lqs"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># to allow us to run LQS models</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">lqs_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">lqs1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">lqs_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lqs.html">lqs</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">lqs_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">lqs_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lqs_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lqs_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">lqs_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">lqs_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lqs_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lqs_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_hat_lqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lqs_test_predict_value</span>, <span class="va">lqs_validation_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">lqs_test_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for lqs1 function</span></span>
<span></span>
<span><span class="fu">lqs1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 7.741189</span></span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual lqs function</span></span></code></pre></div>
</div>
<div id="neuralnet" class="section level3" number="3.0.17">
<h3>
<span class="header-section-number">3.0.17</span> 14. Neuralnet<a class="anchor" aria-label="anchor" href="#neuralnet"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bips-hb/neuralnet">neuralnet</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'neuralnet'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     compute</span></span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span></span>
<span><span class="va">neuralnet_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Fit the model to the training data</span></span>
<span><span class="va">neuralnet1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test data sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">maxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span><span class="va">mins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span><span class="va">scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">df</span>, center <span class="op">=</span> <span class="va">mins</span>, scale <span class="op">=</span> <span class="va">maxs</span> <span class="op">-</span> <span class="va">mins</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_</span> <span class="op">&lt;-</span> <span class="va">scaled</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test_</span> <span class="op">&lt;-</span> <span class="va">scaled</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"y ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">n</span><span class="op">[</span><span class="op">!</span><span class="va">n</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="st">"y"</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">train_</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, linear.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">predict_test_nn</span> <span class="op">&lt;-</span> <span class="fu">neuralnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">nn</span>, <span class="va">test_</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">predict_test_nn_</span> <span class="op">&lt;-</span> <span class="va">predict_test_nn</span><span class="op">$</span><span class="va">net.result</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">predict_train_nn</span> <span class="op">&lt;-</span> <span class="fu">neuralnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">nn</span>, <span class="va">train_</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">predict_train_nn_</span> <span class="op">&lt;-</span> <span class="va">predict_train_nn</span><span class="op">$</span><span class="va">net.result</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">neuralnet_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">predict_train_nn_</span><span class="op">)</span></span>
<span><span class="va">neuralnet_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">neuralnet_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">neuralnet_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">predict_test_nn_</span><span class="op">)</span></span>
<span><span class="va">neuralnet_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">neuralnet_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">neuralnet_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">neuralnet_test_RMSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">neuralnet_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">neuralnet_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">neuralnet_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for neuralnet1 function</span></span>
<span></span>
<span><span class="fu">neuralnet1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.934191</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual neuralnet function</span></span></code></pre></div>
</div>
<div id="partial-least-squares" class="section level3" number="3.0.18">
<h3>
<span class="header-section-number">3.0.18</span> 15. Partial Least Squares<a class="anchor" aria-label="anchor" href="#partial-least-squares"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/pls">pls</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pls'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     coefplot, corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">pls_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">pls1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">pls_train_fit</span> <span class="op">&lt;-</span> <span class="fu">pls</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvr.html">plsr</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">pls_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pls_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pls_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pls_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">pls_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pls_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pls_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pls_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="va">pls_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for pls1 function</span></span>
<span></span>
<span><span class="fu">pls1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.160096</span></span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual pls function</span></span></code></pre></div>
</div>
<div id="principal-components-regression" class="section level3" number="3.0.19">
<h3>
<span class="header-section-number">3.0.19</span> 16. Principal Components Regression<a class="anchor" aria-label="anchor" href="#principal-components-regression"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/pls">pls</a></span><span class="op">)</span> <span class="co"># To run pcr models</span></span>
<span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span><span class="va">pcr_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">pcr1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">pcr_train_fit</span> <span class="op">&lt;-</span> <span class="fu">pls</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvr.html">pcr</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">pcr_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pcr_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pcr_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pcr_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">pcr_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pcr_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pcr_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pcr_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pcr_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for PCR function</span></span>
<span></span>
<span><span class="fu">pcr1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.444914</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual pls function</span></span></code></pre></div>
</div>
<div id="random-forest" class="section level3" number="3.0.20">
<h3>
<span class="header-section-number">3.0.20</span> 17. Random Forest<a class="anchor" aria-label="anchor" href="#random-forest"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">rf_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Set up the function</span></span>
<span><span class="va">rf1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">rf_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">rf_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rf_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for rf1 function</span></span>
<span></span>
<span><span class="fu">rf1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.767656</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual random forest function</span></span></code></pre></div>
</div>
<div id="ridge-regression" class="section level3" number="3.0.21">
<h3>
<span class="header-section-number">3.0.21</span> 18. Ridge Regression<a class="anchor" aria-label="anchor" href="#ridge-regression"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu">glmnet</a></span><span class="op">)</span> <span class="co"># So we can run the ridge model</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">ridge_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ridge_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_validation_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ridge_validation_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">ridge1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up the ridge model</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ridge_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html">cv.glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">best_ridge_lambda</span> <span class="op">&lt;-</span> <span class="va">ridge_cv</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="va">best_ridge_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">best_ridge_lambda</span><span class="op">)</span></span>
<span><span class="va">ridge_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">best_ridge_model</span>, s <span class="op">=</span> <span class="va">best_ridge_lambda</span>, newx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ridge_test_RMSE</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">ridge_test_pred</span><span class="op">)</span></span>
<span><span class="va">ridge_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_df</span>, <span class="va">ridge_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_df</span><span class="op">$</span><span class="va">ridge_test_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ridge_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">ridge_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_df</span>, <span class="va">ridge_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_df</span><span class="op">$</span><span class="va">ridge_holdout_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresample</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the ridge function</span></span>
<span></span>
<span><span class="fu">ridge1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.993241</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual ridge function</span></span></code></pre></div>
</div>
<div id="robust-regression" class="section level3" number="3.0.22">
<h3>
<span class="header-section-number">3.0.22</span> 19. Robust Regression<a class="anchor" aria-label="anchor" href="#robust-regression"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># To run rlm function for robust regression</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">robust_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">robust1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">robust_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">robust_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">robust_train_fit</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="va">robust_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">robust_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">robust_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">robust_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">robust_test_RMSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">robust_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for robust1 function</span></span>
<span></span>
<span><span class="fu">robust1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.054642</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual robust function</span></span></code></pre></div>
</div>
<div id="rpart" class="section level3" number="3.0.23">
<h3>
<span class="header-section-number">3.0.23</span> 20. Rpart<a class="anchor" aria-label="anchor" href="#rpart"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">rpart_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">rpart1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">rpart_train_fit</span> <span class="op">&lt;-</span> <span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">rpart_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rpart_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rpart_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rpart_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">rpart_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rpart_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rpart_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rpart_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for numresamples</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rpart_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for rpart1 function</span></span>
<span></span>
<span><span class="fu">rpart1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.793699</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual rpart function</span></span></code></pre></div>
</div>
<div id="support-vector-machines" class="section level3" number="3.0.24">
<h3>
<span class="header-section-number">3.0.24</span> 21. Support Vector Machines<a class="anchor" aria-label="anchor" href="#support-vector-machines"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">svm_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">svm1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">svm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.svm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">svm_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">svm_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">svm_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">svm_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">svm_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">svm_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">svm_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">svm_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">svm_test_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for svm1 function</span></span>
<span></span>
<span><span class="fu">svm1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.426661</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual Support Vector Machines function</span></span></code></pre></div>
</div>
<div id="trees" class="section level3" number="3.0.25">
<h3>
<span class="header-section-number">3.0.25</span> 22. Trees<a class="anchor" aria-label="anchor" href="#trees"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">tree_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">tree_train_fit</span> <span class="op">&lt;-</span> <span class="fu">tree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tree/man/tree.html">tree</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">tree_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tree_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tree_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">tree_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tree_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tree_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">tree_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for tree1 function</span></span>
<span></span>
<span><span class="fu">tree1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.802842</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual tree function</span></span></code></pre></div>
</div>
<div id="xgboost" class="section level3" number="3.0.26">
<h3>
<span class="header-section-number">3.0.26</span> 23. XGBoost<a class="anchor" aria-label="anchor" href="#xgboost"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmlc/xgboost">xgboost</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'xgboost'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     slice</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">xgb_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span><span class="va">xgb1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">train_y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">test_y</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define final train, test and validation sets</span></span>
<span></span>
<span><span class="va">xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_x</span>, label <span class="op">=</span> <span class="va">train_y</span><span class="op">)</span></span>
<span><span class="va">xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_x</span>, label <span class="op">=</span> <span class="va">test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span><span class="op">)</span></span>
<span><span class="va">watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span>, test <span class="op">=</span> <span class="va">xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit XGBoost model and display training and validation data at each round</span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgboost_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">train_x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">xgb_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">test_x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">xgb_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">xgb_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for xgb1 function</span></span>
<span></span>
<span><span class="fu">xgb1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.566847    test-rmse:18.295836 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.001877    test-rmse:13.600278 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:8.857524 test-rmse:10.447422 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.648565 test-rmse:8.334287 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.137718 test-rmse:7.013896 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.116261 test-rmse:6.110523 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.420488 test-rmse:5.520650 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.002864 test-rmse:5.227048 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.707789 test-rmse:5.022301 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.521882 test-rmse:4.852310 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.405066 test-rmse:4.791663 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.320092 test-rmse:4.691732 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.240695 test-rmse:4.632454 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.156235 test-rmse:4.562374 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.119126 test-rmse:4.524297 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.079369 test-rmse:4.478217 </span></span>
<span><span class="co">#&gt; [17] train-rmse:2.020774 test-rmse:4.452389 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.946407 test-rmse:4.365773 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.857629 test-rmse:4.303493 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.835047 test-rmse:4.283662 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.796012 test-rmse:4.277377 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.763180 test-rmse:4.273819 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.748976 test-rmse:4.272261 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.689464 test-rmse:4.274587 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.660090 test-rmse:4.261288 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.648596 test-rmse:4.273753 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.587294 test-rmse:4.261752 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.557944 test-rmse:4.243167 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.541092 test-rmse:4.250105 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.512719 test-rmse:4.254290 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.495594 test-rmse:4.235982 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.471548 test-rmse:4.237962 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.461947 test-rmse:4.230278 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.440187 test-rmse:4.217669 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.412271 test-rmse:4.217333 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.394335 test-rmse:4.218771 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.354841 test-rmse:4.211338 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.344822 test-rmse:4.211056 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.312267 test-rmse:4.203068 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.280977 test-rmse:4.206494 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.261975 test-rmse:4.198913 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.248094 test-rmse:4.185089 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.212051 test-rmse:4.189859 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.199969 test-rmse:4.181182 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.193709 test-rmse:4.180919 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.163349 test-rmse:4.182952 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.136975 test-rmse:4.158753 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.112211 test-rmse:4.148918 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.105006 test-rmse:4.154884 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.088859 test-rmse:4.143711 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.076607 test-rmse:4.150342 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.072393 test-rmse:4.150674 </span></span>
<span><span class="co">#&gt; [53] train-rmse:1.064686 test-rmse:4.150741 </span></span>
<span><span class="co">#&gt; [54] train-rmse:1.053028 test-rmse:4.154434 </span></span>
<span><span class="co">#&gt; [55] train-rmse:1.020980 test-rmse:4.166082 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.998032 test-rmse:4.181283 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.987385 test-rmse:4.176308 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.962621 test-rmse:4.166486 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.958672 test-rmse:4.172673 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.935287 test-rmse:4.162383 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.925546 test-rmse:4.157751 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.920647 test-rmse:4.161055 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.914087 test-rmse:4.164519 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.891765 test-rmse:4.149640 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.876797 test-rmse:4.151246 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.866961 test-rmse:4.153165 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.862838 test-rmse:4.153364 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.846186 test-rmse:4.153644 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.833005 test-rmse:4.153704 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.818758 test-rmse:4.151786 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.476615    test-rmse:16.712516 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.706851    test-rmse:12.104079 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.325248 test-rmse:8.891638 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.967080 test-rmse:6.638769 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.361310 test-rmse:5.243285 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.273568 test-rmse:4.382146 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.571172 test-rmse:3.854521 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.096809 test-rmse:3.553356 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.785035 test-rmse:3.411058 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.542470 test-rmse:3.289487 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.396477 test-rmse:3.266160 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.249223 test-rmse:3.219625 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.165404 test-rmse:3.248116 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.082891 test-rmse:3.199139 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.024894 test-rmse:3.190043 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.965081 test-rmse:3.156556 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.882508 test-rmse:3.154637 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.828034 test-rmse:3.162224 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.778963 test-rmse:3.188254 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.726786 test-rmse:3.180868 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.702797 test-rmse:3.170957 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.667876 test-rmse:3.193273 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.636254 test-rmse:3.197338 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.588035 test-rmse:3.199324 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.561565 test-rmse:3.203509 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.523799 test-rmse:3.181351 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.490133 test-rmse:3.183189 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.474789 test-rmse:3.183359 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.432077 test-rmse:3.168793 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.399415 test-rmse:3.179798 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.368031 test-rmse:3.164018 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.339634 test-rmse:3.155773 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.322923 test-rmse:3.167707 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.312939 test-rmse:3.162325 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.291858 test-rmse:3.162030 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.266042 test-rmse:3.157177 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.249867 test-rmse:3.155634 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.233007 test-rmse:3.162457 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.202567 test-rmse:3.158863 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.192454 test-rmse:3.166728 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.185654 test-rmse:3.161986 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.156329 test-rmse:3.155749 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.132966 test-rmse:3.156878 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.099172 test-rmse:3.160830 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.084264 test-rmse:3.166902 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.077450 test-rmse:3.176762 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.069471 test-rmse:3.172082 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.047696 test-rmse:3.161650 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.029634 test-rmse:3.164930 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.011847 test-rmse:3.161962 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.988660 test-rmse:3.161577 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.966914 test-rmse:3.157507 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.958587 test-rmse:3.158530 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.946078 test-rmse:3.158107 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.936126 test-rmse:3.159700 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.920098 test-rmse:3.164522 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.903369 test-rmse:3.158688 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.888368 test-rmse:3.159415 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.880155 test-rmse:3.161047 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.869179 test-rmse:3.160468 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.862545 test-rmse:3.161371 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.858606 test-rmse:3.162070 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.843402 test-rmse:3.155911 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.839111 test-rmse:3.155235 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.820921 test-rmse:3.167764 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.813685 test-rmse:3.167962 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.799078 test-rmse:3.165993 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.792911 test-rmse:3.161664 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.783525 test-rmse:3.157303 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.763116 test-rmse:3.158526 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.940826    test-rmse:17.620587 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.287029    test-rmse:12.895806 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.027421 test-rmse:9.716785 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.807202 test-rmse:7.638635 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.285410 test-rmse:6.357400 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.227195 test-rmse:5.469514 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.530453 test-rmse:4.865071 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.043198 test-rmse:4.480110 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.743274 test-rmse:4.283322 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.503662 test-rmse:4.143151 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.341390 test-rmse:4.081705 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.223119 test-rmse:3.949371 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.145158 test-rmse:3.869653 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.070649 test-rmse:3.838803 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.018632 test-rmse:3.823521 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.932049 test-rmse:3.813291 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.869901 test-rmse:3.774552 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.834118 test-rmse:3.751064 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.793967 test-rmse:3.744829 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.752734 test-rmse:3.733358 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.702178 test-rmse:3.752904 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.654633 test-rmse:3.752624 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.628374 test-rmse:3.750038 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.595693 test-rmse:3.753647 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.571161 test-rmse:3.746137 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.544879 test-rmse:3.745566 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.517060 test-rmse:3.732738 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.485936 test-rmse:3.703911 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.447648 test-rmse:3.696419 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.413967 test-rmse:3.705468 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.381059 test-rmse:3.706452 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.344287 test-rmse:3.709454 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.305949 test-rmse:3.701470 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.267424 test-rmse:3.698444 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.249651 test-rmse:3.686810 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.242664 test-rmse:3.682350 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.222246 test-rmse:3.676340 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.200541 test-rmse:3.672680 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.183422 test-rmse:3.674608 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.162316 test-rmse:3.663248 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.141830 test-rmse:3.655922 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.128091 test-rmse:3.655636 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.096402 test-rmse:3.649646 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.085053 test-rmse:3.645754 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.065475 test-rmse:3.635741 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.058745 test-rmse:3.639901 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.045324 test-rmse:3.631098 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.020385 test-rmse:3.629003 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.009853 test-rmse:3.629030 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.989406 test-rmse:3.628485 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.979389 test-rmse:3.630748 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.960420 test-rmse:3.629449 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.944153 test-rmse:3.632180 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.932651 test-rmse:3.632644 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.922669 test-rmse:3.633330 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.903807 test-rmse:3.629754 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.875761 test-rmse:3.624106 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.862721 test-rmse:3.626499 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.843045 test-rmse:3.622818 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.829702 test-rmse:3.618196 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.813128 test-rmse:3.612194 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.806017 test-rmse:3.609211 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.792542 test-rmse:3.600465 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.781655 test-rmse:3.594607 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.768599 test-rmse:3.583260 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.759774 test-rmse:3.584345 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.748496 test-rmse:3.585526 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.733068 test-rmse:3.584602 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.727257 test-rmse:3.583001 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.714099 test-rmse:3.581297 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.385765    test-rmse:16.794756 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.670146    test-rmse:12.264586 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.314821 test-rmse:9.065502 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.000134 test-rmse:6.953405 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.405117 test-rmse:5.523697 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.326401 test-rmse:4.681973 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.623907 test-rmse:4.130183 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.178648 test-rmse:3.823766 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.855376 test-rmse:3.663213 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.593623 test-rmse:3.573890 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.439111 test-rmse:3.489961 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.312032 test-rmse:3.455668 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.221071 test-rmse:3.439968 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.108566 test-rmse:3.380220 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.004805 test-rmse:3.372307 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.951018 test-rmse:3.361490 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.891175 test-rmse:3.336966 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.860596 test-rmse:3.342489 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.820702 test-rmse:3.337561 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.770482 test-rmse:3.301025 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.727679 test-rmse:3.271536 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.692517 test-rmse:3.275990 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.643101 test-rmse:3.288711 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.616868 test-rmse:3.286152 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.578256 test-rmse:3.285970 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.515484 test-rmse:3.289535 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.478759 test-rmse:3.303692 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.449194 test-rmse:3.311711 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.408619 test-rmse:3.345546 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.387780 test-rmse:3.338399 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.354574 test-rmse:3.330419 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.322153 test-rmse:3.345416 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.310442 test-rmse:3.356520 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.279219 test-rmse:3.359315 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.262447 test-rmse:3.369878 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.225963 test-rmse:3.364055 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.196766 test-rmse:3.366739 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.177675 test-rmse:3.365982 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.170192 test-rmse:3.372613 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.155881 test-rmse:3.374185 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.127849 test-rmse:3.394838 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.088085 test-rmse:3.387102 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.069883 test-rmse:3.384299 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.060051 test-rmse:3.390040 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.033736 test-rmse:3.409566 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.007798 test-rmse:3.414272 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.997527 test-rmse:3.414263 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.979780 test-rmse:3.409749 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.949130 test-rmse:3.415667 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.939405 test-rmse:3.414446 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.921432 test-rmse:3.414354 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.902725 test-rmse:3.418486 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.889964 test-rmse:3.413368 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.870040 test-rmse:3.412262 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.853867 test-rmse:3.410928 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.834157 test-rmse:3.407093 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.824457 test-rmse:3.409571 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.809492 test-rmse:3.410608 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.799750 test-rmse:3.410038 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.785987 test-rmse:3.407532 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.774586 test-rmse:3.406803 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.765715 test-rmse:3.406814 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.746053 test-rmse:3.403769 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.732835 test-rmse:3.408745 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.721152 test-rmse:3.407695 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.714833 test-rmse:3.404789 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.704015 test-rmse:3.406468 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.687991 test-rmse:3.407474 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.682328 test-rmse:3.406557 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.666911 test-rmse:3.406488 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.988515    test-rmse:17.627070 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.328131    test-rmse:12.957543 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.031109 test-rmse:9.525598 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.729942 test-rmse:7.223944 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.143532 test-rmse:5.704133 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.056384 test-rmse:4.679890 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.351660 test-rmse:4.103296 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.886013 test-rmse:3.758627 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.575575 test-rmse:3.524426 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.374128 test-rmse:3.419636 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.195364 test-rmse:3.359844 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.074972 test-rmse:3.272500 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.961812 test-rmse:3.194225 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.901956 test-rmse:3.201507 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.870940 test-rmse:3.186217 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.802847 test-rmse:3.184240 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.753162 test-rmse:3.158260 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.704044 test-rmse:3.149618 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.678835 test-rmse:3.137091 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.612179 test-rmse:3.140177 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.585593 test-rmse:3.130803 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.572557 test-rmse:3.118183 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.531643 test-rmse:3.140256 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.509104 test-rmse:3.133420 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.476578 test-rmse:3.138309 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.461619 test-rmse:3.122291 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.453615 test-rmse:3.123351 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.420323 test-rmse:3.104772 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.405515 test-rmse:3.108274 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.367252 test-rmse:3.110382 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.355996 test-rmse:3.104787 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.330491 test-rmse:3.119113 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.316774 test-rmse:3.121103 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.303470 test-rmse:3.111014 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.280759 test-rmse:3.119781 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.269170 test-rmse:3.115679 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.234440 test-rmse:3.117343 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.203275 test-rmse:3.116117 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.170265 test-rmse:3.119718 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.161107 test-rmse:3.120461 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.156858 test-rmse:3.122691 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.122966 test-rmse:3.107496 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.099592 test-rmse:3.105319 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.083191 test-rmse:3.096163 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.062763 test-rmse:3.106104 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.049289 test-rmse:3.099127 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.029801 test-rmse:3.096994 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.012888 test-rmse:3.100607 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.996024 test-rmse:3.107249 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.980183 test-rmse:3.106304 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.972154 test-rmse:3.102175 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.966438 test-rmse:3.101945 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.954552 test-rmse:3.104130 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.948947 test-rmse:3.098030 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.929715 test-rmse:3.096164 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.918693 test-rmse:3.087866 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.911486 test-rmse:3.085831 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.896170 test-rmse:3.083192 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.877669 test-rmse:3.084674 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.867397 test-rmse:3.091211 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.861446 test-rmse:3.089973 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.845836 test-rmse:3.086549 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.828992 test-rmse:3.081455 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.812027 test-rmse:3.074534 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.793364 test-rmse:3.075464 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.783802 test-rmse:3.078706 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.779578 test-rmse:3.077914 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.771363 test-rmse:3.078589 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.756333 test-rmse:3.074773 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.742274 test-rmse:3.069944 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.321959    test-rmse:16.774258 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.561934    test-rmse:12.298570 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.286895 test-rmse:9.245498 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.933006 test-rmse:7.179272 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.328855 test-rmse:5.874374 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.253427 test-rmse:5.083352 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.548404 test-rmse:4.565694 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.072836 test-rmse:4.339920 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.714252 test-rmse:4.210879 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.500005 test-rmse:4.114217 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.324530 test-rmse:4.050798 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.200729 test-rmse:4.035300 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.112021 test-rmse:3.970368 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.012419 test-rmse:3.940639 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.951779 test-rmse:3.910923 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.911819 test-rmse:3.911717 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.852198 test-rmse:3.871663 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.795860 test-rmse:3.886116 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.769939 test-rmse:3.878583 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.735634 test-rmse:3.863904 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.693778 test-rmse:3.875972 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.678357 test-rmse:3.872397 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.635299 test-rmse:3.838241 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.607056 test-rmse:3.839355 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.582201 test-rmse:3.835966 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.533953 test-rmse:3.832666 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.523273 test-rmse:3.845692 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.509610 test-rmse:3.842331 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.494145 test-rmse:3.842357 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.432359 test-rmse:3.837947 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.401277 test-rmse:3.830856 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.376588 test-rmse:3.831958 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.349368 test-rmse:3.826925 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.304012 test-rmse:3.807976 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.286216 test-rmse:3.810429 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.253230 test-rmse:3.812646 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.237035 test-rmse:3.810238 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.207467 test-rmse:3.793580 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.180626 test-rmse:3.786512 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.162318 test-rmse:3.779690 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.150061 test-rmse:3.782207 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.132723 test-rmse:3.780529 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.103424 test-rmse:3.768010 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.091152 test-rmse:3.744968 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.075710 test-rmse:3.743391 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.060600 test-rmse:3.740504 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.045323 test-rmse:3.745132 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.032176 test-rmse:3.742003 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.019129 test-rmse:3.743353 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.009357 test-rmse:3.739067 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.998351 test-rmse:3.739515 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.968744 test-rmse:3.737050 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.948280 test-rmse:3.733943 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.922214 test-rmse:3.735062 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.894645 test-rmse:3.738614 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.881368 test-rmse:3.735006 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.862454 test-rmse:3.735164 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.845040 test-rmse:3.736717 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.824536 test-rmse:3.742466 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.817390 test-rmse:3.741655 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.799640 test-rmse:3.724825 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.778461 test-rmse:3.727749 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.768820 test-rmse:3.726508 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.757031 test-rmse:3.717994 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.750929 test-rmse:3.719656 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.732423 test-rmse:3.722865 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.715445 test-rmse:3.722268 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.710682 test-rmse:3.718600 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.702250 test-rmse:3.718964 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.680833 test-rmse:3.715453 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.323344    test-rmse:16.887683 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.512398    test-rmse:12.409795 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.171131 test-rmse:9.399116 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.865599 test-rmse:7.366663 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.290222 test-rmse:6.117032 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.207435 test-rmse:5.199151 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.479597 test-rmse:4.719487 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.990186 test-rmse:4.396071 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.668102 test-rmse:4.194580 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.455356 test-rmse:4.098731 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.323447 test-rmse:3.989118 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.215922 test-rmse:3.992581 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.109730 test-rmse:3.948598 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.054346 test-rmse:3.909207 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.982701 test-rmse:3.879111 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.932368 test-rmse:3.877432 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.818206 test-rmse:3.829744 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.757775 test-rmse:3.800581 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.675877 test-rmse:3.767973 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.654063 test-rmse:3.766804 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.587751 test-rmse:3.739617 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.552599 test-rmse:3.726380 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.520064 test-rmse:3.711067 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.508405 test-rmse:3.720312 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.470924 test-rmse:3.735472 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.442288 test-rmse:3.730755 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.412341 test-rmse:3.733803 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.401643 test-rmse:3.732055 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.382986 test-rmse:3.732116 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.366508 test-rmse:3.753377 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.330571 test-rmse:3.753575 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.311493 test-rmse:3.755554 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.260804 test-rmse:3.765435 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.252092 test-rmse:3.766213 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.225012 test-rmse:3.764774 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.210006 test-rmse:3.755831 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.202187 test-rmse:3.760723 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.188864 test-rmse:3.759230 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.181029 test-rmse:3.761895 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.168316 test-rmse:3.766661 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.138756 test-rmse:3.758480 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.110167 test-rmse:3.758335 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.091759 test-rmse:3.761693 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.061706 test-rmse:3.755408 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.044165 test-rmse:3.750081 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.033604 test-rmse:3.741435 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.011237 test-rmse:3.747237 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.983079 test-rmse:3.747406 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.977700 test-rmse:3.750498 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.970572 test-rmse:3.750838 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.948303 test-rmse:3.754534 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.933015 test-rmse:3.748746 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.913438 test-rmse:3.754442 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.909884 test-rmse:3.758545 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.901655 test-rmse:3.770935 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.894783 test-rmse:3.771958 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.887991 test-rmse:3.763164 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.881060 test-rmse:3.762108 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.867273 test-rmse:3.751898 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.858725 test-rmse:3.753705 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.838373 test-rmse:3.763830 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.830943 test-rmse:3.759233 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.826514 test-rmse:3.766267 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.823175 test-rmse:3.766559 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.807660 test-rmse:3.767533 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.794098 test-rmse:3.765165 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.778397 test-rmse:3.770035 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.772503 test-rmse:3.771494 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.747584 test-rmse:3.767552 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.740816 test-rmse:3.764540 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.044051    test-rmse:17.598582 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.361020    test-rmse:13.070777 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.094743 test-rmse:9.941374 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.823861 test-rmse:7.838050 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.263417 test-rmse:6.425471 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.215828 test-rmse:5.438853 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.502785 test-rmse:4.984603 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.026065 test-rmse:4.662811 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.721890 test-rmse:4.363687 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.495576 test-rmse:4.231543 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.338947 test-rmse:4.141785 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.234066 test-rmse:4.081315 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.158419 test-rmse:4.021757 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.085335 test-rmse:4.008236 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.012131 test-rmse:4.001397 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.933621 test-rmse:3.986264 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.896756 test-rmse:3.925873 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.867964 test-rmse:3.925774 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.829713 test-rmse:3.879238 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.790533 test-rmse:3.855955 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.746201 test-rmse:3.861145 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.690864 test-rmse:3.817658 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.658930 test-rmse:3.775611 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.637712 test-rmse:3.777781 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.595910 test-rmse:3.757286 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.579251 test-rmse:3.748755 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.564803 test-rmse:3.744023 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.543134 test-rmse:3.721144 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.510350 test-rmse:3.709961 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.488938 test-rmse:3.700683 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.472471 test-rmse:3.706287 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.449769 test-rmse:3.709890 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.430000 test-rmse:3.714988 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.397398 test-rmse:3.707030 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.363955 test-rmse:3.699587 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.333442 test-rmse:3.698103 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.299325 test-rmse:3.698002 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.280210 test-rmse:3.698826 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.262763 test-rmse:3.698071 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.241038 test-rmse:3.699788 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.224637 test-rmse:3.696921 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.210522 test-rmse:3.684259 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.202150 test-rmse:3.690122 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.190017 test-rmse:3.688138 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.166656 test-rmse:3.684822 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.155027 test-rmse:3.684041 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.135007 test-rmse:3.687548 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.114548 test-rmse:3.682242 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.092828 test-rmse:3.683085 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.075588 test-rmse:3.680993 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.059238 test-rmse:3.664334 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.037551 test-rmse:3.660962 </span></span>
<span><span class="co">#&gt; [53] train-rmse:1.022884 test-rmse:3.643521 </span></span>
<span><span class="co">#&gt; [54] train-rmse:1.006510 test-rmse:3.640152 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.972259 test-rmse:3.641487 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.964384 test-rmse:3.643671 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.933300 test-rmse:3.642574 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.924543 test-rmse:3.646467 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.912426 test-rmse:3.647027 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.901072 test-rmse:3.644761 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.894141 test-rmse:3.641944 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.874174 test-rmse:3.650901 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.861625 test-rmse:3.654305 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.847851 test-rmse:3.636964 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.831352 test-rmse:3.634862 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.823780 test-rmse:3.629843 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.812325 test-rmse:3.625395 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.796279 test-rmse:3.614405 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.776594 test-rmse:3.617129 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.767391 test-rmse:3.613929 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.170895    test-rmse:17.540865 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.518578    test-rmse:13.151335 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.206967 test-rmse:9.794633 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.914678 test-rmse:7.547047 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.320936 test-rmse:5.979701 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.300025 test-rmse:5.106135 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.628148 test-rmse:4.486839 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.167276 test-rmse:4.080448 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.856795 test-rmse:3.851353 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.638298 test-rmse:3.608062 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.487609 test-rmse:3.467947 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.366785 test-rmse:3.409284 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.232873 test-rmse:3.368363 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.129441 test-rmse:3.277761 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.052034 test-rmse:3.226649 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.009219 test-rmse:3.206701 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.940478 test-rmse:3.175203 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.893435 test-rmse:3.158259 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.862652 test-rmse:3.172486 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.801562 test-rmse:3.186940 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.770672 test-rmse:3.188426 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.732201 test-rmse:3.187165 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.673226 test-rmse:3.164867 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.656786 test-rmse:3.153857 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.637156 test-rmse:3.159684 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.578651 test-rmse:3.160574 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.542109 test-rmse:3.153191 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.521919 test-rmse:3.158687 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.497534 test-rmse:3.150210 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.480342 test-rmse:3.131334 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.441255 test-rmse:3.116201 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.430575 test-rmse:3.124205 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.400415 test-rmse:3.127266 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.364291 test-rmse:3.120414 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.334748 test-rmse:3.113060 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.302551 test-rmse:3.113071 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.281874 test-rmse:3.115077 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.244729 test-rmse:3.108771 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.225519 test-rmse:3.106393 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.209392 test-rmse:3.103222 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.182575 test-rmse:3.103951 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.171319 test-rmse:3.106968 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.153272 test-rmse:3.093656 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.125798 test-rmse:3.090910 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.103927 test-rmse:3.097984 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.097017 test-rmse:3.093829 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.078219 test-rmse:3.091931 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.065487 test-rmse:3.088405 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.042989 test-rmse:3.094644 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.029686 test-rmse:3.099256 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.012739 test-rmse:3.089073 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.002601 test-rmse:3.088385 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.983105 test-rmse:3.093128 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.969584 test-rmse:3.086581 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.951424 test-rmse:3.081786 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.938979 test-rmse:3.083971 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.920503 test-rmse:3.076928 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.908392 test-rmse:3.076756 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.904085 test-rmse:3.078821 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.880048 test-rmse:3.080675 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.873038 test-rmse:3.082606 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.853135 test-rmse:3.073058 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.844088 test-rmse:3.069322 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.829665 test-rmse:3.073606 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.816083 test-rmse:3.071443 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.802582 test-rmse:3.067585 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.789541 test-rmse:3.060139 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.777767 test-rmse:3.068019 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.771780 test-rmse:3.067337 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.758804 test-rmse:3.067511 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.120072    test-rmse:17.205633 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.441414    test-rmse:12.381690 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.157665 test-rmse:9.012166 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.856267 test-rmse:6.942229 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.292154 test-rmse:5.541123 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.218657 test-rmse:4.641700 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.491688 test-rmse:4.170801 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.020847 test-rmse:3.884707 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.713909 test-rmse:3.667915 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.513685 test-rmse:3.561887 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.342838 test-rmse:3.430305 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.201219 test-rmse:3.381002 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.124123 test-rmse:3.381588 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.060950 test-rmse:3.357941 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.006157 test-rmse:3.334989 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.905435 test-rmse:3.314851 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.860574 test-rmse:3.302205 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.825841 test-rmse:3.286552 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.764498 test-rmse:3.255861 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.734601 test-rmse:3.260446 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.691928 test-rmse:3.236840 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.648116 test-rmse:3.235027 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.631069 test-rmse:3.230025 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.605170 test-rmse:3.225316 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.579480 test-rmse:3.213046 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.540571 test-rmse:3.221617 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.503467 test-rmse:3.214518 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.480958 test-rmse:3.210128 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.463905 test-rmse:3.206344 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.447949 test-rmse:3.197237 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.416408 test-rmse:3.202577 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.400635 test-rmse:3.208664 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.380655 test-rmse:3.198639 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.355856 test-rmse:3.181233 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.335305 test-rmse:3.179564 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.298753 test-rmse:3.182537 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.268010 test-rmse:3.173512 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.241321 test-rmse:3.177074 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.213382 test-rmse:3.184895 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.175449 test-rmse:3.180922 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.141018 test-rmse:3.177054 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.130889 test-rmse:3.178959 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.120073 test-rmse:3.183034 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.113177 test-rmse:3.178551 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.084548 test-rmse:3.187671 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.079891 test-rmse:3.188788 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.047196 test-rmse:3.178450 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.027513 test-rmse:3.174070 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.001774 test-rmse:3.154042 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.977110 test-rmse:3.153992 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.965694 test-rmse:3.157393 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.953294 test-rmse:3.152014 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.930325 test-rmse:3.150492 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.917532 test-rmse:3.152998 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.897069 test-rmse:3.150624 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.888930 test-rmse:3.149678 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.878738 test-rmse:3.148072 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.862263 test-rmse:3.144069 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.846056 test-rmse:3.143937 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.840649 test-rmse:3.143465 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.825235 test-rmse:3.146202 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.818611 test-rmse:3.145530 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.801086 test-rmse:3.150825 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.789049 test-rmse:3.158372 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.784521 test-rmse:3.156429 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.761073 test-rmse:3.152421 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.746497 test-rmse:3.149011 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.738125 test-rmse:3.151721 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.720135 test-rmse:3.153331 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.707547 test-rmse:3.163377 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.023882    test-rmse:17.563864 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.269273    test-rmse:13.191065 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:8.945738 test-rmse:10.222077 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.633549 test-rmse:8.228290 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.040055 test-rmse:7.011920 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:3.953076 test-rmse:6.163945 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.232299 test-rmse:5.642217 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.737867 test-rmse:5.318758 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.438273 test-rmse:5.118100 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.224739 test-rmse:5.047133 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.074463 test-rmse:4.937526 </span></span>
<span><span class="co">#&gt; [12] train-rmse:1.976551 test-rmse:4.878560 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.897620 test-rmse:4.853702 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.816070 test-rmse:4.796739 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.778009 test-rmse:4.791865 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.739783 test-rmse:4.765143 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.683148 test-rmse:4.747970 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.660325 test-rmse:4.747637 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.605003 test-rmse:4.734799 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.581467 test-rmse:4.735818 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.543347 test-rmse:4.720051 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.516976 test-rmse:4.716742 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.493828 test-rmse:4.708630 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.475674 test-rmse:4.714964 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.444951 test-rmse:4.717055 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.397475 test-rmse:4.712563 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.387247 test-rmse:4.701317 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.358862 test-rmse:4.709803 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.330462 test-rmse:4.694522 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.307189 test-rmse:4.688540 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.295407 test-rmse:4.675326 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.281960 test-rmse:4.676934 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.256713 test-rmse:4.671896 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.229986 test-rmse:4.669061 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.194477 test-rmse:4.670156 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.160844 test-rmse:4.685237 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.143638 test-rmse:4.681791 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.111245 test-rmse:4.684169 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.099496 test-rmse:4.673255 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.064249 test-rmse:4.654325 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.049932 test-rmse:4.650486 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.037882 test-rmse:4.656002 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.009303 test-rmse:4.644184 </span></span>
<span><span class="co">#&gt; [44] train-rmse:0.989942 test-rmse:4.636316 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.973487 test-rmse:4.632211 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.963268 test-rmse:4.639360 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.946897 test-rmse:4.632759 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.929681 test-rmse:4.628163 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.925963 test-rmse:4.626612 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.909648 test-rmse:4.617172 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.895271 test-rmse:4.610602 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.867565 test-rmse:4.605412 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.860844 test-rmse:4.610389 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.848021 test-rmse:4.609577 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.837087 test-rmse:4.603181 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.823987 test-rmse:4.603746 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.798760 test-rmse:4.593155 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.789874 test-rmse:4.589935 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.781605 test-rmse:4.593616 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.777567 test-rmse:4.590960 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.760254 test-rmse:4.593655 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.741331 test-rmse:4.592714 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.732111 test-rmse:4.592398 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.729240 test-rmse:4.595556 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.723922 test-rmse:4.589123 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.710034 test-rmse:4.589352 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.700937 test-rmse:4.590984 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.680924 test-rmse:4.590127 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.668874 test-rmse:4.582640 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.660979 test-rmse:4.583414 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.632975    test-rmse:18.402482 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.084679    test-rmse:14.024370 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:8.872609 test-rmse:10.594402 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.666727 test-rmse:8.359604 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.135195 test-rmse:6.910258 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.118610 test-rmse:6.021983 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.421797 test-rmse:5.277892 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.984047 test-rmse:4.875201 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.666508 test-rmse:4.669088 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.442604 test-rmse:4.400238 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.263024 test-rmse:4.230482 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.121456 test-rmse:4.079175 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.009415 test-rmse:3.969395 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.925757 test-rmse:3.935991 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.877151 test-rmse:3.906905 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.815046 test-rmse:3.890979 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.722805 test-rmse:3.843355 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.678251 test-rmse:3.822660 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.638035 test-rmse:3.805111 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.586498 test-rmse:3.772204 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.555798 test-rmse:3.754926 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.521831 test-rmse:3.739119 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.485348 test-rmse:3.720224 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.452430 test-rmse:3.720954 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.401942 test-rmse:3.678907 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.347862 test-rmse:3.626140 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.333065 test-rmse:3.620101 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.304386 test-rmse:3.602639 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.276703 test-rmse:3.607050 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.264345 test-rmse:3.608845 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.250547 test-rmse:3.614718 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.218531 test-rmse:3.599399 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.177848 test-rmse:3.594882 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.144331 test-rmse:3.618441 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.132708 test-rmse:3.619260 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.121853 test-rmse:3.618322 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.107662 test-rmse:3.623112 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.097314 test-rmse:3.622504 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.091235 test-rmse:3.613645 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.080512 test-rmse:3.610760 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.053192 test-rmse:3.602607 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.040840 test-rmse:3.602440 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.023147 test-rmse:3.599051 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.002725 test-rmse:3.593594 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.975447 test-rmse:3.591580 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.955695 test-rmse:3.587632 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.945853 test-rmse:3.589384 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.940748 test-rmse:3.586710 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.924930 test-rmse:3.581747 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.918651 test-rmse:3.579613 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.906455 test-rmse:3.580222 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.890968 test-rmse:3.579130 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.872706 test-rmse:3.568474 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.858351 test-rmse:3.564070 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.849300 test-rmse:3.560762 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.839321 test-rmse:3.562311 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.822098 test-rmse:3.571710 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.810739 test-rmse:3.568650 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.797141 test-rmse:3.564591 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.784108 test-rmse:3.568265 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.775899 test-rmse:3.566012 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.771441 test-rmse:3.564280 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.760396 test-rmse:3.565345 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.750564 test-rmse:3.566748 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.742772 test-rmse:3.570976 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.726596 test-rmse:3.574597 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.719990 test-rmse:3.577241 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.703763 test-rmse:3.587239 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.688217 test-rmse:3.581395 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.678489 test-rmse:3.584277 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.420586    test-rmse:16.803931 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.632942    test-rmse:12.057325 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.321768 test-rmse:9.048377 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.009684 test-rmse:6.770864 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.419812 test-rmse:5.420105 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.380042 test-rmse:4.697201 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.626264 test-rmse:4.264077 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.152862 test-rmse:3.967050 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.828154 test-rmse:3.805159 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.581239 test-rmse:3.609835 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.400240 test-rmse:3.508118 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.247041 test-rmse:3.492614 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.139544 test-rmse:3.480955 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.047876 test-rmse:3.441028 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.969279 test-rmse:3.418413 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.928213 test-rmse:3.406006 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.859272 test-rmse:3.376072 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.793148 test-rmse:3.375488 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.755568 test-rmse:3.356838 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.716810 test-rmse:3.349448 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.683483 test-rmse:3.332201 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.657629 test-rmse:3.339370 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.610634 test-rmse:3.316619 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.571209 test-rmse:3.299268 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.549698 test-rmse:3.306010 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.538426 test-rmse:3.302109 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.513778 test-rmse:3.302920 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.469105 test-rmse:3.318813 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.424691 test-rmse:3.299384 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.407023 test-rmse:3.309983 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.386734 test-rmse:3.318788 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.350868 test-rmse:3.311731 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.342330 test-rmse:3.314040 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.307345 test-rmse:3.307154 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.291813 test-rmse:3.306095 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.280663 test-rmse:3.313352 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.245434 test-rmse:3.308364 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.230180 test-rmse:3.305575 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.215316 test-rmse:3.307525 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.183399 test-rmse:3.301347 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.160984 test-rmse:3.299754 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.147713 test-rmse:3.295631 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.139061 test-rmse:3.289814 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.112078 test-rmse:3.293741 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.104979 test-rmse:3.293868 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.078384 test-rmse:3.290930 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.058113 test-rmse:3.284939 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.035028 test-rmse:3.280781 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.025479 test-rmse:3.277803 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.995829 test-rmse:3.293224 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.976585 test-rmse:3.295553 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.967754 test-rmse:3.294619 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.946435 test-rmse:3.292584 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.934532 test-rmse:3.283227 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.914604 test-rmse:3.281806 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.909798 test-rmse:3.283366 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.901885 test-rmse:3.287257 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.883715 test-rmse:3.281733 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.869019 test-rmse:3.278942 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.851390 test-rmse:3.273285 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.834642 test-rmse:3.279204 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.826403 test-rmse:3.278465 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.815742 test-rmse:3.275544 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.799335 test-rmse:3.275844 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.785954 test-rmse:3.271935 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.775118 test-rmse:3.274313 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.770264 test-rmse:3.265371 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.763633 test-rmse:3.266875 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.752399 test-rmse:3.266356 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.733955 test-rmse:3.254622 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.206143    test-rmse:17.310606 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.475230    test-rmse:12.761037 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.211373 test-rmse:9.676766 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.937853 test-rmse:7.458836 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.354684 test-rmse:5.988964 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.312569 test-rmse:5.071245 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.603969 test-rmse:4.505517 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.130441 test-rmse:4.239380 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.824796 test-rmse:4.091811 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.606360 test-rmse:3.995039 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.468222 test-rmse:3.900546 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.356540 test-rmse:3.883096 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.228585 test-rmse:3.844089 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.156309 test-rmse:3.795136 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.066807 test-rmse:3.756831 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.020746 test-rmse:3.755588 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.973536 test-rmse:3.714579 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.939959 test-rmse:3.742088 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.909877 test-rmse:3.720112 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.879773 test-rmse:3.717705 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.845108 test-rmse:3.694559 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.821461 test-rmse:3.700721 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.740543 test-rmse:3.727705 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.704768 test-rmse:3.713805 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.622321 test-rmse:3.699541 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.586920 test-rmse:3.665485 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.561497 test-rmse:3.654759 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.535832 test-rmse:3.634603 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.505243 test-rmse:3.621200 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.484575 test-rmse:3.616501 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.459651 test-rmse:3.646291 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.433545 test-rmse:3.635112 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.394871 test-rmse:3.627458 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.339169 test-rmse:3.621203 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.301722 test-rmse:3.609021 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.288915 test-rmse:3.603531 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.273098 test-rmse:3.599050 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.261219 test-rmse:3.596048 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.239203 test-rmse:3.594390 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.222750 test-rmse:3.600512 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.188663 test-rmse:3.597116 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.166662 test-rmse:3.589139 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.156084 test-rmse:3.602857 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.132052 test-rmse:3.592791 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.122293 test-rmse:3.587474 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.104472 test-rmse:3.581073 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.097093 test-rmse:3.574353 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.072563 test-rmse:3.567235 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.042838 test-rmse:3.562499 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.023958 test-rmse:3.565569 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.012712 test-rmse:3.562736 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.004095 test-rmse:3.558615 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.981545 test-rmse:3.549809 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.975209 test-rmse:3.548871 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.967470 test-rmse:3.541378 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.935473 test-rmse:3.534337 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.927019 test-rmse:3.542098 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.904968 test-rmse:3.538517 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.898375 test-rmse:3.535053 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.881136 test-rmse:3.534564 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.869588 test-rmse:3.529943 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.858381 test-rmse:3.529081 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.843445 test-rmse:3.528588 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.825035 test-rmse:3.539658 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.801397 test-rmse:3.538800 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.785303 test-rmse:3.536702 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.764640 test-rmse:3.527970 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.752227 test-rmse:3.522709 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.725835 test-rmse:3.522032 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.717273 test-rmse:3.528527 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.497372    test-rmse:16.705213 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.675198    test-rmse:12.169965 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.319557 test-rmse:8.980046 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.985055 test-rmse:6.970945 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.390176 test-rmse:5.667425 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.319376 test-rmse:4.787396 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.576026 test-rmse:4.186170 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.091486 test-rmse:3.923885 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.737457 test-rmse:3.746149 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.494671 test-rmse:3.634128 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.347501 test-rmse:3.570130 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.189063 test-rmse:3.474114 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.084397 test-rmse:3.450230 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.012493 test-rmse:3.413229 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.960176 test-rmse:3.396044 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.907340 test-rmse:3.388413 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.866869 test-rmse:3.386020 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.820518 test-rmse:3.359068 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.757013 test-rmse:3.358409 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.713591 test-rmse:3.347679 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.658347 test-rmse:3.324007 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.628121 test-rmse:3.302077 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.595465 test-rmse:3.295175 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.573173 test-rmse:3.301710 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.557127 test-rmse:3.296946 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.512672 test-rmse:3.267271 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.479931 test-rmse:3.266640 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.444716 test-rmse:3.271621 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.425789 test-rmse:3.270048 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.410675 test-rmse:3.276684 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.394562 test-rmse:3.268245 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.367539 test-rmse:3.283266 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.339492 test-rmse:3.284132 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.320548 test-rmse:3.283232 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.292458 test-rmse:3.304806 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.250490 test-rmse:3.304315 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.215407 test-rmse:3.306732 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.196963 test-rmse:3.315427 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.159897 test-rmse:3.310838 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.127439 test-rmse:3.297007 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.114539 test-rmse:3.290294 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.092330 test-rmse:3.295700 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.083105 test-rmse:3.298736 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.067643 test-rmse:3.295123 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.033607 test-rmse:3.298065 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.007633 test-rmse:3.315789 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.983573 test-rmse:3.312440 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.964810 test-rmse:3.316091 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.956272 test-rmse:3.316081 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.950150 test-rmse:3.319850 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.943727 test-rmse:3.330000 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.933783 test-rmse:3.330933 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.924993 test-rmse:3.329577 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.910063 test-rmse:3.330154 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.900702 test-rmse:3.327405 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.885572 test-rmse:3.316851 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.866154 test-rmse:3.324717 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.850172 test-rmse:3.324540 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.836721 test-rmse:3.334744 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.824576 test-rmse:3.329172 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.819755 test-rmse:3.331554 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.809218 test-rmse:3.330982 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.801793 test-rmse:3.338507 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.789447 test-rmse:3.336580 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.775831 test-rmse:3.334755 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.763123 test-rmse:3.332028 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.750921 test-rmse:3.327178 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.727153 test-rmse:3.324443 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.716003 test-rmse:3.324771 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.707029 test-rmse:3.323727 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.746953    test-rmse:16.088614 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.848058    test-rmse:11.738874 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.445858 test-rmse:8.724812 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.082045 test-rmse:6.689311 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.473613 test-rmse:5.404417 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.382359 test-rmse:4.585756 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.663277 test-rmse:4.135243 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.151459 test-rmse:3.810141 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.818541 test-rmse:3.623605 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.535063 test-rmse:3.503854 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.347760 test-rmse:3.427004 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.220339 test-rmse:3.383669 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.120341 test-rmse:3.333476 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.032737 test-rmse:3.324670 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.965348 test-rmse:3.298366 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.908704 test-rmse:3.267163 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.854787 test-rmse:3.264975 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.791170 test-rmse:3.243805 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.740559 test-rmse:3.214075 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.704997 test-rmse:3.181556 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.643535 test-rmse:3.166293 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.592413 test-rmse:3.165949 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.565962 test-rmse:3.166594 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.511071 test-rmse:3.183016 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.462349 test-rmse:3.165835 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.444158 test-rmse:3.168277 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.419945 test-rmse:3.138727 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.381454 test-rmse:3.132851 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.342097 test-rmse:3.124041 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.318796 test-rmse:3.107525 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.293426 test-rmse:3.107286 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.281636 test-rmse:3.080113 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.247643 test-rmse:3.073300 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.229100 test-rmse:3.081445 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.207040 test-rmse:3.070193 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.186971 test-rmse:3.064941 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.174614 test-rmse:3.060739 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.152327 test-rmse:3.052294 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.131991 test-rmse:3.055758 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.116384 test-rmse:3.052850 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.110065 test-rmse:3.046765 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.098135 test-rmse:3.046463 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.077706 test-rmse:3.038278 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.051197 test-rmse:3.043176 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.038141 test-rmse:3.050361 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.031067 test-rmse:3.046429 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.010061 test-rmse:3.042669 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.991994 test-rmse:3.041003 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.974017 test-rmse:3.043991 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.954146 test-rmse:3.043860 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.940643 test-rmse:3.043554 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.925621 test-rmse:3.048857 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.907251 test-rmse:3.063045 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.895753 test-rmse:3.064538 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.881166 test-rmse:3.064388 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.866438 test-rmse:3.067355 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.860904 test-rmse:3.064627 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.849280 test-rmse:3.071963 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.834151 test-rmse:3.077752 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.823731 test-rmse:3.074505 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.806629 test-rmse:3.072093 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.795235 test-rmse:3.063652 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.782851 test-rmse:3.057359 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.771702 test-rmse:3.057988 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.761396 test-rmse:3.063430 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.750726 test-rmse:3.064544 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.737999 test-rmse:3.063073 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.726631 test-rmse:3.069981 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.709756 test-rmse:3.068084 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.702123 test-rmse:3.072209 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.757345    test-rmse:16.205676 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.875820    test-rmse:11.608635 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.462338 test-rmse:8.523874 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.056919 test-rmse:6.321476 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.456711 test-rmse:5.045230 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.360768 test-rmse:4.358151 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.590120 test-rmse:3.811730 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.122081 test-rmse:3.503827 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.821735 test-rmse:3.434037 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.600017 test-rmse:3.309007 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.433657 test-rmse:3.292402 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.328481 test-rmse:3.270210 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.235187 test-rmse:3.215807 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.159686 test-rmse:3.195468 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.070844 test-rmse:3.175675 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.011279 test-rmse:3.197592 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.975715 test-rmse:3.198668 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.928552 test-rmse:3.204729 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.870943 test-rmse:3.208802 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.821949 test-rmse:3.203317 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.797158 test-rmse:3.200699 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.752589 test-rmse:3.163103 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.720680 test-rmse:3.155974 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.660530 test-rmse:3.160287 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.625455 test-rmse:3.158182 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.601794 test-rmse:3.164349 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.588628 test-rmse:3.175391 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.537036 test-rmse:3.163229 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.500139 test-rmse:3.181958 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.470186 test-rmse:3.189175 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.445744 test-rmse:3.181643 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.422065 test-rmse:3.176888 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.381573 test-rmse:3.190551 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.350240 test-rmse:3.181641 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.334542 test-rmse:3.180492 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.317453 test-rmse:3.186737 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.296085 test-rmse:3.202003 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.269124 test-rmse:3.203128 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.250360 test-rmse:3.193755 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.223990 test-rmse:3.186283 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.191271 test-rmse:3.195541 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.180929 test-rmse:3.198217 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.154820 test-rmse:3.204580 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.144795 test-rmse:3.201658 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.136989 test-rmse:3.204554 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.123091 test-rmse:3.206007 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.101891 test-rmse:3.189574 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.085828 test-rmse:3.179985 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.055641 test-rmse:3.189480 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.042670 test-rmse:3.200033 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.030204 test-rmse:3.198881 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.009598 test-rmse:3.198746 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.994990 test-rmse:3.206915 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.989716 test-rmse:3.208727 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.976126 test-rmse:3.205484 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.964928 test-rmse:3.209258 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.946495 test-rmse:3.203329 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.921372 test-rmse:3.201259 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.907611 test-rmse:3.204599 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.889665 test-rmse:3.206765 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.864126 test-rmse:3.207128 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.853117 test-rmse:3.206127 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.846385 test-rmse:3.204270 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.826482 test-rmse:3.208616 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.813973 test-rmse:3.204869 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.807103 test-rmse:3.203939 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.789126 test-rmse:3.203539 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.781736 test-rmse:3.204418 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.768352 test-rmse:3.194666 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.748397 test-rmse:3.191436 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.153358    test-rmse:17.247926 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.441687    test-rmse:12.652032 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.187360 test-rmse:9.469573 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.922300 test-rmse:7.287823 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.318238 test-rmse:5.978485 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.268214 test-rmse:5.063714 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.581960 test-rmse:4.560218 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.042221 test-rmse:4.064226 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.724658 test-rmse:3.933850 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.495427 test-rmse:3.809304 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.316863 test-rmse:3.620897 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.204720 test-rmse:3.567965 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.092047 test-rmse:3.518681 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.028509 test-rmse:3.495556 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.955107 test-rmse:3.423853 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.909453 test-rmse:3.412761 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.827261 test-rmse:3.333483 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.793152 test-rmse:3.316521 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.756339 test-rmse:3.302823 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.698962 test-rmse:3.318053 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.673975 test-rmse:3.318148 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.652197 test-rmse:3.300669 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.627174 test-rmse:3.287246 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.580979 test-rmse:3.260976 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.547157 test-rmse:3.254116 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.515574 test-rmse:3.249121 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.471449 test-rmse:3.265800 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.443393 test-rmse:3.275661 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.417479 test-rmse:3.269999 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.402362 test-rmse:3.274996 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.394953 test-rmse:3.269014 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.375341 test-rmse:3.261593 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.353052 test-rmse:3.260496 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.332705 test-rmse:3.262382 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.324803 test-rmse:3.256628 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.285419 test-rmse:3.225293 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.258540 test-rmse:3.228784 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.246189 test-rmse:3.224981 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.229884 test-rmse:3.197306 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.207481 test-rmse:3.191800 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.194144 test-rmse:3.191253 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.178394 test-rmse:3.189043 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.159140 test-rmse:3.198097 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.132824 test-rmse:3.184262 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.115965 test-rmse:3.187304 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.081659 test-rmse:3.183274 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.049598 test-rmse:3.185394 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.035387 test-rmse:3.185552 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.023945 test-rmse:3.185979 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.998014 test-rmse:3.184844 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.981964 test-rmse:3.182987 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.974405 test-rmse:3.184497 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.961793 test-rmse:3.188064 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.951966 test-rmse:3.185168 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.945683 test-rmse:3.183075 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.935008 test-rmse:3.181035 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.932093 test-rmse:3.184060 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.917324 test-rmse:3.189954 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.906029 test-rmse:3.187350 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.889095 test-rmse:3.189489 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.878756 test-rmse:3.189283 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.872081 test-rmse:3.190268 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.861711 test-rmse:3.186995 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.849970 test-rmse:3.188500 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.832303 test-rmse:3.176611 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.818736 test-rmse:3.185935 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.805083 test-rmse:3.183172 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.798027 test-rmse:3.176018 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.788944 test-rmse:3.181227 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.778040 test-rmse:3.174212 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.079528    test-rmse:17.377109 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.384860    test-rmse:12.625349 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.165314 test-rmse:9.311551 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.893540 test-rmse:7.021701 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.309133 test-rmse:5.393646 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.271522 test-rmse:4.430744 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.561669 test-rmse:3.837535 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.064646 test-rmse:3.522244 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.769855 test-rmse:3.251925 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.561877 test-rmse:3.167872 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.420761 test-rmse:3.088785 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.296889 test-rmse:3.020767 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.209150 test-rmse:2.976007 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.157451 test-rmse:2.961612 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.054361 test-rmse:2.959658 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.005199 test-rmse:2.964704 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.941198 test-rmse:2.960652 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.881997 test-rmse:2.935266 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.822826 test-rmse:2.920812 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.790203 test-rmse:2.904936 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.760105 test-rmse:2.891240 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.707131 test-rmse:2.896128 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.662741 test-rmse:2.901868 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.633643 test-rmse:2.898332 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.608720 test-rmse:2.891816 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.566568 test-rmse:2.928903 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.542651 test-rmse:2.920520 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.514065 test-rmse:2.928540 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.478750 test-rmse:2.930061 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.462296 test-rmse:2.917730 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.421458 test-rmse:2.910186 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.392717 test-rmse:2.909048 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.360096 test-rmse:2.901942 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.348711 test-rmse:2.895804 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.331264 test-rmse:2.881988 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.301336 test-rmse:2.895174 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.270702 test-rmse:2.877713 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.246264 test-rmse:2.900819 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.237540 test-rmse:2.903270 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.204781 test-rmse:2.899446 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.186700 test-rmse:2.888834 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.167358 test-rmse:2.898562 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.145142 test-rmse:2.901068 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.137023 test-rmse:2.896725 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.110583 test-rmse:2.896236 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.088840 test-rmse:2.889204 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.079157 test-rmse:2.888155 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.070868 test-rmse:2.884162 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.059954 test-rmse:2.880864 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.042157 test-rmse:2.888545 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.017776 test-rmse:2.878213 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.988539 test-rmse:2.874488 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.971234 test-rmse:2.868676 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.956523 test-rmse:2.863017 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.941375 test-rmse:2.862686 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.927121 test-rmse:2.861085 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.919926 test-rmse:2.855945 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.912473 test-rmse:2.865741 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.899319 test-rmse:2.865994 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.886971 test-rmse:2.860850 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.875922 test-rmse:2.856875 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.870501 test-rmse:2.855029 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.853772 test-rmse:2.853909 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.847366 test-rmse:2.860050 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.831146 test-rmse:2.859409 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.818748 test-rmse:2.848222 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.806568 test-rmse:2.842176 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.799445 test-rmse:2.833018 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.784608 test-rmse:2.814668 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.774472 test-rmse:2.817666 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.174497    test-rmse:17.264833 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.466474    test-rmse:12.619905 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.148978 test-rmse:9.390790 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.885397 test-rmse:7.204675 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.279459 test-rmse:5.841540 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.242885 test-rmse:5.017919 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.486216 test-rmse:4.416454 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.015869 test-rmse:4.114004 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.708992 test-rmse:3.924625 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.490774 test-rmse:3.806508 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.333321 test-rmse:3.718458 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.227711 test-rmse:3.679917 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.141888 test-rmse:3.660030 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.082735 test-rmse:3.674052 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.996223 test-rmse:3.611874 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.960814 test-rmse:3.588602 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.903594 test-rmse:3.572304 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.854117 test-rmse:3.560568 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.821896 test-rmse:3.559986 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.744679 test-rmse:3.563565 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.720437 test-rmse:3.557131 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.687881 test-rmse:3.559080 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.647137 test-rmse:3.538544 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.618445 test-rmse:3.541620 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.557838 test-rmse:3.483289 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.535155 test-rmse:3.493737 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.495709 test-rmse:3.496462 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.475953 test-rmse:3.497386 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.451411 test-rmse:3.506798 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.427954 test-rmse:3.507897 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.402805 test-rmse:3.493114 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.367876 test-rmse:3.466924 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.340332 test-rmse:3.460579 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.316756 test-rmse:3.466749 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.281867 test-rmse:3.467192 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.272643 test-rmse:3.455104 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.254233 test-rmse:3.457215 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.225753 test-rmse:3.449404 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.209607 test-rmse:3.452840 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.190480 test-rmse:3.455185 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.179451 test-rmse:3.454639 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.161244 test-rmse:3.452408 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.149862 test-rmse:3.457055 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.130977 test-rmse:3.462610 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.111614 test-rmse:3.462926 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.085415 test-rmse:3.457275 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.070715 test-rmse:3.472729 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.060586 test-rmse:3.472500 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.053762 test-rmse:3.461818 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.032720 test-rmse:3.463770 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.007656 test-rmse:3.464170 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.997822 test-rmse:3.464671 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.985003 test-rmse:3.463193 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.973618 test-rmse:3.464843 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.953144 test-rmse:3.461074 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.936272 test-rmse:3.460912 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.921454 test-rmse:3.468553 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.914720 test-rmse:3.476876 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.905542 test-rmse:3.472793 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.884523 test-rmse:3.474688 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.862461 test-rmse:3.472315 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.848348 test-rmse:3.478386 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.835287 test-rmse:3.478017 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.826955 test-rmse:3.480483 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.816417 test-rmse:3.479547 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.811387 test-rmse:3.490310 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.806071 test-rmse:3.492417 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.795524 test-rmse:3.500655 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.782489 test-rmse:3.503188 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.774461 test-rmse:3.500021 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.779350    test-rmse:18.207919 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.171179    test-rmse:13.445699 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:8.927165 test-rmse:10.283390 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.696618 test-rmse:8.345708 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.136253 test-rmse:6.780196 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.105116 test-rmse:5.797880 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.415105 test-rmse:5.308461 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.943451 test-rmse:4.918321 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.658312 test-rmse:4.680732 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.454329 test-rmse:4.567930 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.281712 test-rmse:4.379558 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.198491 test-rmse:4.335912 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.071788 test-rmse:4.304987 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.977886 test-rmse:4.205243 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.894389 test-rmse:4.182313 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.854751 test-rmse:4.159849 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.808117 test-rmse:4.152690 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.756165 test-rmse:4.155184 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.717520 test-rmse:4.161827 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.684331 test-rmse:4.163554 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.646353 test-rmse:4.162023 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.623560 test-rmse:4.156331 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.575575 test-rmse:4.121608 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.552324 test-rmse:4.118739 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.506545 test-rmse:4.111395 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.482322 test-rmse:4.104987 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.435784 test-rmse:4.090974 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.413571 test-rmse:4.090047 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.376245 test-rmse:4.078865 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.343570 test-rmse:4.054152 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.329362 test-rmse:4.052484 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.287098 test-rmse:4.053874 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.266878 test-rmse:4.055464 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.230480 test-rmse:4.036984 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.207075 test-rmse:4.024112 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.175968 test-rmse:4.021759 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.140574 test-rmse:3.998033 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.127684 test-rmse:3.998154 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.104108 test-rmse:3.994652 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.082294 test-rmse:4.015869 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.049164 test-rmse:4.023144 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.021966 test-rmse:4.025873 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.000787 test-rmse:4.022535 </span></span>
<span><span class="co">#&gt; [44] train-rmse:0.985148 test-rmse:4.018350 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.975522 test-rmse:4.013462 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.955586 test-rmse:4.018598 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.936245 test-rmse:4.013409 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.926763 test-rmse:4.014300 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.916715 test-rmse:4.005393 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.902231 test-rmse:4.002152 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.887179 test-rmse:4.001605 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.873935 test-rmse:4.002588 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.865345 test-rmse:4.001689 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.857539 test-rmse:4.001055 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.843897 test-rmse:4.009306 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.829447 test-rmse:4.002423 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.817708 test-rmse:4.001942 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.804459 test-rmse:4.002660 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.791290 test-rmse:3.990508 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.784867 test-rmse:3.989261 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.767499 test-rmse:3.980973 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.749397 test-rmse:3.985475 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.740022 test-rmse:3.986033 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.731210 test-rmse:3.987539 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.725246 test-rmse:3.995125 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.712231 test-rmse:3.996640 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.701003 test-rmse:3.995766 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.687988 test-rmse:3.997611 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.672621 test-rmse:3.992692 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.660912 test-rmse:3.992390 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.644143    test-rmse:16.369328 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.794632    test-rmse:11.929539 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.413120 test-rmse:8.985036 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.030341 test-rmse:7.014112 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.395858 test-rmse:5.668539 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.284418 test-rmse:4.805353 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.532857 test-rmse:4.321955 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.062053 test-rmse:4.041404 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.727744 test-rmse:3.880189 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.437574 test-rmse:3.759992 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.271091 test-rmse:3.729054 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.158544 test-rmse:3.660379 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.056166 test-rmse:3.614323 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.008425 test-rmse:3.581949 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.963335 test-rmse:3.562357 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.892000 test-rmse:3.550607 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.838552 test-rmse:3.593554 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.806830 test-rmse:3.585898 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.736500 test-rmse:3.585468 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.680566 test-rmse:3.569657 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.641793 test-rmse:3.554016 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.621415 test-rmse:3.546730 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.602346 test-rmse:3.569991 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.576039 test-rmse:3.560067 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.541867 test-rmse:3.543751 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.521339 test-rmse:3.536509 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.495745 test-rmse:3.541574 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.479090 test-rmse:3.548629 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.461375 test-rmse:3.553321 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.431670 test-rmse:3.549392 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.404947 test-rmse:3.552035 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.363493 test-rmse:3.549040 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.341505 test-rmse:3.548294 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.334772 test-rmse:3.545150 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.304933 test-rmse:3.532957 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.267487 test-rmse:3.538322 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.256616 test-rmse:3.535697 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.240113 test-rmse:3.522899 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.221487 test-rmse:3.520452 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.211621 test-rmse:3.527968 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.187889 test-rmse:3.522384 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.176825 test-rmse:3.516388 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.151752 test-rmse:3.521675 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.143956 test-rmse:3.520928 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.125564 test-rmse:3.533644 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.091267 test-rmse:3.526531 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.080519 test-rmse:3.526824 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.068470 test-rmse:3.523016 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.027419 test-rmse:3.513712 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.999058 test-rmse:3.510759 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.980671 test-rmse:3.507549 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.958796 test-rmse:3.499991 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.952550 test-rmse:3.504307 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.932789 test-rmse:3.490623 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.924410 test-rmse:3.496458 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.919869 test-rmse:3.498303 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.902118 test-rmse:3.499676 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.885793 test-rmse:3.499246 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.863765 test-rmse:3.484370 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.847728 test-rmse:3.477669 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.836233 test-rmse:3.475560 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.825694 test-rmse:3.471706 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.817225 test-rmse:3.472442 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.803572 test-rmse:3.472471 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.796228 test-rmse:3.472661 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.779853 test-rmse:3.468595 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.773933 test-rmse:3.467307 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.764835 test-rmse:3.459772 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.761240 test-rmse:3.459294 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.755777 test-rmse:3.459214 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.684751    test-rmse:16.500476 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.793272    test-rmse:11.937067 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.401096 test-rmse:8.867871 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.007000 test-rmse:6.741049 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.403779 test-rmse:5.400790 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.300519 test-rmse:4.586066 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.573068 test-rmse:4.168921 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.040646 test-rmse:3.871437 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.696866 test-rmse:3.704518 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.477213 test-rmse:3.618700 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.334902 test-rmse:3.575200 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.231843 test-rmse:3.554308 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.147690 test-rmse:3.488702 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.063000 test-rmse:3.411661 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.997862 test-rmse:3.390124 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.950103 test-rmse:3.368649 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.903784 test-rmse:3.362779 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.873729 test-rmse:3.361938 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.830452 test-rmse:3.356057 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.797668 test-rmse:3.327144 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.715509 test-rmse:3.297517 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.651769 test-rmse:3.295284 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.614815 test-rmse:3.294483 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.589045 test-rmse:3.279542 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.557201 test-rmse:3.268105 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.509195 test-rmse:3.242756 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.493377 test-rmse:3.237224 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.454785 test-rmse:3.246490 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.415584 test-rmse:3.247198 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.400648 test-rmse:3.249404 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.381394 test-rmse:3.253635 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.350793 test-rmse:3.255294 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.313821 test-rmse:3.237575 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.284443 test-rmse:3.244345 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.248565 test-rmse:3.249575 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.230584 test-rmse:3.242797 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.205088 test-rmse:3.241367 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.189449 test-rmse:3.225965 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.161576 test-rmse:3.236384 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.132401 test-rmse:3.232241 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.117285 test-rmse:3.238234 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.108723 test-rmse:3.241522 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.077248 test-rmse:3.257564 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.069290 test-rmse:3.265557 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.046985 test-rmse:3.257532 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.041975 test-rmse:3.266573 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.025338 test-rmse:3.261892 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.019173 test-rmse:3.263357 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.006527 test-rmse:3.264308 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.999569 test-rmse:3.263293 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.990109 test-rmse:3.265685 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.976736 test-rmse:3.267067 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.950653 test-rmse:3.272872 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.942109 test-rmse:3.264780 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.937606 test-rmse:3.274221 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.922337 test-rmse:3.272372 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.902798 test-rmse:3.268210 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.889290 test-rmse:3.267985 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.883539 test-rmse:3.270015 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.862743 test-rmse:3.261608 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.846788 test-rmse:3.266571 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.835584 test-rmse:3.261188 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.816480 test-rmse:3.257493 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.805986 test-rmse:3.247675 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.791130 test-rmse:3.246013 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.779006 test-rmse:3.244313 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.762253 test-rmse:3.239574 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.747020 test-rmse:3.240649 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.741704 test-rmse:3.240951 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.728181 test-rmse:3.239402 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.500320    test-rmse:16.577935 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.700782    test-rmse:12.026178 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.374607 test-rmse:8.883171 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.019407 test-rmse:6.866400 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.400458 test-rmse:5.585809 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.289105 test-rmse:4.803949 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.574879 test-rmse:4.343962 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.081702 test-rmse:4.088238 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.760779 test-rmse:3.924238 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.528432 test-rmse:3.842127 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.371529 test-rmse:3.794781 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.258979 test-rmse:3.748469 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.167540 test-rmse:3.738536 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.045130 test-rmse:3.704941 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.995062 test-rmse:3.693663 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.931012 test-rmse:3.685969 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.894994 test-rmse:3.695818 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.844343 test-rmse:3.687795 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.798131 test-rmse:3.695430 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.739249 test-rmse:3.654595 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.700298 test-rmse:3.601839 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.649804 test-rmse:3.576904 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.630151 test-rmse:3.563748 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.581735 test-rmse:3.553712 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.567455 test-rmse:3.537648 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.539873 test-rmse:3.529298 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.525838 test-rmse:3.522211 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.490469 test-rmse:3.526956 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.443220 test-rmse:3.521233 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.408247 test-rmse:3.518112 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.391281 test-rmse:3.508094 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.361160 test-rmse:3.513120 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.336057 test-rmse:3.514023 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.315465 test-rmse:3.508017 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.290935 test-rmse:3.511331 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.281778 test-rmse:3.508712 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.263491 test-rmse:3.503052 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.251507 test-rmse:3.493851 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.241208 test-rmse:3.493632 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.221975 test-rmse:3.485807 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.196739 test-rmse:3.490003 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.172633 test-rmse:3.490853 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.152701 test-rmse:3.485805 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.138961 test-rmse:3.487476 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.109313 test-rmse:3.475582 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.100207 test-rmse:3.469868 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.090441 test-rmse:3.470839 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.084244 test-rmse:3.469064 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.077133 test-rmse:3.469469 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.055232 test-rmse:3.461626 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.037104 test-rmse:3.462026 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.019209 test-rmse:3.470342 </span></span>
<span><span class="co">#&gt; [53] train-rmse:1.012538 test-rmse:3.471178 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.994863 test-rmse:3.461374 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.965409 test-rmse:3.453446 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.953566 test-rmse:3.450462 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.940082 test-rmse:3.452440 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.919081 test-rmse:3.452695 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.903928 test-rmse:3.460760 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.883478 test-rmse:3.462497 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.877497 test-rmse:3.464765 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.872967 test-rmse:3.463513 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.858929 test-rmse:3.466758 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.849939 test-rmse:3.462989 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.832749 test-rmse:3.465008 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.820749 test-rmse:3.467366 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.799739 test-rmse:3.470420 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.781536 test-rmse:3.467527 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.776637 test-rmse:3.467608 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.756403 test-rmse:3.466820 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.402750    test-rmse:16.672237 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.613865    test-rmse:12.068149 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.287956 test-rmse:8.946529 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.933049 test-rmse:6.872692 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.333376 test-rmse:5.543267 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.232659 test-rmse:4.710821 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.518554 test-rmse:4.225892 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.065487 test-rmse:3.984023 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.744047 test-rmse:3.822014 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.538783 test-rmse:3.735906 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.391563 test-rmse:3.711962 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.249077 test-rmse:3.637363 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.145327 test-rmse:3.639505 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.071817 test-rmse:3.617094 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.021594 test-rmse:3.594986 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.948477 test-rmse:3.571381 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.896602 test-rmse:3.555057 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.823711 test-rmse:3.546802 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.803024 test-rmse:3.535221 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.757521 test-rmse:3.523680 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.719815 test-rmse:3.505092 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.673410 test-rmse:3.516841 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.644435 test-rmse:3.522851 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.620934 test-rmse:3.504999 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.567626 test-rmse:3.513036 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.537336 test-rmse:3.501669 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.521802 test-rmse:3.507671 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.477356 test-rmse:3.515000 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.463061 test-rmse:3.511038 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.443271 test-rmse:3.516023 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.429034 test-rmse:3.500366 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.409486 test-rmse:3.513899 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.367020 test-rmse:3.530032 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.351872 test-rmse:3.529120 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.340334 test-rmse:3.534267 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.306939 test-rmse:3.527196 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.285643 test-rmse:3.530349 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.265536 test-rmse:3.536605 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.254320 test-rmse:3.527217 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.240069 test-rmse:3.540603 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.219325 test-rmse:3.545401 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.204344 test-rmse:3.538206 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.173548 test-rmse:3.537709 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.166427 test-rmse:3.544395 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.140547 test-rmse:3.563474 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.128052 test-rmse:3.568552 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.120925 test-rmse:3.571155 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.092155 test-rmse:3.586326 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.062622 test-rmse:3.584373 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.044057 test-rmse:3.581142 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.013747 test-rmse:3.573442 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.004978 test-rmse:3.573550 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.979008 test-rmse:3.571830 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.973746 test-rmse:3.575230 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.963112 test-rmse:3.577156 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.948297 test-rmse:3.554859 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.927097 test-rmse:3.557713 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.903443 test-rmse:3.564630 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.886617 test-rmse:3.571356 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.870010 test-rmse:3.568536 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.855544 test-rmse:3.565833 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.848755 test-rmse:3.568257 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.838522 test-rmse:3.567631 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.817649 test-rmse:3.561768 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.803753 test-rmse:3.558734 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.799405 test-rmse:3.560965 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.794757 test-rmse:3.556835 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.779397 test-rmse:3.554966 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.768486 test-rmse:3.557377 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.762586 test-rmse:3.558965</span></span>
<span><span class="co">#&gt; [1] 3.538308</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual XGBoost function</span></span></code></pre></div>
</div>
<div id="exercise-pick-four-of-the-functions-and-apply-them-with-other-numerical-data-sets." class="section level3" number="3.0.27">
<h3>
<span class="header-section-number">3.0.27</span> Exercise: Pick four of the functions and apply them with other numerical data sets.<a class="anchor" aria-label="anchor" href="#exercise-pick-four-of-the-functions-and-apply-them-with-other-numerical-data-sets."><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="post-the-results-of-your-work." class="section level3" number="3.0.28">
<h3>
<span class="header-section-number">3.0.28</span> Post the results of your work.<a class="anchor" aria-label="anchor" href="#post-the-results-of-your-work."><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="test-four-of-your-functions-on-a-neutral-data-set-mean-0-sd-1.-post-your-results-compare-most-accurate-to-least-accurate-results." class="section level3" number="3.0.29">
<h3>
<span class="header-section-number">3.0.29</span> Test four of your functions on a neutral data set (mean = 0, sd = 1). Post your results, compare most accurate to least accurate results.<a class="anchor" aria-label="anchor" href="#test-four-of-your-functions-on-a-neutral-data-set-mean-0-sd-1.-post-your-results-compare-most-accurate-to-least-accurate-results."><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">bland</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  X1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  X2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  X3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  X4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># test with cubist function:</span></span>
<span><span class="fu">cubist_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">bland</span>, colnum <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.004373</span></span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># apply with lqs function:</span></span>
<span><span class="fu">lqs1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">bland</span>, colnum <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, validation_amount <span class="op">=</span> <span class="fl">0.00</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.052853</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></div>
<div class="next"><a href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li>
<a class="nav-link" href="#numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#all-our-models-will-be-structured-the-same-way-y-.-data-train"><span class="header-section-number">3.0.1</span> All our models will be structured the same way: y ~ ., data = train</a></li>
<li><a class="nav-link" href="#having-the-same-structure-for-all-the-models-makes-it-much-easier-to-build-debug-and-deploy-the-completed-models."><span class="header-section-number">3.0.2</span> Having the same structure for all the models makes it much easier to build, debug, and deploy the completed models.</a></li>
<li><a class="nav-link" href="#exercise-re-read-the-steps-above-how-we-will-work-backwards-to-come-up-with-the-function-we-need."><span class="header-section-number">3.0.3</span> Exercise: Re-read the steps above how we will work backwards to come up with the function we need.</a></li>
<li><a class="nav-link" href="#bagged-random-forest"><span class="header-section-number">3.0.4</span> 1. Bagged Random Forest</a></li>
<li><a class="nav-link" href="#bagging-bootstrap-aggregating"><span class="header-section-number">3.0.5</span> 2. Bagging (bootstrap aggregating)</a></li>
<li><a class="nav-link" href="#bayesglm"><span class="header-section-number">3.0.6</span> 3. BayesGLM</a></li>
<li><a class="nav-link" href="#bayesrnn"><span class="header-section-number">3.0.7</span> 4. BayesRNN</a></li>
<li><a class="nav-link" href="#boosted-random-forest"><span class="header-section-number">3.0.8</span> 5. Boosted Random Forest</a></li>
<li><a class="nav-link" href="#cubist"><span class="header-section-number">3.0.9</span> 6. Cubist</a></li>
<li><a class="nav-link" href="#elastic"><span class="header-section-number">3.0.10</span> 7. Elastic</a></li>
<li><a class="nav-link" href="#generalized-additive-models-with-smoothing-splines"><span class="header-section-number">3.0.11</span> 8. Generalized Additive Models with smoothing splines</a></li>
<li><a class="nav-link" href="#gradient-boosted"><span class="header-section-number">3.0.12</span> 9. Gradient Boosted</a></li>
<li><a class="nav-link" href="#k-nearest-neighbors-tuned"><span class="header-section-number">3.0.13</span> 10. K-Nearest Neighbors (tuned)</a></li>
<li><a class="nav-link" href="#lasso"><span class="header-section-number">3.0.14</span> 11. Lasso</a></li>
<li><a class="nav-link" href="#linear-tuned"><span class="header-section-number">3.0.15</span> 12. Linear (tuned)</a></li>
<li><a class="nav-link" href="#lqs"><span class="header-section-number">3.0.16</span> 13. LQS</a></li>
<li><a class="nav-link" href="#neuralnet"><span class="header-section-number">3.0.17</span> 14. Neuralnet</a></li>
<li><a class="nav-link" href="#partial-least-squares"><span class="header-section-number">3.0.18</span> 15. Partial Least Squares</a></li>
<li><a class="nav-link" href="#principal-components-regression"><span class="header-section-number">3.0.19</span> 16. Principal Components Regression</a></li>
<li><a class="nav-link" href="#random-forest"><span class="header-section-number">3.0.20</span> 17. Random Forest</a></li>
<li><a class="nav-link" href="#ridge-regression"><span class="header-section-number">3.0.21</span> 18. Ridge Regression</a></li>
<li><a class="nav-link" href="#robust-regression"><span class="header-section-number">3.0.22</span> 19. Robust Regression</a></li>
<li><a class="nav-link" href="#rpart"><span class="header-section-number">3.0.23</span> 20. Rpart</a></li>
<li><a class="nav-link" href="#support-vector-machines"><span class="header-section-number">3.0.24</span> 21. Support Vector Machines</a></li>
<li><a class="nav-link" href="#trees"><span class="header-section-number">3.0.25</span> 22. Trees</a></li>
<li><a class="nav-link" href="#xgboost"><span class="header-section-number">3.0.26</span> 23. XGBoost</a></li>
<li><a class="nav-link" href="#exercise-pick-four-of-the-functions-and-apply-them-with-other-numerical-data-sets."><span class="header-section-number">3.0.27</span> Exercise: Pick four of the functions and apply them with other numerical data sets.</a></li>
<li><a class="nav-link" href="#post-the-results-of-your-work."><span class="header-section-number">3.0.28</span> Post the results of your work.</a></li>
<li><a class="nav-link" href="#test-four-of-your-functions-on-a-neutral-data-set-mean-0-sd-1.-post-your-results-compare-most-accurate-to-least-accurate-results."><span class="header-section-number">3.0.29</span> Test four of your functions on a neutral data set (mean = 0, sd = 1). Post your results, compare most accurate to least accurate results.</a></li>
</ul>
</li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/InfiniteCuriosity/EnsemblesBook/blob/master/02-Individual_Numerical_Models.rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/InfiniteCuriosity/EnsemblesBook/edit/master/02-Individual_Numerical_Models.rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Ensembles: From Beginner to Expert</strong>" was written by Russ Conte. It was last built on 2024-06-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
