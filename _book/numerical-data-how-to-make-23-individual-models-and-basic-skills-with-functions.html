<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Numerical data: How to make 23 individual models, and basic skills with functions | Ensembles: From Beginner to Expert</title>
<meta name="author" content="Russ Conte">
<meta name="description" content="This is where we will begin building the skills to make ensembles of models of numerical data. However, this is going to be much easier than it might appear at first. Let’s see how we can make...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 3 Numerical data: How to make 23 individual models, and basic skills with functions | Ensembles: From Beginner to Expert">
<meta property="og:type" content="book">
<meta property="og:description" content="This is where we will begin building the skills to make ensembles of models of numerical data. However, this is going to be much easier than it might appear at first. Let’s see how we can make...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Numerical data: How to make 23 individual models, and basic skills with functions | Ensembles: From Beginner to Expert">
<meta name="twitter:description" content="This is where we will begin building the skills to make ensembles of models of numerical data. However, this is going to be much easier than it might appear at first. Let’s see how we can make...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Ensembles: From Beginner to Expert</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></li>
<li><a class="active" href="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions.html"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a></li>
<li><a class="" href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></li>
<li><a class="" href="classification-data-how-to-make-14-individual-classification-models.html"><span class="header-section-number">5</span> Classification data: How to make 14 individual classification models</a></li>
<li><a class="" href="building-ensembles-of-classification-models.html"><span class="header-section-number">6</span> Building ensembles of classification models</a></li>
<li><a class="" href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></li>
<li><a class="" href="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles.html"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li>
<li><a class="" href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></li>
<li><a class="" href="ensembles-of-26-forecasting-models.html"><span class="header-section-number">10</span> Ensembles of 26 Forecasting Models</a></li>
<li><a class="" href="predicting-on-totally-new-data-with-individual-models-and-ensembles.html"><span class="header-section-number">11</span> Predicting on totally new data with individual models and ensembles</a></li>
<li><a class="" href="how-to-communicate-your-results.html"><span class="header-section-number">12</span> How to communicate your results</a></li>
<li><a class="" href="final-comprhensive-project.html"><span class="header-section-number">13</span> Final Comprhensive Project</a></li>
<li><a class="" href="summary-and-charge-to-the-graduates-of-the-class.html"><span class="header-section-number">14</span> Summary and Charge to the Graduates of the Class!</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/InfinteCuriosity/EnsemblesBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions<a class="anchor" aria-label="anchor" href="#numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions"><i class="fas fa-link"></i></a>
</h1>
<p>This is where we will begin building the skills to make ensembles of
models of numerical data. However, this is going to be much easier than
it might appear at first. Let’s see how we can make this as easy as
possible.</p>
<p>How to work backwards and make the function we need: Start from the end</p>
<p>We are going to start at the ending, not at the beginning, and work
backwards from there. This method is much, much easier than working
forward, as you will see throughout this book. While it might be a
little uncomfortable at first, this skill will allow you to complete
your work at a faster rate than if you work forward.</p>
<p>We’ll use the Boston Housing data set, and we’ll start with the Bagged
Random Forest function. For now we’re only going to work with one
function, to keep everything simple. In essence, we are going to run
this like an assembly line.</p>
<p>We want the ending to be the error rate by model. Virtually any customer
you work with is going to want to know, “How accurate is it?” That’s our
starting point.</p>
<p>How do we determine model accuracy? We already did this in the previous
chapter, finding the root mean squared error for the individual models
and the ensemble models. We’re going to do the same steps here, so the
process is familiar to you.</p>
<p>To get the error rate by model on the holdout data sets (test and
validation), we’re going to need a model (Bagged Random Forest in this
first example), fit to the training data, and use that model to make
predictions on the test data. We can then measure the error in the
predictions, just as we did before. These steps should be familiar to
you. If not, please re-read the previous chapter.</p>
<p>But what do we need to complete those steps? We’re going to have to go
backward (a little) and make a function that will allow us to work with
any data set.</p>
<p>What does our function need? Let’s make a list:</p>
<ul>
<li><p>The data (such as Boston housing)</p></li>
<li><p>Column number (such as 14, the median value of the property)</p></li>
<li><p>Train amount</p></li>
<li><p>Test amount</p></li>
<li><p>Validation amount</p></li>
<li><p>Number of times to resample</p></li>
</ul>
<p>One of the key steps here is to change the name of the target variable
to y. The initial name could be nearly anything, but this method changes
the name of the target variable to y. This allows us to make one small
change that will allow this to be the easiest possible solution:</p>
<div id="all-our-models-will-be-structured-the-same-way-y-.-data-train" class="section level3" number="3.0.1">
<h3>
<span class="header-section-number">3.0.1</span> All our models will be structured the same way: y ~ ., data = train<a class="anchor" aria-label="anchor" href="#all-our-models-will-be-structured-the-same-way-y-.-data-train"><i class="fas fa-link"></i></a>
</h3>
<p>This means that y (our target value) is a function of the other
features, and the data set is the training data set. While there will be
some variations on this in our 27 models, the basic structure is the
same.</p>
</div>
<div id="having-the-same-structure-for-all-the-models-makes-it-much-easier-to-build-debug-and-deploy-the-completed-models." class="section level3" number="3.0.2">
<h3>
<span class="header-section-number">3.0.2</span> Having the same structure for all the models makes it much easier to build, debug, and deploy the completed models.<a class="anchor" aria-label="anchor" href="#having-the-same-structure-for-all-the-models-makes-it-much-easier-to-build-debug-and-deploy-the-completed-models."><i class="fas fa-link"></i></a>
</h3>
<p>Then we only need to start with our initial values, and it will run.</p>
<p>One extremely nice part about creating models this way is the enormous
efficiency it gives us. Once we have the Bagged Random Forest model
working, we will be able to use very similar (and identical in many
cases!) processes with other models (such as Support Vector Machines).</p>
<p>The rock solid foundation we lay at the beginning will allow us to have
a smooth and easy experience once the foundation is solid and we use it
to build more models. The other models will mainly be almost exact
duplicates of our fist example.’</p>
<p>Here are the steps we will follow:</p>
<ul>
<li><p>Load the library</p></li>
<li><p>Set initial values to 0</p></li>
<li><p>Create the function</p></li>
<li><p>Set up random resampling</p></li>
<li><p>Break the data into train and test</p></li>
<li><p>Fit the model on the training data, make predictions and measure
error on the test data</p></li>
<li><p>Return the results</p></li>
<li><p>Check for errors or warnings</p></li>
<li><p>Test on a different data set</p></li>
</ul>
</div>
<div id="exercise-re-read-the-steps-above-how-we-will-work-backwards-to-come-up-with-the-function-we-need." class="section level3" number="3.0.3">
<h3>
<span class="header-section-number">3.0.3</span> Exercise: Re-read the steps above how we will work backwards to come up with the function we need.<a class="anchor" aria-label="anchor" href="#exercise-re-read-the-steps-above-how-we-will-work-backwards-to-come-up-with-the-function-we-need."><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="bagged-random-forest" class="section level3" number="3.0.4">
<h3>
<span class="header-section-number">3.0.4</span> 1. Bagged Random Forest<a class="anchor" aria-label="anchor" href="#bagged-random-forest"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span> <span class="co"># will allow us to use a tuned random forest model</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mfrasco/Metrics">Metrics</a></span><span class="op">)</span> <span class="co"># Will allow us to calculate the root mean squared error</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span> <span class="co"># To use the random forest function</span></span>
<span><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span> <span class="co"># Amazing set of tools for data science</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.5.1     ✔ tibble    3.2.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     ✔ tidyr     1.3.1</span></span>
<span><span class="co">#&gt; ✔ purrr     1.0.2</span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::combine()  masks randomForest::combine()</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter()   masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()      masks stats::lag()</span></span>
<span><span class="co">#&gt; ✖ ggplot2::margin() masks randomForest::margin()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set initial values to 0. The function will return an error if any of these are left out.</span></span>
<span></span>
<span><span class="va">bag_rf_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bag_rf_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Define the function</span></span>
<span></span>
<span><span class="va">numerical_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co">#Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model to the training data, make predictions on the testing data, then calculate the error rates on the testing data sets.</span></span>
<span><span class="va">bag_rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">bag_rf_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">bag_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bag_rf_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bag_rf_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bag_rf_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">bag_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bag_rf_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bag_rf_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Itemize the error on the holdout data sets, and calculate the mean of the results</span></span>
<span><span class="va">bag_rf_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bag_rf_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">bag_rf_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bag_rf_holdout_RMSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># These are the predictions we will need when we make the ensembles</span></span>
<span><span class="va">bag_rf_test_predict_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bag_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Return the mean of the results to the user</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bag_rf_holdout_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numerical_1 function</span></span>
<span></span>
<span><span class="co"># Here is our first numerical function in actual use. We will use 25 resamples</span></span>
<span></span>
<span><span class="fu">numerical_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3032176</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings, the best possible result</span></span></code></pre></div>
<p>Exercise: Try it yourself: Change the values of train, test and
validation, and the number of resamples. See how those change the
result.</p>
<p>One of your own: Find any numerical data set, and make a bagged random
forest function for that data set. (For example, you may use the Auto
data set in the ISLR package. You will need to remove the last column,
vehicle name. Model mpg as a function of the other features using the
Bagged Random Forest function, but any numerical data set will work).</p>
<p>Post: Share on social your first results making a numerical function
(screen shot/video optional at this stage, we will be learning how to do
those later)</p>
<p>For example, “Did my first data science function building up to making
ensembles later on. Got everything to run, no errors. #AIEnsembles”</p>
<p>Now we will build the remaining 22 models for numerical data. They are
all built using the same structure, on the same foundation.</p>
<p>Now that we know how to build a basic function, let’s build the 22 other
sets of tools we will need to make our ensemble, starting with bagging:</p>
</div>
<div id="bagging-bootstrap-aggregating" class="section level3" number="3.0.5">
<h3>
<span class="header-section-number">3.0.5</span> 2. Bagging (bootstrap aggregating)<a class="anchor" aria-label="anchor" href="#bagging-bootstrap-aggregating"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ipred</span><span class="op">)</span> <span class="co">#for the bagging function</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">bagging_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bagging_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co">#Create the function:</span></span>
<span></span>
<span><span class="va">bagging_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model to the training data, calculate error, make predictions on the holdout data</span></span>
<span></span>
<span><span class="va">bagging_train_fit</span> <span class="op">&lt;-</span> <span class="fu">ipred</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ipred/man/bagging.html">bagging</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">bagging_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bagging_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bagging_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bagging_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bagging_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bagging_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">bagging_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">bagging_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bagging_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">y_hat_bagging</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bagging_test_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for the resampling function</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bagging_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for the bagging function</span></span>
<span></span>
<span><span class="co"># Test the function:</span></span>
<span><span class="fu">bagging_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.20</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.951048</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings</span></span></code></pre></div>
</div>
<div id="bayesglm" class="section level3" number="3.0.6">
<h3>
<span class="header-section-number">3.0.6</span> 3. BayesGLM<a class="anchor" aria-label="anchor" href="#bayesglm"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span> <span class="co"># to use bayesglm function</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'MASS'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Matrix'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:tidyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     expand, pack, unpack</span></span>
<span><span class="co">#&gt; Loading required package: lme4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arm (Version 1.14-4, built: 2024-4-1)</span></span>
<span><span class="co">#&gt; Working directory is /Users/russellconte/Library/Mobile Documents/com~apple~CloudDocs/Documents/Machine Learning templates in R/EnsemblesBook</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">bayesglm_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">bayesglm_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co">#Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co">#Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">arm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/bayesglm.html">bayesglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesglm_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesglm_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_test_RMSE</span><span class="op">)</span> </span>
<span><span class="va">y_hat_bayesglm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for resampling</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bayesglm_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for the function</span></span>
<span></span>
<span><span class="fu">bayesglm_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.20</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.826467</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings</span></span></code></pre></div>
</div>
<div id="bayesrnn" class="section level3" number="3.0.7">
<h3>
<span class="header-section-number">3.0.7</span> 4. BayesRNN<a class="anchor" aria-label="anchor" href="#bayesrnn"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">brnn</span><span class="op">)</span> <span class="co"># so we can use the BayesRNN function</span></span>
<span><span class="co">#&gt; Loading required package: Formula</span></span>
<span><span class="co">#&gt; Loading required package: truncnorm</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span></span>
<span><span class="va">bayesrnn_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesrnn_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span></span>
<span><span class="va">bayesrnn_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model on the training data, make predictions on the testing data</span></span>
<span><span class="va">bayesrnn_train_fit</span> <span class="op">&lt;-</span> <span class="fu">brnn</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/brnn/man/brnn.html">brnn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesrnn_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesrnn_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">bayesrnn_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesrnn_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesrnn_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_hat_bayesrnn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesrnn_test_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for number of resamples </span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bayesrnn_test_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="fu">bayesrnn_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015979 </span></span>
<span><span class="co">#&gt; gamma= 30.9135    alpha= 4.8006   beta= 20224.62 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015323 </span></span>
<span><span class="co">#&gt; gamma= 31.1033    alpha= 5.5126   beta= 15023.08 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7014854 </span></span>
<span><span class="co">#&gt; gamma= 31.076     alpha= 3.9929   beta= 23622.04 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015874 </span></span>
<span><span class="co">#&gt; gamma= 31.6271    alpha= 5.7396   beta= 13894.38 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016138 </span></span>
<span><span class="co">#&gt; gamma= 31.398     alpha= 4.8438   beta= 17147.03 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015669 </span></span>
<span><span class="co">#&gt; gamma= 30.6412    alpha= 2.7592   beta= 18760.23 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016868 </span></span>
<span><span class="co">#&gt; gamma= 31.0864    alpha= 4.0625   beta= 27297.18 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016809 </span></span>
<span><span class="co">#&gt; gamma= 31.1076    alpha= 4.011    beta= 16655.02 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015619 </span></span>
<span><span class="co">#&gt; gamma= 30.6972    alpha= 3.5254   beta= 60325.72 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015227 </span></span>
<span><span class="co">#&gt; gamma= 30.1146    alpha= 2.9039   beta= 17425.96 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7014854 </span></span>
<span><span class="co">#&gt; gamma= 31.4493    alpha= 5.3886   beta= 15882.44 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015179 </span></span>
<span><span class="co">#&gt; gamma= 30.9071    alpha= 2.7797   beta= 15990.24 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7017045 </span></span>
<span><span class="co">#&gt; gamma= 31.2656    alpha= 4.6721   beta= 14287.39 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015469 </span></span>
<span><span class="co">#&gt; gamma= 31.4396    alpha= 3.8918   beta= 32878.72 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016138 </span></span>
<span><span class="co">#&gt; gamma= 31.6352    alpha= 4.1275   beta= 13990.78 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.701542 </span></span>
<span><span class="co">#&gt; gamma= 31.5509    alpha= 5.3686   beta= 17132.37 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015823 </span></span>
<span><span class="co">#&gt; gamma= 30.621     alpha= 4.5094   beta= 38520.84 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015519 </span></span>
<span><span class="co">#&gt; gamma= 31.125     alpha= 4.393    beta= 14133.96 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016636 </span></span>
<span><span class="co">#&gt; gamma= 30.6163    alpha= 5.3253   beta= 13300.03 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015979 </span></span>
<span><span class="co">#&gt; gamma= 30.5402    alpha= 5.0743   beta= 20441.23 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015569 </span></span>
<span><span class="co">#&gt; gamma= 30.5387    alpha= 5.1334   beta= 16952.94 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016192 </span></span>
<span><span class="co">#&gt; gamma= 31.4644    alpha= 5.4873   beta= 15997.12 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7016085 </span></span>
<span><span class="co">#&gt; gamma= 31.4464    alpha= 5.1745   beta= 15916.15 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015619 </span></span>
<span><span class="co">#&gt; gamma= 31.1062    alpha= 5.1507   beta= 16418.65 </span></span>
<span><span class="co">#&gt; Number of parameters (weights and biases) to estimate: 32 </span></span>
<span><span class="co">#&gt; Nguyen-Widrow method</span></span>
<span><span class="co">#&gt; Scaling factor= 0.7015085 </span></span>
<span><span class="co">#&gt; gamma= 30.9124    alpha= 3.9584   beta= 48498.02</span></span>
<span><span class="co">#&gt; [1] 0.1362577</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for BayesRNN function</span></span></code></pre></div>
</div>
<div id="boosted-random-forest" class="section level3" number="3.0.8">
<h3>
<span class="header-section-number">3.0.8</span> 5. Boosted Random Forest<a class="anchor" aria-label="anchor" href="#boosted-random-forest"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span><span class="va">boost_rf_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">boost_rf_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co">#Create the function:</span></span>
<span><span class="va">boost_rf_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co">#Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit boosted random forest model on the training data, make predictions on holdout data</span></span>
<span></span>
<span><span class="va">boost_rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">boost_rf_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">boost_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">boost_rf_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">boost_rf_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">boost_rf_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">boost_rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">boost_rf_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">boost_rf_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">boost_rf_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the function</span></span>
<span></span>
<span><span class="fu">boost_rf_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.3119975</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for Boosted Random Forest function</span></span></code></pre></div>
</div>
<div id="cubist" class="section level3" number="3.0.9">
<h3>
<span class="header-section-number">3.0.9</span> 6. Cubist<a class="anchor" aria-label="anchor" href="#cubist"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/Cubist//">Cubist</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">cubist_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span></span>
<span><span class="va">cubist_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co">#Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Fit the model on the training data, make predictions on the holdout data</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;-</span> <span class="fu">Cubist</span><span class="fu">::</span><span class="fu"><a href="http://topepo.github.io/Cubist/reference/cubist.default.html">cubist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">cubist_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">cubist_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">cubist_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">cubist_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cubist_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for the function</span></span>
<span></span>
<span><span class="fu">cubist_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.40312</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual cubist function</span></span></code></pre></div>
</div>
<div id="elastic" class="section level3" number="3.0.10">
<h3>
<span class="header-section-number">3.0.10</span> 7. Elastic<a class="anchor" aria-label="anchor" href="#elastic"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu">glmnet</a></span><span class="op">)</span> <span class="co"># So we can run the elastic model</span></span>
<span><span class="co">#&gt; Loaded glmnet 4.1-8</span></span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">elastic_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">elastic_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_validation_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">elastic_validation_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">elastic_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">elastic_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up the elastic model</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">elastic_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">elastic_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html">cv.glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">best_elastic_lambda</span> <span class="op">&lt;-</span> <span class="va">elastic_cv</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="va">best_elastic_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">best_elastic_lambda</span><span class="op">)</span></span>
<span><span class="va">elastic_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">best_elastic_model</span>, s <span class="op">=</span> <span class="va">best_elastic_lambda</span>, newx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_test_RMSE</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">elastic_test_pred</span><span class="op">)</span></span>
<span><span class="va">elastic_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_df</span>, <span class="va">elastic_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_df</span><span class="op">$</span><span class="va">elastic_test_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elastic_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">elastic_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">elastic_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_df</span>, <span class="va">elastic_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">elastic_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_df</span><span class="op">$</span><span class="va">elastic_holdout_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresample</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">elastic_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the elastic function</span></span>
<span></span>
<span><span class="fu">elastic_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.97869</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual elastic function</span></span></code></pre></div>
</div>
<div id="generalized-additive-models-with-smoothing-splines" class="section level3" number="3.0.11">
<h3>
<span class="header-section-number">3.0.11</span> 8. Generalized Additive Models with smoothing splines<a class="anchor" aria-label="anchor" href="#generalized-additive-models-with-smoothing-splines"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gam</span><span class="op">)</span> <span class="co"># for fitting generalized additive models</span></span>
<span><span class="co">#&gt; Loading required package: splines</span></span>
<span><span class="co">#&gt; Loading required package: foreach</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'foreach'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     accumulate, when</span></span>
<span><span class="co">#&gt; Loaded gam 1.22-3</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">gam_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gam_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gam_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gam_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">gam1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up to fit the model on the training data</span></span>
<span></span>
<span><span class="va">n_unique_vals</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Names of columns with &gt;= 4 unique vals</span></span>
<span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">n_unique_vals</span><span class="op">)</span><span class="op">[</span><span class="va">n_unique_vals</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="va">gam_data</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model data</span></span>
<span></span>
<span><span class="va">train1</span> <span class="op">&lt;-</span> <span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test1</span> <span class="op">&lt;-</span> <span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">names_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gam_data</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">gam_data</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"y ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"gam::s("</span>, <span class="va">names_df</span>, <span class="st">")"</span>, collapse <span class="op">=</span> <span class="st">"+"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gam_train_fit</span> <span class="op">&lt;-</span> <span class="fu">gam</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gam/man/gam.html">gam</a></span><span class="op">(</span><span class="va">f2</span>, data <span class="op">=</span> <span class="va">train1</span><span class="op">)</span></span>
<span><span class="va">gam_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gam_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gam_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">gam_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gam_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gam_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">gam_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">gam_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gam_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing braces for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gam_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing braces for gam function</span></span>
<span></span>
<span><span class="fu">gam1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.755033</span></span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual gam function</span></span></code></pre></div>
</div>
<div id="gradient-boosted" class="section level3" number="3.0.12">
<h3>
<span class="header-section-number">3.0.12</span> 9. Gradient Boosted<a class="anchor" aria-label="anchor" href="#gradient-boosted"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gbm-developers/gbm">gbm</a></span><span class="op">)</span> <span class="co"># to allow use of gradient boosted models</span></span>
<span><span class="co">#&gt; Loaded gbm 2.1.9</span></span>
<span><span class="co">#&gt; This version of gbm is no longer under development. Consider transitioning to gbm3, https://github.com/gbm-developers/gbm3</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">gb_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">gb1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">gb_train_fit</span> <span class="op">&lt;-</span> <span class="fu">gbm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gbm/man/gbm.html">gbm</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, distribution <span class="op">=</span> <span class="st">"gaussian"</span>, n.trees <span class="op">=</span> <span class="fl">100</span>, shrinkage <span class="op">=</span> <span class="fl">0.1</span>, interaction.depth <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">gb_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gb_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gb_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gb_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">gb_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gb_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gb_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gb_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gb_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for gb1 function</span></span>
<span></span>
<span><span class="fu">gb1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; [1] 3.370866</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual gradient boosted function</span></span></code></pre></div>
</div>
<div id="k-nearest-neighbors-tuned" class="section level3" number="3.0.13">
<h3>
<span class="header-section-number">3.0.13</span> 10. K-Nearest Neighbors (tuned)<a class="anchor" aria-label="anchor" href="#k-nearest-neighbors-tuned"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">knn_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">knn_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">knn1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">knn_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.gknn</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best.model</span>,</span>
<span>    newdata <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, k <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">k</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knn_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">knn_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span> object <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best.model</span>,</span>
<span>    k <span class="op">=</span> <span class="va">knn_train_fit</span><span class="op">$</span><span class="va">best_model</span><span class="op">$</span><span class="va">k</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knn_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">knn_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">knn_test_RMSE_mean</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">knn_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">knn_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">knn_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for knn1 function</span></span>
<span></span>
<span><span class="fu">knn1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.898357</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual knn function</span></span></code></pre></div>
</div>
<div id="lasso" class="section level3" number="3.0.14">
<h3>
<span class="header-section-number">3.0.14</span> 11. Lasso<a class="anchor" aria-label="anchor" href="#lasso"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu">glmnet</a></span><span class="op">)</span> <span class="co"># So we can run the lasso model</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">lasso_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">lasso_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_validation_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">lasso_validation_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lasso_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">lasso_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up the lasso model</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lasso_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">lasso_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html">cv.glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">best_lasso_lambda</span> <span class="op">&lt;-</span> <span class="va">lasso_cv</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="va">best_lasso_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">best_lasso_lambda</span><span class="op">)</span></span>
<span><span class="va">lasso_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">best_lasso_model</span>, s <span class="op">=</span> <span class="va">best_lasso_lambda</span>, newx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lasso_test_RMSE</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">lasso_test_pred</span><span class="op">)</span></span>
<span><span class="va">lasso_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_df</span>, <span class="va">lasso_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_df</span><span class="op">$</span><span class="va">lasso_test_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lasso_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lasso_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">lasso_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_df</span>, <span class="va">lasso_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">lasso_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_df</span><span class="op">$</span><span class="va">lasso_holdout_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresample</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">lasso_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the lasso_1 function</span></span>
<span></span>
<span><span class="fu">lasso_1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.001568</span></span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual lasso function</span></span></code></pre></div>
</div>
<div id="linear-tuned" class="section level3" number="3.0.15">
<h3>
<span class="header-section-number">3.0.15</span> 12. Linear (tuned)<a class="anchor" aria-label="anchor" href="#linear-tuned"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span> <span class="co"># for tuned linear models</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">linear_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">linear_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">linear_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Set up the function</span></span>
<span><span class="va">linear1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">linear_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.rpart</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">linear_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">linear_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">linear_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">linear_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">linear_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">linear_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">linear_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">linear_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">linear_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for linear1 function</span></span>
<span></span>
<span><span class="fu">linear1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.607703</span></span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual lasso function</span></span></code></pre></div>
</div>
<div id="lqs" class="section level3" number="3.0.16">
<h3>
<span class="header-section-number">3.0.16</span> 13. LQS<a class="anchor" aria-label="anchor" href="#lqs"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># to allow us to run LQS models</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">lqs_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">lqs_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">lqs1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">lqs_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lqs.html">lqs</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">lqs_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">lqs_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lqs_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lqs_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">lqs_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">lqs_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">lqs_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">lqs_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y_hat_lqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">lqs_test_predict_value</span>, <span class="va">lqs_validation_predict_value</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">lqs_test_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for lqs1 function</span></span>
<span></span>
<span><span class="fu">lqs1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.838138</span></span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual lqs function</span></span></code></pre></div>
</div>
<div id="neuralnet" class="section level3" number="3.0.17">
<h3>
<span class="header-section-number">3.0.17</span> 14. Neuralnet<a class="anchor" aria-label="anchor" href="#neuralnet"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bips-hb/neuralnet">neuralnet</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'neuralnet'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     compute</span></span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span></span>
<span><span class="va">neuralnet_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">neuralnet_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Fit the model to the training data</span></span>
<span><span class="va">neuralnet1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test data sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">maxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="va">max</span><span class="op">)</span></span>
<span><span class="va">mins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">df</span>, <span class="fl">2</span>, <span class="va">min</span><span class="op">)</span></span>
<span><span class="va">scaled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html">scale</a></span><span class="op">(</span><span class="va">df</span>, center <span class="op">=</span> <span class="va">mins</span>, scale <span class="op">=</span> <span class="va">maxs</span> <span class="op">-</span> <span class="va">mins</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train_</span> <span class="op">&lt;-</span> <span class="va">scaled</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test_</span> <span class="op">&lt;-</span> <span class="va">scaled</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">train_</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"y ~"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">n</span><span class="op">[</span><span class="op">!</span><span class="va">n</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="st">"y"</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/neuralnet.html">neuralnet</a></span><span class="op">(</span><span class="va">f</span>, data <span class="op">=</span> <span class="va">train_</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span>, linear.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">predict_test_nn</span> <span class="op">&lt;-</span> <span class="fu">neuralnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">nn</span>, <span class="va">test_</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">predict_test_nn_</span> <span class="op">&lt;-</span> <span class="va">predict_test_nn</span><span class="op">$</span><span class="va">net.result</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">predict_train_nn</span> <span class="op">&lt;-</span> <span class="fu">neuralnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neuralnet/man/compute.html">compute</a></span><span class="op">(</span><span class="va">nn</span>, <span class="va">train_</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">predict_train_nn_</span> <span class="op">&lt;-</span> <span class="va">predict_train_nn</span><span class="op">$</span><span class="va">net.result</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">neuralnet_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">predict_train_nn_</span><span class="op">)</span></span>
<span><span class="va">neuralnet_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">neuralnet_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">neuralnet_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">predict_test_nn_</span><span class="op">)</span></span>
<span><span class="va">neuralnet_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">neuralnet_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">neuralnet_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">neuralnet_test_RMSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">neuralnet_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">neuralnet_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">neuralnet_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for neuralnet1 function</span></span>
<span></span>
<span><span class="fu">neuralnet1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3.943471</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual neuralnet function</span></span></code></pre></div>
</div>
<div id="partial-least-squares" class="section level3" number="3.0.18">
<h3>
<span class="header-section-number">3.0.18</span> 15. Partial Least Squares<a class="anchor" aria-label="anchor" href="#partial-least-squares"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/pls">pls</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pls'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:arm':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     coefplot, corrplot</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     loadings</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">pls_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pls_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">pls1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">pls_train_fit</span> <span class="op">&lt;-</span> <span class="fu">pls</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvr.html">plsr</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">pls_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pls_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pls_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pls_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">pls_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pls_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pls_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pls_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span> <span class="va">pls_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for pls1 function</span></span>
<span></span>
<span><span class="fu">pls1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.068721</span></span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual pls function</span></span></code></pre></div>
</div>
<div id="principal-components-regression" class="section level3" number="3.0.19">
<h3>
<span class="header-section-number">3.0.19</span> 16. Principal Components Regression<a class="anchor" aria-label="anchor" href="#principal-components-regression"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khliland/pls">pls</a></span><span class="op">)</span> <span class="co"># To run pcr models</span></span>
<span></span>
<span><span class="co">#Set initial values to 0</span></span>
<span><span class="va">pcr_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">pcr_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="va">pcr1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">pcr_train_fit</span> <span class="op">&lt;-</span> <span class="fu">pls</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pls/man/mvr.html">pcr</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">pcr_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pcr_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pcr_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pcr_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">pcr_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">pcr_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pcr_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">pcr_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">pcr_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for PCR function</span></span>
<span></span>
<span><span class="fu">pcr1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.527915</span></span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual pls function</span></span></code></pre></div>
</div>
<div id="random-forest" class="section level3" number="3.0.20">
<h3>
<span class="header-section-number">3.0.20</span> 17. Random Forest<a class="anchor" aria-label="anchor" href="#random-forest"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">rf_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Set up the function</span></span>
<span><span class="va">rf1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co">#Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">rf_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">rf_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rf_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rf_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for rf1 function</span></span>
<span></span>
<span><span class="fu">rf1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1.818037</span></span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual random forest function</span></span></code></pre></div>
</div>
<div id="ridge-regression" class="section level3" number="3.0.21">
<h3>
<span class="header-section-number">3.0.21</span> 18. Ridge Regression<a class="anchor" aria-label="anchor" href="#ridge-regression"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glmnet.stanford.edu">glmnet</a></span><span class="op">)</span> <span class="co"># So we can run the ridge model</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">ridge_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ridge_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_validation_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ridge_validation_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">ridge_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the function:</span></span>
<span><span class="va">ridge1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train, test and validation sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Set up the ridge model</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ridge_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://glmnet.stanford.edu/reference/cv.glmnet.html">cv.glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">best_ridge_lambda</span> <span class="op">&lt;-</span> <span class="va">ridge_cv</span><span class="op">$</span><span class="va">lambda.min</span></span>
<span><span class="va">best_ridge_model</span> <span class="op">&lt;-</span> <span class="fu">glmnet</span><span class="fu">::</span><span class="fu"><a href="https://glmnet.stanford.edu/reference/glmnet.html">glmnet</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, alpha <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">best_ridge_lambda</span><span class="op">)</span></span>
<span><span class="va">ridge_test_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">best_ridge_model</span>, s <span class="op">=</span> <span class="va">best_ridge_lambda</span>, newx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ridge_test_RMSE</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">ridge_test_pred</span><span class="op">)</span></span>
<span><span class="va">ridge_test_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_df</span>, <span class="va">ridge_test_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_df</span><span class="op">$</span><span class="va">ridge_test_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ridge_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ridge_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">ridge_holdout_RMSE_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_df</span>, <span class="va">ridge_holdout_RMSE</span><span class="op">)</span></span>
<span><span class="va">ridge_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_df</span><span class="op">$</span><span class="va">ridge_holdout_RMSE</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_df</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresample</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ridge_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># closing brace for the ridge function</span></span>
<span></span>
<span><span class="fu">ridge1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 5.09164</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual ridge function</span></span></code></pre></div>
</div>
<div id="robust-regression" class="section level3" number="3.0.22">
<h3>
<span class="header-section-number">3.0.22</span> 19. Robust Regression<a class="anchor" aria-label="anchor" href="#robust-regression"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span> <span class="co"># To run rlm function for robust regression</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">robust_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">robust_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">robust1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">robust_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="va">robust_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="va">robust_train_fit</span><span class="op">$</span><span class="va">fitted.values</span><span class="op">)</span></span>
<span><span class="va">robust_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">robust_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">robust_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/rlm.html">rlm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">robust_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">robust_test_RMSE</span><span class="op">)</span> </span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">robust_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for robust1 function</span></span>
<span></span>
<span><span class="fu">robust1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.950721</span></span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual robust function</span></span></code></pre></div>
</div>
<div id="rpart" class="section level3" number="3.0.23">
<h3>
<span class="header-section-number">3.0.23</span> 20. Rpart<a class="anchor" aria-label="anchor" href="#rpart"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bethatkinson/rpart">rpart</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">rpart_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rpart_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">rpart1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">rpart_train_fit</span> <span class="op">&lt;-</span> <span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">rpart_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rpart_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rpart_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rpart_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">rpart_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">rpart_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rpart_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rpart_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing loop for numresamples</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rpart_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for rpart1 function</span></span>
<span></span>
<span><span class="fu">rpart1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.899757</span></span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual rpart function</span></span></code></pre></div>
</div>
<div id="support-vector-machines" class="section level3" number="3.0.24">
<h3>
<span class="header-section-number">3.0.24</span> 21. Support Vector Machines<a class="anchor" aria-label="anchor" href="#support-vector-machines"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">svm_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">svm1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">svm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/tune.wrapper.html">tune.svm</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">svm_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">svm_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">svm_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">svm_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">svm_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">svm_train_fit</span><span class="op">$</span><span class="va">best.model</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">svm_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">svm_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">svm_test_RMSE_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for svm1 function</span></span>
<span></span>
<span><span class="fu">svm1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.3304</span></span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual Support Vector Machines function</span></span></code></pre></div>
</div>
<div id="trees" class="section level3" number="3.0.25">
<h3>
<span class="header-section-number">3.0.25</span> 22. Trees<a class="anchor" aria-label="anchor" href="#trees"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">tree_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">tree_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Make the function</span></span>
<span><span class="va">tree1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">tree_train_fit</span> <span class="op">&lt;-</span> <span class="fu">tree</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tree/man/tree.html">tree</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span><span class="va">tree_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tree_train_fit</span>, newdata <span class="op">=</span> <span class="va">train</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tree_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">tree_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">tree_train_fit</span>, newdata <span class="op">=</span> <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tree_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">tree_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">tree_test_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for tree1 function</span></span>
<span></span>
<span><span class="fu">tree1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4.803725</span></span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual tree function</span></span></code></pre></div>
</div>
<div id="xgboost" class="section level3" number="3.0.26">
<h3>
<span class="header-section-number">3.0.26</span> 23. XGBoost<a class="anchor" aria-label="anchor" href="#xgboost"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmlc/xgboost">xgboost</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'xgboost'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     slice</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span><span class="va">xgb_train_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_validation_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_holdout_RMSE</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_validation_predict_value</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span><span class="va">xgb1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span>, <span class="va">validation_amount</span>, <span class="va">numresamples</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span><span class="co"># Set up random resampling</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span><span class="co"># Changes the name of the target column to y</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="co"># Moves the target column to the last column on the right</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right df &lt;- df[sample(nrow(df)), ] # randomizes the rows</span></span>
<span></span>
<span><span class="co"># Breaks the data into train and test sets</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">idx</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">train_y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">test_y</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># define final train, test and validation sets</span></span>
<span></span>
<span><span class="va">xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_x</span>, label <span class="op">=</span> <span class="va">train_y</span><span class="op">)</span></span>
<span><span class="va">xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_x</span>, label <span class="op">=</span> <span class="va">test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span><span class="op">)</span></span>
<span><span class="va">watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span>, test <span class="op">=</span> <span class="va">xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit XGBoost model and display training and validation data at each round</span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgboost_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_train_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">train_x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_train_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_train_RMSE</span><span class="op">)</span></span>
<span><span class="va">xgb_test_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">Metrics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Metrics/man/rmse.html">rmse</a></span><span class="op">(</span>actual <span class="op">=</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span>, predicted <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">test_x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_test_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_holdout_RMSE</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_RMSE_mean</span><span class="op">)</span></span>
<span><span class="va">xgb_holdout_RMSE_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_holdout_RMSE</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># Closing brace for numresamples loop</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">xgb_holdout_RMSE_mean</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for xgb1 function</span></span>
<span></span>
<span><span class="fu">xgb1</span><span class="op">(</span>data <span class="op">=</span> <span class="fu">MASS</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/MASS/man/Boston.html">Boston</a></span>, colnum <span class="op">=</span> <span class="fl">14</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span>, numresamples <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.106138    test-rmse:17.366893 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.381786    test-rmse:12.791063 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.054376 test-rmse:9.622087 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.732554 test-rmse:7.565010 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.149285 test-rmse:6.266702 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.076553 test-rmse:5.494029 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.324973 test-rmse:4.903619 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.847707 test-rmse:4.542260 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.530861 test-rmse:4.413045 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.307846 test-rmse:4.231765 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.152082 test-rmse:4.184429 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.055640 test-rmse:4.161266 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.946959 test-rmse:4.136018 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.869913 test-rmse:4.143107 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.805064 test-rmse:4.058231 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.758146 test-rmse:4.040621 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.713256 test-rmse:3.986970 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.681229 test-rmse:3.985656 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.620191 test-rmse:3.996229 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.564413 test-rmse:3.989849 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.533410 test-rmse:3.992445 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.512751 test-rmse:3.997344 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.473980 test-rmse:3.991080 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.450180 test-rmse:3.959146 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.419758 test-rmse:3.971367 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.381709 test-rmse:3.972488 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.341355 test-rmse:3.967456 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.327296 test-rmse:3.967204 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.315809 test-rmse:3.963369 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.276372 test-rmse:3.939496 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.245258 test-rmse:3.941929 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.227539 test-rmse:3.943494 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.205570 test-rmse:3.944429 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.178578 test-rmse:3.908206 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.147782 test-rmse:3.890774 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.130770 test-rmse:3.895550 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.110949 test-rmse:3.892502 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.086514 test-rmse:3.894933 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.059807 test-rmse:3.895144 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.037346 test-rmse:3.899691 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.027192 test-rmse:3.906265 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.008947 test-rmse:3.906913 </span></span>
<span><span class="co">#&gt; [43] train-rmse:0.982172 test-rmse:3.895650 </span></span>
<span><span class="co">#&gt; [44] train-rmse:0.955719 test-rmse:3.886293 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.934445 test-rmse:3.885709 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.922770 test-rmse:3.883157 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.904506 test-rmse:3.880058 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.888704 test-rmse:3.877216 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.873289 test-rmse:3.881064 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.863270 test-rmse:3.870378 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.856263 test-rmse:3.870180 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.849087 test-rmse:3.871422 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.831005 test-rmse:3.864546 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.812538 test-rmse:3.863428 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.803447 test-rmse:3.860963 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.792266 test-rmse:3.852648 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.783392 test-rmse:3.848370 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.778657 test-rmse:3.850442 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.773384 test-rmse:3.853208 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.766044 test-rmse:3.852157 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.761048 test-rmse:3.849829 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.752227 test-rmse:3.840653 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.736047 test-rmse:3.852588 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.724781 test-rmse:3.846104 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.713466 test-rmse:3.837874 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.703244 test-rmse:3.836673 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.689611 test-rmse:3.836109 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.684932 test-rmse:3.826088 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.664265 test-rmse:3.818385 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.652603 test-rmse:3.810074 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.924814    test-rmse:17.491308 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.224077    test-rmse:12.977083 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:8.935319 test-rmse:9.811723 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.643097 test-rmse:7.739571 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.062052 test-rmse:6.470779 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:3.994706 test-rmse:5.659490 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.290321 test-rmse:5.208584 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.811032 test-rmse:4.926356 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.511393 test-rmse:4.616665 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.302334 test-rmse:4.464360 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.133457 test-rmse:4.325686 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.020290 test-rmse:4.268084 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.952641 test-rmse:4.176074 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.909818 test-rmse:4.157850 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.828420 test-rmse:4.114806 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.762910 test-rmse:4.090413 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.716270 test-rmse:4.040192 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.684788 test-rmse:3.999977 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.629414 test-rmse:3.970050 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.570881 test-rmse:3.975561 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.539230 test-rmse:3.971791 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.483834 test-rmse:3.966041 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.455368 test-rmse:3.981049 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.440889 test-rmse:3.923917 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.417689 test-rmse:3.904749 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.377943 test-rmse:3.927352 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.351410 test-rmse:3.924684 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.307542 test-rmse:3.927266 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.289389 test-rmse:3.920995 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.281154 test-rmse:3.913963 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.262924 test-rmse:3.913638 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.240791 test-rmse:3.907200 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.225516 test-rmse:3.905394 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.212163 test-rmse:3.912072 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.195203 test-rmse:3.916352 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.187114 test-rmse:3.919584 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.169093 test-rmse:3.912839 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.139805 test-rmse:3.898301 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.128596 test-rmse:3.896211 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.117456 test-rmse:3.875217 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.082428 test-rmse:3.880888 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.073824 test-rmse:3.878762 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.057046 test-rmse:3.881334 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.044397 test-rmse:3.879126 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.039668 test-rmse:3.878866 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.023359 test-rmse:3.881689 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.999350 test-rmse:3.887873 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.978395 test-rmse:3.896517 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.968111 test-rmse:3.876398 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.959579 test-rmse:3.874545 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.940500 test-rmse:3.873539 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.917210 test-rmse:3.863689 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.912667 test-rmse:3.861802 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.906458 test-rmse:3.864835 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.899376 test-rmse:3.845328 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.894771 test-rmse:3.848354 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.888213 test-rmse:3.848686 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.884812 test-rmse:3.846327 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.868224 test-rmse:3.841791 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.850141 test-rmse:3.839369 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.838281 test-rmse:3.842239 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.809893 test-rmse:3.845711 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.801592 test-rmse:3.847079 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.797066 test-rmse:3.846509 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.783371 test-rmse:3.836707 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.760317 test-rmse:3.839897 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.755642 test-rmse:3.833284 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.750886 test-rmse:3.834663 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.737716 test-rmse:3.832866 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.730757 test-rmse:3.833470 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.769430    test-rmse:17.894876 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.179074    test-rmse:13.314768 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:8.959736 test-rmse:9.939200 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.744677 test-rmse:7.862458 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.215327 test-rmse:6.289669 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.166223 test-rmse:5.344343 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.448274 test-rmse:4.808412 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.000724 test-rmse:4.346214 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.676890 test-rmse:4.018198 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.454332 test-rmse:3.864414 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.320214 test-rmse:3.706553 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.168896 test-rmse:3.625093 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.087479 test-rmse:3.566353 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.988021 test-rmse:3.482312 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.900084 test-rmse:3.473857 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.830392 test-rmse:3.442453 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.798654 test-rmse:3.423610 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.735404 test-rmse:3.392003 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.689292 test-rmse:3.344842 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.658038 test-rmse:3.329957 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.615931 test-rmse:3.323461 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.597195 test-rmse:3.320635 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.547681 test-rmse:3.315211 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.522034 test-rmse:3.289021 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.502220 test-rmse:3.273123 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.452952 test-rmse:3.264563 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.440006 test-rmse:3.266037 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.407211 test-rmse:3.267691 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.380584 test-rmse:3.252523 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.347878 test-rmse:3.254423 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.323356 test-rmse:3.247834 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.307834 test-rmse:3.243761 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.284736 test-rmse:3.229237 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.261906 test-rmse:3.218660 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.230486 test-rmse:3.216589 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.201938 test-rmse:3.205829 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.186259 test-rmse:3.204344 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.179335 test-rmse:3.192806 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.162139 test-rmse:3.192417 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.147543 test-rmse:3.182245 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.130188 test-rmse:3.175907 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.111416 test-rmse:3.182595 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.098352 test-rmse:3.190045 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.093224 test-rmse:3.190668 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.057084 test-rmse:3.183423 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.049201 test-rmse:3.184489 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.030767 test-rmse:3.184654 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.005605 test-rmse:3.189390 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.983366 test-rmse:3.196911 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.964676 test-rmse:3.202144 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.948305 test-rmse:3.189985 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.920270 test-rmse:3.199393 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.915890 test-rmse:3.199914 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.892648 test-rmse:3.199218 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.882845 test-rmse:3.196315 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.872703 test-rmse:3.185576 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.861601 test-rmse:3.193927 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.838209 test-rmse:3.184323 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.828727 test-rmse:3.182709 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.810560 test-rmse:3.176715 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.805448 test-rmse:3.176383 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.798437 test-rmse:3.180692 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.782868 test-rmse:3.188952 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.775681 test-rmse:3.180862 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.759254 test-rmse:3.183831 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.745204 test-rmse:3.182465 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.741159 test-rmse:3.183134 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.736253 test-rmse:3.184094 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.729998 test-rmse:3.191249 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.716184 test-rmse:3.184404 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.087106    test-rmse:17.547975 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.433314    test-rmse:12.898015 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.181515 test-rmse:9.806146 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.907137 test-rmse:7.608362 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.315277 test-rmse:6.191429 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.277091 test-rmse:5.247489 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.555920 test-rmse:4.620634 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.091994 test-rmse:4.277427 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.773289 test-rmse:4.039136 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.542963 test-rmse:3.837833 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.358420 test-rmse:3.719522 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.259905 test-rmse:3.657435 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.143198 test-rmse:3.614771 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.016831 test-rmse:3.509346 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.926708 test-rmse:3.452235 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.831159 test-rmse:3.424980 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.764247 test-rmse:3.401318 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.717560 test-rmse:3.386264 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.686371 test-rmse:3.359821 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.635582 test-rmse:3.344121 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.597862 test-rmse:3.321821 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.551536 test-rmse:3.314438 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.493920 test-rmse:3.301745 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.468887 test-rmse:3.307657 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.440494 test-rmse:3.318599 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.399639 test-rmse:3.308133 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.371753 test-rmse:3.321056 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.356785 test-rmse:3.311057 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.334746 test-rmse:3.315460 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.314431 test-rmse:3.313619 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.286656 test-rmse:3.301253 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.275029 test-rmse:3.300700 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.261278 test-rmse:3.313080 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.228144 test-rmse:3.307229 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.209504 test-rmse:3.301115 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.186792 test-rmse:3.290215 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.168979 test-rmse:3.284940 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.140622 test-rmse:3.289209 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.125910 test-rmse:3.283581 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.114858 test-rmse:3.286099 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.090374 test-rmse:3.302602 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.076803 test-rmse:3.301566 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.068855 test-rmse:3.296318 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.042066 test-rmse:3.292759 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.028457 test-rmse:3.294081 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.995959 test-rmse:3.270298 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.980871 test-rmse:3.268985 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.958533 test-rmse:3.274377 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.938282 test-rmse:3.272335 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.928156 test-rmse:3.275671 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.921367 test-rmse:3.278549 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.911435 test-rmse:3.271091 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.903200 test-rmse:3.273346 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.878155 test-rmse:3.275489 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.856695 test-rmse:3.268017 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.843457 test-rmse:3.263470 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.825039 test-rmse:3.262049 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.801914 test-rmse:3.260554 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.790788 test-rmse:3.264901 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.780473 test-rmse:3.265901 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.764497 test-rmse:3.257577 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.755715 test-rmse:3.257109 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.743633 test-rmse:3.251935 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.735593 test-rmse:3.251824 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.716100 test-rmse:3.252355 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.708078 test-rmse:3.256886 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.701784 test-rmse:3.254948 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.694658 test-rmse:3.253093 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.692237 test-rmse:3.252560 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.682665 test-rmse:3.252795 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.039314    test-rmse:17.372493 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.364930    test-rmse:12.737714 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.152790 test-rmse:9.706442 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.880103 test-rmse:7.469698 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.385033 test-rmse:6.221769 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.334779 test-rmse:5.418746 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.623685 test-rmse:4.894852 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.119375 test-rmse:4.530647 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.808541 test-rmse:4.299940 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.608400 test-rmse:4.144907 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.438045 test-rmse:4.021411 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.284360 test-rmse:3.923246 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.160649 test-rmse:3.878706 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.074205 test-rmse:3.879430 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.001493 test-rmse:3.882180 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.931897 test-rmse:3.853905 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.886886 test-rmse:3.839471 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.842014 test-rmse:3.817174 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.770499 test-rmse:3.809698 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.741151 test-rmse:3.788846 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.706989 test-rmse:3.786862 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.682979 test-rmse:3.788694 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.667438 test-rmse:3.801298 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.644861 test-rmse:3.800593 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.625596 test-rmse:3.807905 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.588505 test-rmse:3.830860 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.556805 test-rmse:3.830283 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.504327 test-rmse:3.831677 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.484864 test-rmse:3.827646 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.436177 test-rmse:3.831639 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.406546 test-rmse:3.843213 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.386777 test-rmse:3.850847 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.362030 test-rmse:3.850510 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.337454 test-rmse:3.846228 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.321338 test-rmse:3.831758 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.296574 test-rmse:3.823850 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.275097 test-rmse:3.802191 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.258453 test-rmse:3.806852 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.247943 test-rmse:3.816175 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.208008 test-rmse:3.815497 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.180333 test-rmse:3.810803 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.166932 test-rmse:3.802153 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.141532 test-rmse:3.800314 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.125231 test-rmse:3.801838 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.114843 test-rmse:3.801716 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.103012 test-rmse:3.790983 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.090691 test-rmse:3.789959 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.059705 test-rmse:3.758672 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.043280 test-rmse:3.760127 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.021525 test-rmse:3.757465 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.009641 test-rmse:3.761157 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.995215 test-rmse:3.761631 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.987668 test-rmse:3.767853 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.976287 test-rmse:3.764637 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.961583 test-rmse:3.763548 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.948269 test-rmse:3.765997 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.939112 test-rmse:3.760699 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.914079 test-rmse:3.762832 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.894459 test-rmse:3.750531 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.871483 test-rmse:3.749053 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.861584 test-rmse:3.756978 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.844814 test-rmse:3.756580 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.829690 test-rmse:3.756497 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.810550 test-rmse:3.755744 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.804361 test-rmse:3.762233 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.800803 test-rmse:3.762128 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.776651 test-rmse:3.751693 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.772505 test-rmse:3.748052 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.760311 test-rmse:3.744858 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.750680 test-rmse:3.737034 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.101483    test-rmse:17.221152 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.444646    test-rmse:12.615811 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.172284 test-rmse:9.598002 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.884956 test-rmse:7.412542 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.322263 test-rmse:5.931355 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.280939 test-rmse:5.076201 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.569942 test-rmse:4.549952 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.081976 test-rmse:4.256225 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.781709 test-rmse:4.040227 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.530248 test-rmse:3.816286 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.366431 test-rmse:3.756852 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.261999 test-rmse:3.717622 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.164082 test-rmse:3.678948 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.076715 test-rmse:3.604042 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.014051 test-rmse:3.578147 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.969042 test-rmse:3.556411 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.883153 test-rmse:3.516556 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.834229 test-rmse:3.496479 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.792077 test-rmse:3.487370 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.724855 test-rmse:3.454408 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.697145 test-rmse:3.424916 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.660443 test-rmse:3.425995 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.615386 test-rmse:3.415980 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.596917 test-rmse:3.384274 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.569208 test-rmse:3.387216 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.522134 test-rmse:3.372645 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.498584 test-rmse:3.373395 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.465949 test-rmse:3.366745 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.457054 test-rmse:3.369736 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.429412 test-rmse:3.367073 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.385224 test-rmse:3.361896 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.365340 test-rmse:3.369315 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.348392 test-rmse:3.338163 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.314974 test-rmse:3.347388 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.279139 test-rmse:3.354428 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.271114 test-rmse:3.360353 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.255547 test-rmse:3.370428 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.244996 test-rmse:3.364618 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.233660 test-rmse:3.355773 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.204007 test-rmse:3.354770 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.176796 test-rmse:3.350602 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.158870 test-rmse:3.351266 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.142927 test-rmse:3.354656 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.127056 test-rmse:3.359469 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.122091 test-rmse:3.365171 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.105127 test-rmse:3.363288 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.092647 test-rmse:3.366496 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.076022 test-rmse:3.364519 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.061236 test-rmse:3.363286 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.049585 test-rmse:3.369344 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.029361 test-rmse:3.373790 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.014524 test-rmse:3.370027 </span></span>
<span><span class="co">#&gt; [53] train-rmse:1.004017 test-rmse:3.368937 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.994354 test-rmse:3.369895 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.991787 test-rmse:3.370348 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.968377 test-rmse:3.365827 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.944894 test-rmse:3.368889 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.940092 test-rmse:3.365939 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.930072 test-rmse:3.365950 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.913780 test-rmse:3.371885 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.894146 test-rmse:3.370491 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.882759 test-rmse:3.372006 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.869799 test-rmse:3.380177 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.859722 test-rmse:3.369491 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.844869 test-rmse:3.376588 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.827649 test-rmse:3.382764 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.819069 test-rmse:3.384356 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.800752 test-rmse:3.387998 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.789417 test-rmse:3.393218 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.779049 test-rmse:3.397949 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.526194    test-rmse:16.532628 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.705034    test-rmse:12.224050 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.338710 test-rmse:9.098551 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.012505 test-rmse:7.200110 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.414610 test-rmse:5.915792 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.332967 test-rmse:5.032077 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.629258 test-rmse:4.617346 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.135208 test-rmse:4.254942 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.795479 test-rmse:4.046990 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.560827 test-rmse:3.883091 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.386630 test-rmse:3.803737 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.279182 test-rmse:3.746729 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.172721 test-rmse:3.744097 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.107357 test-rmse:3.706228 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.030903 test-rmse:3.674772 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.968384 test-rmse:3.674313 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.939995 test-rmse:3.661536 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.898635 test-rmse:3.636892 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.870243 test-rmse:3.640828 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.837476 test-rmse:3.620710 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.770018 test-rmse:3.621513 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.705829 test-rmse:3.569995 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.685498 test-rmse:3.568959 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.642241 test-rmse:3.541168 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.618518 test-rmse:3.535743 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.601418 test-rmse:3.541819 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.570618 test-rmse:3.513438 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.535657 test-rmse:3.505832 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.509630 test-rmse:3.493689 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.492543 test-rmse:3.497684 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.452068 test-rmse:3.493939 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.427910 test-rmse:3.486587 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.418973 test-rmse:3.491128 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.398376 test-rmse:3.490988 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.372867 test-rmse:3.486871 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.335636 test-rmse:3.477362 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.313383 test-rmse:3.455708 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.281301 test-rmse:3.431872 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.267660 test-rmse:3.424936 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.245438 test-rmse:3.427774 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.228806 test-rmse:3.413491 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.200659 test-rmse:3.411115 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.183586 test-rmse:3.410945 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.161724 test-rmse:3.413806 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.144605 test-rmse:3.407710 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.129759 test-rmse:3.406934 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.093113 test-rmse:3.395997 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.068301 test-rmse:3.397111 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.044730 test-rmse:3.402970 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.030032 test-rmse:3.404501 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.020507 test-rmse:3.401476 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.002199 test-rmse:3.400382 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.991375 test-rmse:3.400221 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.980811 test-rmse:3.394219 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.969603 test-rmse:3.387702 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.960491 test-rmse:3.384092 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.931411 test-rmse:3.376298 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.906902 test-rmse:3.379070 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.892301 test-rmse:3.378847 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.870655 test-rmse:3.379813 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.862239 test-rmse:3.373054 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.852125 test-rmse:3.362553 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.847975 test-rmse:3.363875 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.833654 test-rmse:3.361672 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.825251 test-rmse:3.358061 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.810980 test-rmse:3.361093 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.796412 test-rmse:3.357863 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.780503 test-rmse:3.360487 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.773635 test-rmse:3.354451 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.754839 test-rmse:3.344973 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.483723    test-rmse:16.602402 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.677203    test-rmse:11.971884 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.334857 test-rmse:8.970090 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.974731 test-rmse:6.865298 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.294664 test-rmse:5.452871 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.147150 test-rmse:4.587184 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.400253 test-rmse:4.028282 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.909693 test-rmse:3.673200 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.595444 test-rmse:3.490276 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.391398 test-rmse:3.390995 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.223429 test-rmse:3.317579 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.114670 test-rmse:3.244576 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.040906 test-rmse:3.243893 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.961224 test-rmse:3.237762 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.882405 test-rmse:3.230505 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.804731 test-rmse:3.211189 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.754230 test-rmse:3.187206 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.705020 test-rmse:3.164158 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.680249 test-rmse:3.155934 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.650263 test-rmse:3.148356 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.592729 test-rmse:3.138569 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.557427 test-rmse:3.137305 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.529177 test-rmse:3.140099 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.493994 test-rmse:3.130350 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.470884 test-rmse:3.131758 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.448832 test-rmse:3.132505 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.415059 test-rmse:3.131703 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.377509 test-rmse:3.121365 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.356290 test-rmse:3.122179 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.322679 test-rmse:3.120752 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.297073 test-rmse:3.114314 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.277549 test-rmse:3.120934 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.251928 test-rmse:3.113675 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.231383 test-rmse:3.110015 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.199163 test-rmse:3.099596 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.178040 test-rmse:3.091530 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.161323 test-rmse:3.096724 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.138615 test-rmse:3.096789 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.125595 test-rmse:3.096618 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.111898 test-rmse:3.094366 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.094701 test-rmse:3.097805 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.085883 test-rmse:3.092502 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.072696 test-rmse:3.087899 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.064667 test-rmse:3.088633 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.047441 test-rmse:3.090840 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.021197 test-rmse:3.073791 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.010193 test-rmse:3.078463 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.985304 test-rmse:3.073091 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.977418 test-rmse:3.076953 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.967475 test-rmse:3.077545 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.942087 test-rmse:3.083860 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.911916 test-rmse:3.081977 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.886563 test-rmse:3.078180 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.855724 test-rmse:3.078831 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.845150 test-rmse:3.077916 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.826518 test-rmse:3.080387 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.821122 test-rmse:3.081350 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.813287 test-rmse:3.083647 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.795808 test-rmse:3.085114 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.790514 test-rmse:3.083795 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.783901 test-rmse:3.070323 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.773177 test-rmse:3.068162 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.762865 test-rmse:3.055478 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.749724 test-rmse:3.054018 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.734997 test-rmse:3.053921 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.725137 test-rmse:3.063874 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.716506 test-rmse:3.065351 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.709745 test-rmse:3.067690 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.701490 test-rmse:3.067873 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.696366 test-rmse:3.066660 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.103693    test-rmse:17.252991 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.348859    test-rmse:12.743414 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.045874 test-rmse:9.692068 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.783909 test-rmse:7.692183 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.199627 test-rmse:6.321737 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.150670 test-rmse:5.533554 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.470625 test-rmse:5.048434 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.040186 test-rmse:4.743094 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.743806 test-rmse:4.468214 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.512907 test-rmse:4.274009 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.335801 test-rmse:4.174132 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.216330 test-rmse:4.133427 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.159221 test-rmse:4.105270 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.083429 test-rmse:4.084567 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.021866 test-rmse:4.010781 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.937201 test-rmse:3.993215 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.874537 test-rmse:3.959648 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.830324 test-rmse:3.939004 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.795591 test-rmse:3.903961 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.762106 test-rmse:3.888590 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.744185 test-rmse:3.883671 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.710589 test-rmse:3.892285 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.690421 test-rmse:3.863746 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.643268 test-rmse:3.858944 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.606434 test-rmse:3.845628 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.557324 test-rmse:3.858439 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.535222 test-rmse:3.865503 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.510793 test-rmse:3.855497 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.455015 test-rmse:3.858603 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.437971 test-rmse:3.863025 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.410683 test-rmse:3.859476 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.378122 test-rmse:3.852221 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.349468 test-rmse:3.853856 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.337037 test-rmse:3.854812 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.315696 test-rmse:3.858581 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.297927 test-rmse:3.864516 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.282889 test-rmse:3.852512 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.268213 test-rmse:3.846431 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.249264 test-rmse:3.852976 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.226594 test-rmse:3.850417 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.193590 test-rmse:3.836281 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.168915 test-rmse:3.819372 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.151118 test-rmse:3.815312 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.127839 test-rmse:3.812875 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.099423 test-rmse:3.813757 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.081614 test-rmse:3.816851 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.071098 test-rmse:3.813645 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.051975 test-rmse:3.811646 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.034362 test-rmse:3.808453 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.016399 test-rmse:3.810196 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.005012 test-rmse:3.813361 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.983274 test-rmse:3.823564 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.957256 test-rmse:3.809035 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.952174 test-rmse:3.810448 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.942637 test-rmse:3.807311 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.934262 test-rmse:3.805659 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.913344 test-rmse:3.794403 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.892867 test-rmse:3.775166 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.881712 test-rmse:3.779293 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.866893 test-rmse:3.776759 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.848013 test-rmse:3.767446 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.838068 test-rmse:3.769425 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.820571 test-rmse:3.764812 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.800530 test-rmse:3.769180 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.788218 test-rmse:3.771906 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.763266 test-rmse:3.774454 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.753960 test-rmse:3.771909 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.742168 test-rmse:3.771918 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.725973 test-rmse:3.775693 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.718817 test-rmse:3.774767 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.086836    test-rmse:17.271259 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.423159    test-rmse:12.482463 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.137312 test-rmse:9.356235 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.844112 test-rmse:7.146619 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.306246 test-rmse:5.573422 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.189220 test-rmse:4.663308 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.462537 test-rmse:4.120639 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.944524 test-rmse:3.822552 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.606719 test-rmse:3.610832 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.366434 test-rmse:3.531172 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.204029 test-rmse:3.501713 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.089627 test-rmse:3.483928 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.995011 test-rmse:3.479363 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.933802 test-rmse:3.494651 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.870223 test-rmse:3.485901 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.830508 test-rmse:3.495230 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.786605 test-rmse:3.484070 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.720169 test-rmse:3.456908 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.670580 test-rmse:3.443953 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.620001 test-rmse:3.443137 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.604795 test-rmse:3.445152 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.578824 test-rmse:3.445412 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.548743 test-rmse:3.441911 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.518229 test-rmse:3.438313 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.504679 test-rmse:3.458323 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.484650 test-rmse:3.451733 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.450388 test-rmse:3.432473 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.427110 test-rmse:3.416934 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.412530 test-rmse:3.415223 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.376340 test-rmse:3.411791 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.363297 test-rmse:3.417721 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.345455 test-rmse:3.423720 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.308462 test-rmse:3.436598 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.289718 test-rmse:3.438217 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.266830 test-rmse:3.432317 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.249031 test-rmse:3.443272 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.212633 test-rmse:3.454168 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.178920 test-rmse:3.454109 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.145651 test-rmse:3.452442 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.131976 test-rmse:3.465035 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.108406 test-rmse:3.468541 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.089188 test-rmse:3.463397 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.083508 test-rmse:3.465469 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.076285 test-rmse:3.463153 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.055508 test-rmse:3.469290 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.046914 test-rmse:3.470375 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.033266 test-rmse:3.467631 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.013558 test-rmse:3.475531 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.996832 test-rmse:3.475539 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.980940 test-rmse:3.457934 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.965369 test-rmse:3.466527 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.953598 test-rmse:3.461404 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.947059 test-rmse:3.462820 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.925900 test-rmse:3.454268 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.919322 test-rmse:3.460876 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.912147 test-rmse:3.459374 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.903527 test-rmse:3.456502 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.894283 test-rmse:3.450772 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.888327 test-rmse:3.449615 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.863139 test-rmse:3.459265 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.841046 test-rmse:3.468838 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.835520 test-rmse:3.473780 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.832331 test-rmse:3.475061 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.829117 test-rmse:3.476901 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.823743 test-rmse:3.472604 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.811426 test-rmse:3.480739 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.795589 test-rmse:3.479755 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.786904 test-rmse:3.481300 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.767472 test-rmse:3.485711 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.760890 test-rmse:3.494196 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.132009    test-rmse:17.251055 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.474579    test-rmse:12.813663 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.196238 test-rmse:9.473038 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.926752 test-rmse:7.332922 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.335834 test-rmse:5.797878 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.291225 test-rmse:4.941513 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.591254 test-rmse:4.424441 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.083757 test-rmse:4.016705 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.779699 test-rmse:3.772171 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.584003 test-rmse:3.615159 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.422954 test-rmse:3.545441 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.304330 test-rmse:3.491544 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.186087 test-rmse:3.436542 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.122891 test-rmse:3.391602 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.068880 test-rmse:3.389993 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.031223 test-rmse:3.356006 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.928655 test-rmse:3.314187 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.890378 test-rmse:3.295842 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.851579 test-rmse:3.278900 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.804133 test-rmse:3.283719 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.752445 test-rmse:3.292249 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.726916 test-rmse:3.280337 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.691543 test-rmse:3.255034 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.660882 test-rmse:3.244141 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.586876 test-rmse:3.253855 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.544081 test-rmse:3.226763 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.516795 test-rmse:3.211534 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.474672 test-rmse:3.209140 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.434904 test-rmse:3.204160 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.415943 test-rmse:3.199675 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.398198 test-rmse:3.209786 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.355882 test-rmse:3.195988 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.333300 test-rmse:3.198368 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.318887 test-rmse:3.192620 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.299203 test-rmse:3.186128 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.259877 test-rmse:3.193987 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.244086 test-rmse:3.192305 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.214626 test-rmse:3.184889 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.176503 test-rmse:3.189001 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.147220 test-rmse:3.184795 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.133412 test-rmse:3.178203 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.107119 test-rmse:3.176926 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.096034 test-rmse:3.179563 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.084785 test-rmse:3.180497 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.073845 test-rmse:3.174839 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.063945 test-rmse:3.164721 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.040868 test-rmse:3.161488 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.008156 test-rmse:3.173606 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.996106 test-rmse:3.177930 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.990406 test-rmse:3.181367 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.963512 test-rmse:3.186441 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.954483 test-rmse:3.171163 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.929998 test-rmse:3.170383 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.912704 test-rmse:3.153999 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.897730 test-rmse:3.148199 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.890404 test-rmse:3.148111 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.877286 test-rmse:3.139555 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.855869 test-rmse:3.144100 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.846142 test-rmse:3.148114 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.838000 test-rmse:3.147561 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.824123 test-rmse:3.147864 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.802475 test-rmse:3.158312 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.790599 test-rmse:3.156652 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.781960 test-rmse:3.158303 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.776998 test-rmse:3.158212 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.771446 test-rmse:3.157373 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.756462 test-rmse:3.156132 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.747627 test-rmse:3.155212 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.731652 test-rmse:3.163408 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.728644 test-rmse:3.163302 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.278292    test-rmse:17.131271 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.556230    test-rmse:12.753764 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.281087 test-rmse:9.710914 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.964630 test-rmse:7.441855 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.380251 test-rmse:6.080617 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.302356 test-rmse:5.150695 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.597071 test-rmse:4.589758 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.156724 test-rmse:4.261594 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.860281 test-rmse:4.087005 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.670655 test-rmse:4.006988 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.486593 test-rmse:3.949593 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.355701 test-rmse:3.857403 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.284873 test-rmse:3.850330 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.147371 test-rmse:3.810094 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.072834 test-rmse:3.798598 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.991673 test-rmse:3.761367 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.946457 test-rmse:3.704476 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.894600 test-rmse:3.707522 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.851904 test-rmse:3.692939 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.779696 test-rmse:3.674443 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.747371 test-rmse:3.630174 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.691118 test-rmse:3.579103 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.653306 test-rmse:3.547489 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.615739 test-rmse:3.547281 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.583314 test-rmse:3.524839 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.535739 test-rmse:3.516026 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.499918 test-rmse:3.527197 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.482618 test-rmse:3.543929 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.445713 test-rmse:3.535451 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.412574 test-rmse:3.518838 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.396444 test-rmse:3.524303 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.376443 test-rmse:3.515206 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.336527 test-rmse:3.489955 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.312602 test-rmse:3.490443 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.288183 test-rmse:3.488138 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.264677 test-rmse:3.498917 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.244928 test-rmse:3.489153 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.214395 test-rmse:3.470848 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.199964 test-rmse:3.465575 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.166921 test-rmse:3.465804 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.133459 test-rmse:3.471084 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.105368 test-rmse:3.475036 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.083675 test-rmse:3.476203 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.069402 test-rmse:3.464823 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.060441 test-rmse:3.448605 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.044142 test-rmse:3.440452 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.024233 test-rmse:3.447371 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.011220 test-rmse:3.449913 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.000908 test-rmse:3.446062 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.982938 test-rmse:3.441698 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.977451 test-rmse:3.451431 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.970785 test-rmse:3.447929 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.939961 test-rmse:3.448962 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.929331 test-rmse:3.447889 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.909236 test-rmse:3.458525 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.895298 test-rmse:3.446665 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.888991 test-rmse:3.448505 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.881190 test-rmse:3.449063 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.870374 test-rmse:3.446085 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.852684 test-rmse:3.443754 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.834644 test-rmse:3.435974 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.815564 test-rmse:3.426854 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.799357 test-rmse:3.423715 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.793762 test-rmse:3.428804 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.782843 test-rmse:3.428723 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.771491 test-rmse:3.432789 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.762924 test-rmse:3.433431 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.746974 test-rmse:3.427707 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.728521 test-rmse:3.430997 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.715470 test-rmse:3.432857 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.395387    test-rmse:16.807481 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.607171    test-rmse:12.209140 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.287325 test-rmse:8.937328 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.013758 test-rmse:6.761207 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.418121 test-rmse:5.271652 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.309007 test-rmse:4.362471 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.593338 test-rmse:3.809283 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.125462 test-rmse:3.488303 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.808215 test-rmse:3.257830 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.613578 test-rmse:3.154585 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.471688 test-rmse:3.079359 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.326925 test-rmse:2.990096 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.243460 test-rmse:2.929664 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.134441 test-rmse:2.890038 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.068489 test-rmse:2.834206 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.009764 test-rmse:2.824391 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.972183 test-rmse:2.825643 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.915850 test-rmse:2.827552 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.860962 test-rmse:2.804798 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.825913 test-rmse:2.805106 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.795406 test-rmse:2.794276 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.755088 test-rmse:2.794035 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.721797 test-rmse:2.775509 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.676102 test-rmse:2.762334 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.645750 test-rmse:2.755726 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.606884 test-rmse:2.752308 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.554420 test-rmse:2.725800 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.533663 test-rmse:2.709923 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.515497 test-rmse:2.715273 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.487916 test-rmse:2.688154 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.438739 test-rmse:2.688176 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.423625 test-rmse:2.672790 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.390451 test-rmse:2.663642 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.375332 test-rmse:2.664944 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.338564 test-rmse:2.667463 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.303356 test-rmse:2.654060 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.275568 test-rmse:2.665540 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.261996 test-rmse:2.659455 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.251079 test-rmse:2.665207 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.227448 test-rmse:2.653628 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.213734 test-rmse:2.646677 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.176958 test-rmse:2.649511 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.158550 test-rmse:2.659746 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.146393 test-rmse:2.661095 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.112010 test-rmse:2.650501 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.092421 test-rmse:2.659812 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.075534 test-rmse:2.660230 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.049945 test-rmse:2.655150 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.035587 test-rmse:2.660354 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.027057 test-rmse:2.658988 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.005431 test-rmse:2.649592 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.987424 test-rmse:2.645430 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.971436 test-rmse:2.647272 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.951233 test-rmse:2.637944 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.934642 test-rmse:2.638550 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.914529 test-rmse:2.639281 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.905744 test-rmse:2.634091 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.897733 test-rmse:2.635307 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.883033 test-rmse:2.625912 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.865160 test-rmse:2.627433 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.853266 test-rmse:2.628132 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.848135 test-rmse:2.625140 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.835240 test-rmse:2.620551 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.819862 test-rmse:2.629525 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.816406 test-rmse:2.631767 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.797353 test-rmse:2.636911 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.789818 test-rmse:2.636512 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.775842 test-rmse:2.636128 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.762010 test-rmse:2.640448 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.755448 test-rmse:2.634867 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.369700    test-rmse:17.163387 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.538664    test-rmse:12.632404 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.180276 test-rmse:9.463454 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.822798 test-rmse:7.408056 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.157894 test-rmse:6.144156 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.053398 test-rmse:5.392924 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.282756 test-rmse:4.813340 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.763495 test-rmse:4.541041 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.432271 test-rmse:4.383377 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.200080 test-rmse:4.191137 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.020068 test-rmse:4.085083 </span></span>
<span><span class="co">#&gt; [12] train-rmse:1.924612 test-rmse:4.041232 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.848469 test-rmse:4.027526 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.782436 test-rmse:4.080986 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.730807 test-rmse:4.065269 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.664313 test-rmse:4.020690 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.614103 test-rmse:3.966595 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.575948 test-rmse:3.973121 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.547222 test-rmse:3.971151 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.514206 test-rmse:3.951577 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.462316 test-rmse:3.959171 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.440970 test-rmse:3.968296 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.399896 test-rmse:3.967540 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.368519 test-rmse:3.964019 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.353368 test-rmse:3.948828 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.327715 test-rmse:3.951640 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.293445 test-rmse:3.937234 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.272693 test-rmse:3.912807 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.240026 test-rmse:3.901195 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.206814 test-rmse:3.899558 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.193308 test-rmse:3.902120 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.179732 test-rmse:3.887835 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.130219 test-rmse:3.853357 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.108433 test-rmse:3.837914 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.082396 test-rmse:3.830936 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.072405 test-rmse:3.831802 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.059950 test-rmse:3.836254 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.040796 test-rmse:3.836272 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.034363 test-rmse:3.835807 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.009050 test-rmse:3.830396 </span></span>
<span><span class="co">#&gt; [41] train-rmse:0.992680 test-rmse:3.829704 </span></span>
<span><span class="co">#&gt; [42] train-rmse:0.979284 test-rmse:3.818401 </span></span>
<span><span class="co">#&gt; [43] train-rmse:0.959056 test-rmse:3.817649 </span></span>
<span><span class="co">#&gt; [44] train-rmse:0.931938 test-rmse:3.802608 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.915750 test-rmse:3.806075 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.902265 test-rmse:3.805916 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.874482 test-rmse:3.802125 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.864981 test-rmse:3.801639 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.852830 test-rmse:3.806106 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.835721 test-rmse:3.797447 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.824056 test-rmse:3.802764 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.808376 test-rmse:3.800457 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.800746 test-rmse:3.802641 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.783422 test-rmse:3.796594 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.771401 test-rmse:3.804255 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.762217 test-rmse:3.798605 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.749706 test-rmse:3.799337 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.739627 test-rmse:3.796423 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.721745 test-rmse:3.796050 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.709733 test-rmse:3.789439 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.702526 test-rmse:3.787663 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.696618 test-rmse:3.785630 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.690819 test-rmse:3.780841 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.679432 test-rmse:3.782988 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.674282 test-rmse:3.784567 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.664273 test-rmse:3.784069 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.651228 test-rmse:3.785054 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.644693 test-rmse:3.786495 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.638943 test-rmse:3.788826 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.631541 test-rmse:3.779159 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.851618    test-rmse:17.689038 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.247046    test-rmse:13.146214 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.055132 test-rmse:9.992292 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.811049 test-rmse:7.597927 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.287718 test-rmse:6.017995 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.287591 test-rmse:5.168742 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.604025 test-rmse:4.545065 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.144249 test-rmse:4.192109 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.836724 test-rmse:3.936045 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.629665 test-rmse:3.844183 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.446611 test-rmse:3.774374 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.350734 test-rmse:3.656684 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.246979 test-rmse:3.608158 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.199923 test-rmse:3.614383 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.130916 test-rmse:3.566512 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.092222 test-rmse:3.569966 </span></span>
<span><span class="co">#&gt; [17] train-rmse:2.056247 test-rmse:3.531677 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.989196 test-rmse:3.509704 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.904293 test-rmse:3.526812 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.874183 test-rmse:3.542455 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.836572 test-rmse:3.529170 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.803295 test-rmse:3.528720 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.751647 test-rmse:3.509608 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.733535 test-rmse:3.533424 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.690835 test-rmse:3.526375 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.675032 test-rmse:3.528541 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.637364 test-rmse:3.531943 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.595909 test-rmse:3.532742 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.530506 test-rmse:3.529922 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.495419 test-rmse:3.524897 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.482784 test-rmse:3.530953 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.459573 test-rmse:3.524708 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.443076 test-rmse:3.540299 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.419467 test-rmse:3.559708 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.393598 test-rmse:3.551996 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.381127 test-rmse:3.549354 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.343972 test-rmse:3.546839 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.293013 test-rmse:3.547004 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.258523 test-rmse:3.550533 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.227583 test-rmse:3.552073 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.218001 test-rmse:3.565416 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.191352 test-rmse:3.555782 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.167781 test-rmse:3.555559 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.154672 test-rmse:3.560110 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.143491 test-rmse:3.561748 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.112355 test-rmse:3.573442 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.104252 test-rmse:3.576608 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.086042 test-rmse:3.564718 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.065225 test-rmse:3.573229 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.055505 test-rmse:3.572608 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.050356 test-rmse:3.574039 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.024839 test-rmse:3.582760 </span></span>
<span><span class="co">#&gt; [53] train-rmse:1.007063 test-rmse:3.594317 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.989760 test-rmse:3.596190 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.985288 test-rmse:3.589626 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.968332 test-rmse:3.587761 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.955451 test-rmse:3.588921 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.935644 test-rmse:3.581341 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.915201 test-rmse:3.576290 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.894053 test-rmse:3.575263 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.886351 test-rmse:3.578476 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.868200 test-rmse:3.574945 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.864606 test-rmse:3.570811 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.843844 test-rmse:3.571999 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.825551 test-rmse:3.578927 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.822725 test-rmse:3.575870 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.814655 test-rmse:3.573540 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.803614 test-rmse:3.577983 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.797038 test-rmse:3.584130 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.791149 test-rmse:3.583348 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.477357    test-rmse:16.527321 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.664641    test-rmse:11.995947 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.302649 test-rmse:8.958430 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.986884 test-rmse:6.865748 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.376294 test-rmse:5.499326 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.299956 test-rmse:4.772482 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.560704 test-rmse:4.274495 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.081282 test-rmse:3.934724 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.734935 test-rmse:3.754312 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.515792 test-rmse:3.590660 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.348332 test-rmse:3.475234 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.250497 test-rmse:3.442904 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.157210 test-rmse:3.383382 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.092833 test-rmse:3.351163 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.019703 test-rmse:3.355036 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.964612 test-rmse:3.332666 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.907572 test-rmse:3.299823 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.874738 test-rmse:3.292053 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.822290 test-rmse:3.308171 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.774891 test-rmse:3.277486 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.727159 test-rmse:3.252848 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.705368 test-rmse:3.217827 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.684295 test-rmse:3.203909 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.653245 test-rmse:3.201445 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.617504 test-rmse:3.202111 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.580065 test-rmse:3.188726 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.546369 test-rmse:3.184266 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.516384 test-rmse:3.181718 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.476499 test-rmse:3.170822 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.449459 test-rmse:3.162337 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.416426 test-rmse:3.176795 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.398788 test-rmse:3.177891 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.367230 test-rmse:3.175756 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.337373 test-rmse:3.174424 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.314864 test-rmse:3.169255 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.294271 test-rmse:3.176421 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.282166 test-rmse:3.171310 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.263780 test-rmse:3.168343 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.250331 test-rmse:3.168549 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.239088 test-rmse:3.170896 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.227630 test-rmse:3.165811 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.219705 test-rmse:3.167467 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.197678 test-rmse:3.158448 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.189214 test-rmse:3.150690 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.174734 test-rmse:3.144025 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.167863 test-rmse:3.140134 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.153933 test-rmse:3.138493 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.144011 test-rmse:3.136328 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.117278 test-rmse:3.118836 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.094564 test-rmse:3.093019 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.078295 test-rmse:3.092524 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.059747 test-rmse:3.090600 </span></span>
<span><span class="co">#&gt; [53] train-rmse:1.055997 test-rmse:3.091937 </span></span>
<span><span class="co">#&gt; [54] train-rmse:1.038776 test-rmse:3.088562 </span></span>
<span><span class="co">#&gt; [55] train-rmse:1.024767 test-rmse:3.092815 </span></span>
<span><span class="co">#&gt; [56] train-rmse:1.009588 test-rmse:3.096786 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.987335 test-rmse:3.099280 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.977918 test-rmse:3.100591 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.965779 test-rmse:3.105325 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.959166 test-rmse:3.106332 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.941844 test-rmse:3.110665 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.927847 test-rmse:3.097986 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.908501 test-rmse:3.103467 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.897267 test-rmse:3.105768 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.885763 test-rmse:3.104582 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.877413 test-rmse:3.109884 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.858192 test-rmse:3.113015 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.841577 test-rmse:3.112886 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.827335 test-rmse:3.111785 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.810480 test-rmse:3.102859 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.516712    test-rmse:16.439532 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.704872    test-rmse:11.972499 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.309501 test-rmse:8.962723 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.952581 test-rmse:6.891552 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.359371 test-rmse:5.631844 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.216955 test-rmse:4.851716 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.465746 test-rmse:4.414256 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.948136 test-rmse:4.126199 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.632189 test-rmse:3.988165 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.396595 test-rmse:3.910492 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.235672 test-rmse:3.861430 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.128849 test-rmse:3.879963 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.007587 test-rmse:3.839521 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.917538 test-rmse:3.819519 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.834964 test-rmse:3.834588 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.799470 test-rmse:3.846834 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.732873 test-rmse:3.842931 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.666987 test-rmse:3.819122 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.625099 test-rmse:3.788526 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.588039 test-rmse:3.763336 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.558551 test-rmse:3.747225 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.510424 test-rmse:3.756382 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.497681 test-rmse:3.734523 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.482040 test-rmse:3.733861 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.463634 test-rmse:3.753645 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.448568 test-rmse:3.741722 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.419823 test-rmse:3.727728 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.399649 test-rmse:3.719883 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.353190 test-rmse:3.690821 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.319409 test-rmse:3.697237 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.305254 test-rmse:3.692799 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.284274 test-rmse:3.683033 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.260786 test-rmse:3.694678 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.252847 test-rmse:3.687495 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.232505 test-rmse:3.690181 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.216862 test-rmse:3.689011 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.180909 test-rmse:3.689362 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.163879 test-rmse:3.686103 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.146814 test-rmse:3.695191 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.118845 test-rmse:3.702853 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.091918 test-rmse:3.707081 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.076218 test-rmse:3.704513 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.056559 test-rmse:3.704579 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.034916 test-rmse:3.696735 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.017518 test-rmse:3.686453 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.010944 test-rmse:3.672369 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.998823 test-rmse:3.671160 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.985772 test-rmse:3.669297 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.967363 test-rmse:3.678855 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.944085 test-rmse:3.677862 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.925227 test-rmse:3.675951 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.921101 test-rmse:3.666867 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.902544 test-rmse:3.658930 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.881444 test-rmse:3.660465 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.872768 test-rmse:3.665478 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.864121 test-rmse:3.662788 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.848972 test-rmse:3.651639 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.828335 test-rmse:3.641569 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.816252 test-rmse:3.636778 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.806125 test-rmse:3.639459 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.788547 test-rmse:3.634627 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.773397 test-rmse:3.629928 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.757270 test-rmse:3.619143 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.743927 test-rmse:3.622712 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.734305 test-rmse:3.624204 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.723893 test-rmse:3.626602 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.715963 test-rmse:3.626080 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.708651 test-rmse:3.625414 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.692336 test-rmse:3.621810 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.684827 test-rmse:3.617717 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.922243    test-rmse:17.651039 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.250031    test-rmse:12.887329 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.013010 test-rmse:9.756794 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.793117 test-rmse:7.768504 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.235041 test-rmse:6.281144 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.170303 test-rmse:5.362771 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.486009 test-rmse:4.830497 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.051639 test-rmse:4.501959 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.750394 test-rmse:4.297157 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.528267 test-rmse:4.143705 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.385107 test-rmse:4.056694 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.282677 test-rmse:4.011703 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.206975 test-rmse:3.983616 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.131304 test-rmse:3.921142 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.077097 test-rmse:3.898018 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.992156 test-rmse:3.874507 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.946122 test-rmse:3.832192 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.879951 test-rmse:3.791515 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.814209 test-rmse:3.778795 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.777613 test-rmse:3.767908 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.730406 test-rmse:3.749057 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.710667 test-rmse:3.742828 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.672707 test-rmse:3.727354 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.624492 test-rmse:3.710978 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.585969 test-rmse:3.717527 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.539809 test-rmse:3.718164 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.502219 test-rmse:3.711564 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.487363 test-rmse:3.716270 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.472990 test-rmse:3.729529 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.456847 test-rmse:3.730548 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.438577 test-rmse:3.720914 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.414038 test-rmse:3.713137 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.393750 test-rmse:3.698787 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.377710 test-rmse:3.685371 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.366862 test-rmse:3.677508 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.353890 test-rmse:3.680680 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.318616 test-rmse:3.679199 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.292043 test-rmse:3.676492 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.269161 test-rmse:3.670951 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.256788 test-rmse:3.679901 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.237353 test-rmse:3.677076 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.217982 test-rmse:3.671050 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.182463 test-rmse:3.674857 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.157537 test-rmse:3.667582 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.145929 test-rmse:3.660398 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.124955 test-rmse:3.661673 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.108189 test-rmse:3.659959 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.102524 test-rmse:3.661394 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.064052 test-rmse:3.663788 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.034119 test-rmse:3.665225 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.010867 test-rmse:3.658235 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.002326 test-rmse:3.648886 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.982503 test-rmse:3.663341 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.970714 test-rmse:3.660239 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.955684 test-rmse:3.655650 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.933728 test-rmse:3.649022 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.921975 test-rmse:3.646999 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.907513 test-rmse:3.651628 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.886558 test-rmse:3.654107 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.866756 test-rmse:3.662212 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.862832 test-rmse:3.658910 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.847068 test-rmse:3.651673 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.837279 test-rmse:3.652087 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.822307 test-rmse:3.651748 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.807431 test-rmse:3.652063 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.797902 test-rmse:3.655239 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.791800 test-rmse:3.658549 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.776808 test-rmse:3.658271 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.770397 test-rmse:3.659264 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.767124 test-rmse:3.662660 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.152837    test-rmse:17.312627 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.417863    test-rmse:12.623049 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.109260 test-rmse:9.430341 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.806087 test-rmse:7.340749 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.236341 test-rmse:5.969851 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.124409 test-rmse:5.180520 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.409541 test-rmse:4.725769 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.907675 test-rmse:4.370898 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.616327 test-rmse:4.193904 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.403490 test-rmse:4.063455 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.245480 test-rmse:3.954606 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.131974 test-rmse:3.909208 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.056478 test-rmse:3.883845 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.988316 test-rmse:3.829907 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.918525 test-rmse:3.846480 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.853409 test-rmse:3.844287 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.764102 test-rmse:3.808609 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.728920 test-rmse:3.798865 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.686462 test-rmse:3.801505 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.643720 test-rmse:3.768817 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.615638 test-rmse:3.772158 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.581222 test-rmse:3.754727 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.532340 test-rmse:3.742759 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.511468 test-rmse:3.754419 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.464715 test-rmse:3.738069 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.425049 test-rmse:3.750589 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.403122 test-rmse:3.755480 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.358186 test-rmse:3.725604 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.339987 test-rmse:3.718350 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.315209 test-rmse:3.706850 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.283096 test-rmse:3.697370 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.253204 test-rmse:3.704360 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.239898 test-rmse:3.701379 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.218439 test-rmse:3.705304 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.202165 test-rmse:3.717953 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.188075 test-rmse:3.712864 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.172806 test-rmse:3.706612 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.130514 test-rmse:3.693831 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.123755 test-rmse:3.687604 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.110395 test-rmse:3.683130 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.088629 test-rmse:3.684874 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.057146 test-rmse:3.673015 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.037357 test-rmse:3.669375 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.012744 test-rmse:3.667050 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.995983 test-rmse:3.663645 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.987530 test-rmse:3.662034 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.982015 test-rmse:3.661063 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.963825 test-rmse:3.663633 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.949556 test-rmse:3.656571 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.929863 test-rmse:3.654831 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.917359 test-rmse:3.656136 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.906694 test-rmse:3.650071 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.896932 test-rmse:3.651673 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.886899 test-rmse:3.646640 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.881587 test-rmse:3.644913 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.865127 test-rmse:3.649565 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.852795 test-rmse:3.653401 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.832879 test-rmse:3.655664 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.828237 test-rmse:3.649560 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.813814 test-rmse:3.649660 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.801674 test-rmse:3.646815 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.795732 test-rmse:3.652086 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.792014 test-rmse:3.650749 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.780086 test-rmse:3.654672 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.768030 test-rmse:3.653059 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.759222 test-rmse:3.653827 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.751381 test-rmse:3.647739 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.733078 test-rmse:3.651626 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.715336 test-rmse:3.653775 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.703349 test-rmse:3.657565 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.431329    test-rmse:16.703654 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.696194    test-rmse:12.218873 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.337002 test-rmse:9.118414 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:7.018587 test-rmse:7.088290 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.415362 test-rmse:5.711857 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.329083 test-rmse:4.831852 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.601945 test-rmse:4.270706 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.149155 test-rmse:4.009935 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.825517 test-rmse:3.852722 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.529904 test-rmse:3.700324 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.371822 test-rmse:3.619504 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.248299 test-rmse:3.526853 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.148486 test-rmse:3.510621 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.083448 test-rmse:3.522890 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.014768 test-rmse:3.492488 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.969852 test-rmse:3.492779 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.919457 test-rmse:3.484013 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.836285 test-rmse:3.480110 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.789915 test-rmse:3.494580 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.745980 test-rmse:3.485723 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.688302 test-rmse:3.466251 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.651237 test-rmse:3.448205 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.624050 test-rmse:3.451121 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.544799 test-rmse:3.454887 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.508494 test-rmse:3.443285 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.494843 test-rmse:3.448496 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.470220 test-rmse:3.435564 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.425408 test-rmse:3.425121 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.380475 test-rmse:3.413315 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.340690 test-rmse:3.408225 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.318358 test-rmse:3.410019 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.305773 test-rmse:3.408686 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.281862 test-rmse:3.411578 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.269213 test-rmse:3.401081 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.243276 test-rmse:3.401679 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.230148 test-rmse:3.400291 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.212566 test-rmse:3.396719 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.199863 test-rmse:3.398044 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.171560 test-rmse:3.402795 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.154470 test-rmse:3.399611 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.125709 test-rmse:3.389426 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.117133 test-rmse:3.384284 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.100629 test-rmse:3.384461 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.074666 test-rmse:3.384487 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.048657 test-rmse:3.389365 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.040674 test-rmse:3.390344 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.030349 test-rmse:3.391706 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.004669 test-rmse:3.384443 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.996423 test-rmse:3.387312 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.986165 test-rmse:3.379558 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.970477 test-rmse:3.379549 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.965665 test-rmse:3.380382 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.948489 test-rmse:3.382174 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.910145 test-rmse:3.388917 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.899244 test-rmse:3.380107 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.894504 test-rmse:3.377116 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.888464 test-rmse:3.379834 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.870660 test-rmse:3.377150 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.866385 test-rmse:3.382585 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.856161 test-rmse:3.374949 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.850367 test-rmse:3.375091 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.843837 test-rmse:3.378089 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.835610 test-rmse:3.380332 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.828715 test-rmse:3.380860 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.821685 test-rmse:3.381212 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.805571 test-rmse:3.384954 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.796083 test-rmse:3.388942 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.781292 test-rmse:3.395359 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.768496 test-rmse:3.386272 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.760739 test-rmse:3.386573 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.233425    test-rmse:17.250586 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.485570    test-rmse:12.623902 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.195193 test-rmse:9.623004 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.837540 test-rmse:7.513643 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.241085 test-rmse:6.061415 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.133397 test-rmse:5.169767 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.391679 test-rmse:4.621963 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.904424 test-rmse:4.311491 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.583741 test-rmse:4.097347 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.386201 test-rmse:3.944636 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.250730 test-rmse:3.868993 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.108683 test-rmse:3.764592 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.052999 test-rmse:3.729400 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.976534 test-rmse:3.697717 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.921351 test-rmse:3.658235 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.823806 test-rmse:3.602679 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.791829 test-rmse:3.590524 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.732673 test-rmse:3.588665 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.691548 test-rmse:3.541515 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.663846 test-rmse:3.533724 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.644180 test-rmse:3.518984 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.574901 test-rmse:3.499891 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.559760 test-rmse:3.497970 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.511802 test-rmse:3.470968 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.472486 test-rmse:3.463712 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.453882 test-rmse:3.467987 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.425199 test-rmse:3.454385 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.371651 test-rmse:3.477113 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.356004 test-rmse:3.478002 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.341601 test-rmse:3.466878 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.324580 test-rmse:3.460670 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.295253 test-rmse:3.451498 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.283414 test-rmse:3.444746 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.253856 test-rmse:3.437694 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.236857 test-rmse:3.436742 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.215436 test-rmse:3.425606 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.180066 test-rmse:3.407364 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.157078 test-rmse:3.406668 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.141348 test-rmse:3.401793 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.134249 test-rmse:3.398003 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.100634 test-rmse:3.382796 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.091744 test-rmse:3.386709 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.061454 test-rmse:3.377536 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.039501 test-rmse:3.379761 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.020237 test-rmse:3.375047 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.000813 test-rmse:3.376329 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.977879 test-rmse:3.370643 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.974470 test-rmse:3.368579 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.957972 test-rmse:3.370339 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.951925 test-rmse:3.369920 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.935729 test-rmse:3.366010 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.923628 test-rmse:3.372610 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.912039 test-rmse:3.357990 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.895802 test-rmse:3.361504 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.870712 test-rmse:3.362466 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.852411 test-rmse:3.359917 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.837318 test-rmse:3.352954 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.822292 test-rmse:3.342966 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.812269 test-rmse:3.340620 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.798920 test-rmse:3.341524 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.787027 test-rmse:3.336136 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.772426 test-rmse:3.333496 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.756167 test-rmse:3.329261 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.746415 test-rmse:3.332921 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.733260 test-rmse:3.331723 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.725389 test-rmse:3.327671 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.719412 test-rmse:3.326824 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.706745 test-rmse:3.326814 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.697934 test-rmse:3.319295 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.681594 test-rmse:3.318715 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.128594    test-rmse:17.124916 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.473696    test-rmse:12.576642 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.155455 test-rmse:9.317343 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.869103 test-rmse:7.051151 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.318934 test-rmse:5.554716 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.305869 test-rmse:4.620594 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.600153 test-rmse:3.880415 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:3.165971 test-rmse:3.499136 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.890240 test-rmse:3.277098 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.648240 test-rmse:3.197614 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.466549 test-rmse:3.075079 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.373009 test-rmse:3.025359 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.295470 test-rmse:2.996508 </span></span>
<span><span class="co">#&gt; [14] train-rmse:2.242929 test-rmse:2.987894 </span></span>
<span><span class="co">#&gt; [15] train-rmse:2.189766 test-rmse:2.936767 </span></span>
<span><span class="co">#&gt; [16] train-rmse:2.115994 test-rmse:2.928127 </span></span>
<span><span class="co">#&gt; [17] train-rmse:2.047733 test-rmse:2.922381 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.993770 test-rmse:2.893833 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.925173 test-rmse:2.868403 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.891927 test-rmse:2.858402 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.855631 test-rmse:2.846958 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.817977 test-rmse:2.817564 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.793867 test-rmse:2.826849 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.760676 test-rmse:2.799355 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.733016 test-rmse:2.806548 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.698300 test-rmse:2.790279 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.667252 test-rmse:2.818433 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.632844 test-rmse:2.801740 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.584815 test-rmse:2.803550 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.559019 test-rmse:2.791002 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.523995 test-rmse:2.788743 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.496033 test-rmse:2.808156 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.480189 test-rmse:2.802236 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.453507 test-rmse:2.801068 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.441042 test-rmse:2.798688 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.425898 test-rmse:2.795132 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.380954 test-rmse:2.779995 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.356294 test-rmse:2.787496 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.333006 test-rmse:2.790582 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.316990 test-rmse:2.789516 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.291145 test-rmse:2.784462 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.267506 test-rmse:2.772754 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.236319 test-rmse:2.773344 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.209988 test-rmse:2.779797 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.181657 test-rmse:2.770077 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.156871 test-rmse:2.777735 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.121685 test-rmse:2.780174 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.100434 test-rmse:2.755684 </span></span>
<span><span class="co">#&gt; [49] train-rmse:1.082500 test-rmse:2.758530 </span></span>
<span><span class="co">#&gt; [50] train-rmse:1.060479 test-rmse:2.755751 </span></span>
<span><span class="co">#&gt; [51] train-rmse:1.042871 test-rmse:2.749594 </span></span>
<span><span class="co">#&gt; [52] train-rmse:1.026156 test-rmse:2.750159 </span></span>
<span><span class="co">#&gt; [53] train-rmse:1.014550 test-rmse:2.748956 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.992050 test-rmse:2.740920 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.979768 test-rmse:2.744747 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.957779 test-rmse:2.744108 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.936233 test-rmse:2.743346 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.930738 test-rmse:2.744985 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.914788 test-rmse:2.746578 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.897444 test-rmse:2.742718 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.881162 test-rmse:2.746288 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.873362 test-rmse:2.739386 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.855085 test-rmse:2.746520 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.835583 test-rmse:2.751073 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.825417 test-rmse:2.744734 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.805799 test-rmse:2.757439 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.793748 test-rmse:2.762758 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.780451 test-rmse:2.767125 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.774147 test-rmse:2.769935 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.762300 test-rmse:2.769790 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.292655    test-rmse:16.876471 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.577736    test-rmse:12.195365 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.241283 test-rmse:8.922933 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.913518 test-rmse:6.724334 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.326545 test-rmse:5.265766 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.262574 test-rmse:4.416342 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.480536 test-rmse:3.935688 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.985960 test-rmse:3.632995 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.660206 test-rmse:3.538935 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.435057 test-rmse:3.492154 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.264139 test-rmse:3.480262 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.115240 test-rmse:3.447267 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.997048 test-rmse:3.432714 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.913323 test-rmse:3.423979 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.836868 test-rmse:3.391161 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.781762 test-rmse:3.377973 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.708092 test-rmse:3.359732 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.681469 test-rmse:3.367809 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.625341 test-rmse:3.353789 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.564421 test-rmse:3.327785 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.531215 test-rmse:3.320419 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.488833 test-rmse:3.341321 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.456582 test-rmse:3.319002 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.425750 test-rmse:3.304326 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.379122 test-rmse:3.285657 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.335484 test-rmse:3.281933 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.307765 test-rmse:3.261889 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.264471 test-rmse:3.255168 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.254344 test-rmse:3.249777 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.217107 test-rmse:3.232775 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.201509 test-rmse:3.229382 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.184240 test-rmse:3.222288 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.156229 test-rmse:3.213939 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.136092 test-rmse:3.216067 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.110480 test-rmse:3.216788 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.094752 test-rmse:3.206662 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.075361 test-rmse:3.211364 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.061166 test-rmse:3.207463 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.044627 test-rmse:3.212024 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.017754 test-rmse:3.214319 </span></span>
<span><span class="co">#&gt; [41] train-rmse:0.995682 test-rmse:3.211204 </span></span>
<span><span class="co">#&gt; [42] train-rmse:0.975897 test-rmse:3.204311 </span></span>
<span><span class="co">#&gt; [43] train-rmse:0.969302 test-rmse:3.209325 </span></span>
<span><span class="co">#&gt; [44] train-rmse:0.962742 test-rmse:3.213350 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.950907 test-rmse:3.205705 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.926037 test-rmse:3.203800 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.913792 test-rmse:3.188461 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.895957 test-rmse:3.184823 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.883827 test-rmse:3.181743 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.861841 test-rmse:3.181888 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.850236 test-rmse:3.177201 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.842394 test-rmse:3.176773 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.827710 test-rmse:3.171668 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.817296 test-rmse:3.175845 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.812589 test-rmse:3.174930 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.807248 test-rmse:3.178411 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.799478 test-rmse:3.172622 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.785276 test-rmse:3.171110 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.780453 test-rmse:3.172351 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.767954 test-rmse:3.173666 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.764007 test-rmse:3.172314 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.758229 test-rmse:3.173465 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.747242 test-rmse:3.172619 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.735999 test-rmse:3.170532 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.725830 test-rmse:3.174557 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.708749 test-rmse:3.173571 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.689192 test-rmse:3.178361 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.675599 test-rmse:3.176243 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.657948 test-rmse:3.178651 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.649430 test-rmse:3.176308 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:17.544533    test-rmse:16.355680 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.719916    test-rmse:11.847680 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:9.325918 test-rmse:8.587711 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.978470 test-rmse:6.520126 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.330168 test-rmse:5.197999 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:4.227713 test-rmse:4.370258 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.452389 test-rmse:3.899105 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.953947 test-rmse:3.646518 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.621221 test-rmse:3.488626 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.390508 test-rmse:3.434280 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.248430 test-rmse:3.393405 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.148335 test-rmse:3.397108 </span></span>
<span><span class="co">#&gt; [13] train-rmse:2.062937 test-rmse:3.364962 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.965071 test-rmse:3.319566 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.898697 test-rmse:3.274744 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.864320 test-rmse:3.256337 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.837230 test-rmse:3.262007 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.803225 test-rmse:3.235490 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.749646 test-rmse:3.211386 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.711134 test-rmse:3.192852 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.666622 test-rmse:3.184116 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.628228 test-rmse:3.183039 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.593111 test-rmse:3.160884 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.569067 test-rmse:3.152188 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.538398 test-rmse:3.129954 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.487646 test-rmse:3.142378 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.463082 test-rmse:3.140700 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.420317 test-rmse:3.114777 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.403061 test-rmse:3.115688 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.358206 test-rmse:3.101864 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.340879 test-rmse:3.100730 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.311146 test-rmse:3.082216 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.290238 test-rmse:3.077993 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.280471 test-rmse:3.072337 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.237008 test-rmse:3.043744 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.223663 test-rmse:3.029086 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.214975 test-rmse:3.022611 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.185739 test-rmse:3.017997 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.164385 test-rmse:3.013672 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.154593 test-rmse:3.013402 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.139351 test-rmse:3.012511 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.121388 test-rmse:3.008539 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.104007 test-rmse:2.995401 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.097245 test-rmse:2.987109 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.077283 test-rmse:2.990181 </span></span>
<span><span class="co">#&gt; [46] train-rmse:1.050955 test-rmse:2.983796 </span></span>
<span><span class="co">#&gt; [47] train-rmse:1.036467 test-rmse:2.979257 </span></span>
<span><span class="co">#&gt; [48] train-rmse:1.028401 test-rmse:2.984757 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.994774 test-rmse:2.976397 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.985299 test-rmse:2.964851 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.977850 test-rmse:2.957399 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.956651 test-rmse:2.944479 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.949326 test-rmse:2.947867 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.927821 test-rmse:2.952446 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.908993 test-rmse:2.944909 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.884882 test-rmse:2.935588 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.873803 test-rmse:2.938716 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.845808 test-rmse:2.936628 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.840582 test-rmse:2.937588 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.831460 test-rmse:2.938824 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.813577 test-rmse:2.944781 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.800639 test-rmse:2.936827 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.790201 test-rmse:2.933134 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.776988 test-rmse:2.928452 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.757110 test-rmse:2.933903 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.743001 test-rmse:2.931065 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.735839 test-rmse:2.929767 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.723563 test-rmse:2.927346 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.713754 test-rmse:2.925463 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.698813 test-rmse:2.927692 </span></span>
<span><span class="co">#&gt; [1]  train-rmse:16.674860    test-rmse:18.015271 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:12.063769    test-rmse:13.222241 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:8.811503 test-rmse:9.994677 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:6.582876 test-rmse:7.760594 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:5.018353 test-rmse:6.298805 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:3.953114 test-rmse:5.304116 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:3.254362 test-rmse:4.729481 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:2.794439 test-rmse:4.387156 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:2.501569 test-rmse:4.179851 </span></span>
<span><span class="co">#&gt; [10] train-rmse:2.274560 test-rmse:4.039873 </span></span>
<span><span class="co">#&gt; [11] train-rmse:2.137563 test-rmse:3.954427 </span></span>
<span><span class="co">#&gt; [12] train-rmse:2.045113 test-rmse:3.914518 </span></span>
<span><span class="co">#&gt; [13] train-rmse:1.954443 test-rmse:3.868235 </span></span>
<span><span class="co">#&gt; [14] train-rmse:1.882999 test-rmse:3.860332 </span></span>
<span><span class="co">#&gt; [15] train-rmse:1.804658 test-rmse:3.836931 </span></span>
<span><span class="co">#&gt; [16] train-rmse:1.754922 test-rmse:3.828111 </span></span>
<span><span class="co">#&gt; [17] train-rmse:1.716032 test-rmse:3.805052 </span></span>
<span><span class="co">#&gt; [18] train-rmse:1.650214 test-rmse:3.778186 </span></span>
<span><span class="co">#&gt; [19] train-rmse:1.600299 test-rmse:3.757008 </span></span>
<span><span class="co">#&gt; [20] train-rmse:1.553732 test-rmse:3.739166 </span></span>
<span><span class="co">#&gt; [21] train-rmse:1.525169 test-rmse:3.731639 </span></span>
<span><span class="co">#&gt; [22] train-rmse:1.489868 test-rmse:3.712193 </span></span>
<span><span class="co">#&gt; [23] train-rmse:1.442279 test-rmse:3.697139 </span></span>
<span><span class="co">#&gt; [24] train-rmse:1.414500 test-rmse:3.692106 </span></span>
<span><span class="co">#&gt; [25] train-rmse:1.365578 test-rmse:3.680468 </span></span>
<span><span class="co">#&gt; [26] train-rmse:1.347896 test-rmse:3.673943 </span></span>
<span><span class="co">#&gt; [27] train-rmse:1.332444 test-rmse:3.672703 </span></span>
<span><span class="co">#&gt; [28] train-rmse:1.305014 test-rmse:3.661026 </span></span>
<span><span class="co">#&gt; [29] train-rmse:1.277232 test-rmse:3.662294 </span></span>
<span><span class="co">#&gt; [30] train-rmse:1.248798 test-rmse:3.650389 </span></span>
<span><span class="co">#&gt; [31] train-rmse:1.241240 test-rmse:3.651887 </span></span>
<span><span class="co">#&gt; [32] train-rmse:1.217933 test-rmse:3.639778 </span></span>
<span><span class="co">#&gt; [33] train-rmse:1.206731 test-rmse:3.638429 </span></span>
<span><span class="co">#&gt; [34] train-rmse:1.187312 test-rmse:3.635264 </span></span>
<span><span class="co">#&gt; [35] train-rmse:1.164374 test-rmse:3.632264 </span></span>
<span><span class="co">#&gt; [36] train-rmse:1.131843 test-rmse:3.640556 </span></span>
<span><span class="co">#&gt; [37] train-rmse:1.124082 test-rmse:3.633127 </span></span>
<span><span class="co">#&gt; [38] train-rmse:1.110077 test-rmse:3.630717 </span></span>
<span><span class="co">#&gt; [39] train-rmse:1.100095 test-rmse:3.631217 </span></span>
<span><span class="co">#&gt; [40] train-rmse:1.081659 test-rmse:3.635696 </span></span>
<span><span class="co">#&gt; [41] train-rmse:1.072853 test-rmse:3.632723 </span></span>
<span><span class="co">#&gt; [42] train-rmse:1.055953 test-rmse:3.633422 </span></span>
<span><span class="co">#&gt; [43] train-rmse:1.031922 test-rmse:3.637305 </span></span>
<span><span class="co">#&gt; [44] train-rmse:1.023225 test-rmse:3.625068 </span></span>
<span><span class="co">#&gt; [45] train-rmse:1.006294 test-rmse:3.620948 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.994529 test-rmse:3.617117 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.979627 test-rmse:3.611547 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.971881 test-rmse:3.608559 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.965366 test-rmse:3.604040 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.954073 test-rmse:3.605317 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.931940 test-rmse:3.602057 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.920522 test-rmse:3.596360 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.916464 test-rmse:3.593168 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.898960 test-rmse:3.587739 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.873178 test-rmse:3.578689 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.863999 test-rmse:3.576982 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.844966 test-rmse:3.583278 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.833886 test-rmse:3.580366 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.818516 test-rmse:3.577260 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.805208 test-rmse:3.577898 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.797068 test-rmse:3.577023 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.785239 test-rmse:3.568169 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.776081 test-rmse:3.572902 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.756783 test-rmse:3.572786 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.737046 test-rmse:3.571570 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.729238 test-rmse:3.572501 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.723132 test-rmse:3.578412 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.710213 test-rmse:3.568142 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.703534 test-rmse:3.568780 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.688026 test-rmse:3.571313</span></span>
<span><span class="co">#&gt; [1] 3.486078</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># no warnings for individual XGBoost function</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></div>
<div class="next"><a href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li>
<a class="nav-link" href="#numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#all-our-models-will-be-structured-the-same-way-y-.-data-train"><span class="header-section-number">3.0.1</span> All our models will be structured the same way: y ~ ., data = train</a></li>
<li><a class="nav-link" href="#having-the-same-structure-for-all-the-models-makes-it-much-easier-to-build-debug-and-deploy-the-completed-models."><span class="header-section-number">3.0.2</span> Having the same structure for all the models makes it much easier to build, debug, and deploy the completed models.</a></li>
<li><a class="nav-link" href="#exercise-re-read-the-steps-above-how-we-will-work-backwards-to-come-up-with-the-function-we-need."><span class="header-section-number">3.0.3</span> Exercise: Re-read the steps above how we will work backwards to come up with the function we need.</a></li>
<li><a class="nav-link" href="#bagged-random-forest"><span class="header-section-number">3.0.4</span> 1. Bagged Random Forest</a></li>
<li><a class="nav-link" href="#bagging-bootstrap-aggregating"><span class="header-section-number">3.0.5</span> 2. Bagging (bootstrap aggregating)</a></li>
<li><a class="nav-link" href="#bayesglm"><span class="header-section-number">3.0.6</span> 3. BayesGLM</a></li>
<li><a class="nav-link" href="#bayesrnn"><span class="header-section-number">3.0.7</span> 4. BayesRNN</a></li>
<li><a class="nav-link" href="#boosted-random-forest"><span class="header-section-number">3.0.8</span> 5. Boosted Random Forest</a></li>
<li><a class="nav-link" href="#cubist"><span class="header-section-number">3.0.9</span> 6. Cubist</a></li>
<li><a class="nav-link" href="#elastic"><span class="header-section-number">3.0.10</span> 7. Elastic</a></li>
<li><a class="nav-link" href="#generalized-additive-models-with-smoothing-splines"><span class="header-section-number">3.0.11</span> 8. Generalized Additive Models with smoothing splines</a></li>
<li><a class="nav-link" href="#gradient-boosted"><span class="header-section-number">3.0.12</span> 9. Gradient Boosted</a></li>
<li><a class="nav-link" href="#k-nearest-neighbors-tuned"><span class="header-section-number">3.0.13</span> 10. K-Nearest Neighbors (tuned)</a></li>
<li><a class="nav-link" href="#lasso"><span class="header-section-number">3.0.14</span> 11. Lasso</a></li>
<li><a class="nav-link" href="#linear-tuned"><span class="header-section-number">3.0.15</span> 12. Linear (tuned)</a></li>
<li><a class="nav-link" href="#lqs"><span class="header-section-number">3.0.16</span> 13. LQS</a></li>
<li><a class="nav-link" href="#neuralnet"><span class="header-section-number">3.0.17</span> 14. Neuralnet</a></li>
<li><a class="nav-link" href="#partial-least-squares"><span class="header-section-number">3.0.18</span> 15. Partial Least Squares</a></li>
<li><a class="nav-link" href="#principal-components-regression"><span class="header-section-number">3.0.19</span> 16. Principal Components Regression</a></li>
<li><a class="nav-link" href="#random-forest"><span class="header-section-number">3.0.20</span> 17. Random Forest</a></li>
<li><a class="nav-link" href="#ridge-regression"><span class="header-section-number">3.0.21</span> 18. Ridge Regression</a></li>
<li><a class="nav-link" href="#robust-regression"><span class="header-section-number">3.0.22</span> 19. Robust Regression</a></li>
<li><a class="nav-link" href="#rpart"><span class="header-section-number">3.0.23</span> 20. Rpart</a></li>
<li><a class="nav-link" href="#support-vector-machines"><span class="header-section-number">3.0.24</span> 21. Support Vector Machines</a></li>
<li><a class="nav-link" href="#trees"><span class="header-section-number">3.0.25</span> 22. Trees</a></li>
<li><a class="nav-link" href="#xgboost"><span class="header-section-number">3.0.26</span> 23. XGBoost</a></li>
</ul>
</li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/InfinteCuriosity/EnsemblesBook/blob/master/02-Individual_Numerical_Models.rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/InfinteCuriosity/EnsemblesBook/edit/master/02-Individual_Numerical_Models.rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Ensembles: From Beginner to Expert</strong>" was written by Russ Conte. It was last built on 2024-06-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
