<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Individual logistic models | Ensembles: From Beginner to Expert</title>
<meta name="author" content="Russ Conte">
<meta name="description" content="Logistic data sets are extremely powerful. In this chapter we’ll use them to evaluate the risk of type 2 diabetes in Pima Indian women, and in the logistic ensembles chapter we’ll use it to make...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="Chapter 7 Individual logistic models | Ensembles: From Beginner to Expert">
<meta property="og:type" content="book">
<meta property="og:description" content="Logistic data sets are extremely powerful. In this chapter we’ll use them to evaluate the risk of type 2 diabetes in Pima Indian women, and in the logistic ensembles chapter we’ll use it to make...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Individual logistic models | Ensembles: From Beginner to Expert">
<meta name="twitter:description" content="Logistic data sets are extremely powerful. In this chapter we’ll use them to evaluate the risk of type 2 diabetes in Pima Indian women, and in the logistic ensembles chapter we’ll use it to make...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Ensembles: From Beginner to Expert</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Welcome!</a></li>
<li><a class="" href="introduction-and-your-first-ensembles.html"><span class="header-section-number">2</span> Introduction and your first ensembles</a></li>
<li><a class="" href="numerical-data-how-to-make-23-individual-models-and-basic-skills-with-functions.html"><span class="header-section-number">3</span> Numerical data: How to make 23 individual models, and basic skills with functions</a></li>
<li><a class="" href="building-weighted-ensembles-to-model-numerical-data.html"><span class="header-section-number">4</span> Building weighted ensembles to model numerical data</a></li>
<li><a class="" href="classification-data-how-to-make-14-individual-classification-models.html"><span class="header-section-number">5</span> Classification data: How to make 14 individual classification models</a></li>
<li><a class="" href="building-ensembles-of-classification-models.html"><span class="header-section-number">6</span> Building ensembles of classification models</a></li>
<li><a class="active" href="individual-logistic-models.html"><span class="header-section-number">7</span> Individual logistic models</a></li>
<li><a class="" href="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles.html"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></li>
<li><a class="" href="how-to-make-27-individual-forecasting-models.html"><span class="header-section-number">9</span> How to Make 27 Individual Forecasting Models</a></li>
<li><a class="" href="ensembles-of-26-forecasting-models.html"><span class="header-section-number">10</span> Ensembles of 26 Forecasting Models</a></li>
<li><a class="" href="predicting-on-totally-new-data-with-individual-models-and-ensembles.html"><span class="header-section-number">11</span> Predicting on totally new data with individual models and ensembles</a></li>
<li><a class="" href="how-to-communicate-your-results.html"><span class="header-section-number">12</span> How to communicate your results</a></li>
<li><a class="" href="final-comprhensive-project.html"><span class="header-section-number">13</span> Final Comprhensive Project</a></li>
<li><a class="" href="building-your-own-no-code-solutions.html"><span class="header-section-number">14</span> Building your own no-code solutions</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/InfiniteCuriosity/EnsemblesBook">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="individual-logistic-models" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Individual logistic models<a class="anchor" aria-label="anchor" href="#individual-logistic-models"><i class="fas fa-link"></i></a>
</h1>
<p>Logistic data sets are extremely powerful. In this chapter we’ll use them to evaluate the risk of type 2 diabetes in Pima Indian women, and in the logistic ensembles chapter we’ll use it to make recommendations to improve the performance of Lebron James.</p>
<p>That raises a very good question: How can two fields as far apart as scientific research (Pima Indians) and sports analytics (Lebron) be connected? It’s because the structure of the data is the same, and it’s the structure of the data that makes it easy to use.</p>
<p>Logistic regression is rooted in the idea of a logical variable (hence the name). A variable is a logical variable if there are a specific number of options, usually two options. They have many possible names which all come down to the same result. Names might include true or false, presence or absence of a condition (such as diabetes), or success or failure of making a basket.</p>
<p>In logistic modeling those values are converted to 1 or 0 (if they are not converted already). Let’s start by getting the Pima Indians data set from the Kaggle web site:</p>
<p><a href="https://www.kaggle.com/datasets/uciml/pima-indians-diabetes-database" class="uri">https://www.kaggle.com/datasets/uciml/pima-indians-diabetes-database</a></p>
<p>Download the data set, and open it in your system. For example,</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">diabetes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'https://raw.githubusercontent.com/InfiniteCuriosity/EnsemblesData/main/diabetes.csv'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Pregnancies Glucose BloodPressure SkinThickness Insulin</span></span>
<span><span class="co">#&gt; 1           6     148            72            35       0</span></span>
<span><span class="co">#&gt; 2           1      85            66            29       0</span></span>
<span><span class="co">#&gt; 3           8     183            64             0       0</span></span>
<span><span class="co">#&gt; 4           1      89            66            23      94</span></span>
<span><span class="co">#&gt; 5           0     137            40            35     168</span></span>
<span><span class="co">#&gt; 6           5     116            74             0       0</span></span>
<span><span class="co">#&gt;    BMI DiabetesPedigreeFunction Age Outcome</span></span>
<span><span class="co">#&gt; 1 33.6                    0.627  50       1</span></span>
<span><span class="co">#&gt; 2 26.6                    0.351  31       0</span></span>
<span><span class="co">#&gt; 3 23.3                    0.672  32       1</span></span>
<span><span class="co">#&gt; 4 28.1                    0.167  21       0</span></span>
<span><span class="co">#&gt; 5 43.1                    2.288  33       1</span></span>
<span><span class="co">#&gt; 6 25.6                    0.201  30       0</span></span></code></pre></div>
<p>We can clearly see the eight features which will be used to predict the ninth feature, Outcome. Our final logistic model will be in the form of: Outcome ~ ., data = df.</p>
<p>By far the most common way to do this is using Generalized Linear Models, and we will begin there. We will follow our well established method for building a model, which we used with numerical and classification data:</p>
<blockquote>
<p>Load the library</p>
<p>Set initial values to 0</p>
<p>Create the function</p>
<p>Set up random resampling</p>
<p>Break the data into train and test</p>
<p>Fit the model on the training data, make predictions and measure error on the test data</p>
<p>Return the results</p>
<p>Check for errors or warnings</p>
<p>Test on a different data set</p>
</blockquote>
<p>For this set of examples we are also going to add the results of the ROC curve, so the ROC curve is printed automatically.</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.5.1     ✔ tibble    3.2.1</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.3     ✔ tidyr     1.3.1</span></span>
<span><span class="co">#&gt; ✔ purrr     1.0.2     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Type 'citation("pROC")' for a citation.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'pROC'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     cov, smooth, var</span></span></code></pre></div>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">glm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">glm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">glm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">glm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">glm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">glm_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span><span class="co"># Set up random resampling</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span><span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span><span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span></span>
<span><span class="va">glm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glm_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">glm_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">glm_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">glm_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">glm_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">glm_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">glm_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">glm_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">glm_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">glm_train_table</span><span class="op">)</span></span>
<span><span class="va">glm_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">glm_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glm_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">glm_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">glm_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">glm_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">glm_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">glm_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">glm_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">glm_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">glm_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">glm_test_table</span><span class="op">)</span></span>
<span><span class="va">glm_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">glm_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glm_holdout_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">glm_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glm_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">glm_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">glm_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">glm_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">glm_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Generalized Linear Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">glm_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">glm_holdout_accuracy_mean</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">glm_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/Our%20first%20logistic%20model-1.png" width="672"></div>
<pre><code>#&gt; [1] 0.7718631</code></pre>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The results are consistent with similar results using Generalized Linear Models for this data set.</p>
<div id="how-to-use-non-glm-models-in-logistic-analysis" class="section level3" number="7.0.1">
<h3>
<span class="header-section-number">7.0.1</span> How to use non-GLM models in logistic analysis<a class="anchor" aria-label="anchor" href="#how-to-use-non-glm-models-in-logistic-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>The authors of the excellent book, Introduction to Statistical Learning, describe and demonstrate how non-GLM methods may be used in logistic analysis. They investigated Linear Discriminant Analysis, Quadratic Discriminant Analysis and K-Nearest Neighbors. We will look at a total of ten methods, though many more are possible.</p>
<div class="float">
<img src="Images/GLM_warning.jpg" alt="Logistic warning"><div class="figcaption">Logistic warning</div>
</div>
</div>
<div id="eight-individual-models-for-logistic-data" class="section level3" number="7.0.2">
<h3>
<span class="header-section-number">7.0.2</span> Eight individual models for logistic data<a class="anchor" aria-label="anchor" href="#eight-individual-models-for-logistic-data"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="adaboost" class="section level3" number="7.0.3">
<h3>
<span class="header-section-number">7.0.3</span> Adaboost<a class="anchor" aria-label="anchor" href="#adaboost"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://brian-j-smith.github.io/MachineShop/">MachineShop</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'MachineShop'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:pROC':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     auc</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     lift</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     ppr</span></span></code></pre></div>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">adaboost_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">adaboost_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">adaboost_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span>    <span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">adaboost_train_fit</span> <span class="op">&lt;-</span> <span class="fu">MachineShop</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MachineShop/man/fit-methods.html">fit</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, model <span class="op">=</span> <span class="st">"AdaBoostModel"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_train_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_train_accuracy</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">adaboost_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">adaboost_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">adaboost_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">adaboost_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">adaboost_test_table</span><span class="op">)</span></span>
<span><span class="va">adaboost_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">adaboost_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">adaboost_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">adaboost_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">adaboost_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ADAboost Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">adaboost_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">adaboost_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">adaboost_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/ADABoost%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 0.7484076</code></pre>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="bayesglm-1" class="section level3" number="7.0.4">
<h3>
<span class="header-section-number">7.0.4</span> BayesGLM<a class="anchor" aria-label="anchor" href="#bayesglm-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://CRAN.R-project.org/package=arm">arm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'MASS'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'Matrix'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:tidyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     expand, pack, unpack</span></span>
<span><span class="co">#&gt; Loading required package: lme4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; arm (Version 1.14-4, built: 2024-4-1)</span></span>
<span><span class="co">#&gt; Working directory is /Users/russellconte/Library/Mobile Documents/com~apple~CloudDocs/Documents/Machine Learning templates in R/EnsemblesBook</span></span></code></pre></div>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">bayesglm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">bayesglm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">bayesglm_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span>    <span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">bayesglm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">arm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/arm/man/bayesglm.html">bayesglm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">bayesglm_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_train_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bayesglm_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">bayesglm_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">bayesglm_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bayesglm_test_table</span><span class="op">)</span></span>
<span><span class="va">bayesglm_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bayesglm_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bayesglm_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">bayesglm_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bayesglm_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">bayesglm_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Bayesglm Models "</span>, <span class="st">"(AUC = "</span>, <span class="va">bayesglm_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>            <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">bayesglm_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">bayesglm_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/BayesGLM%20model%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 0.7824675</code></pre>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="c50" class="section level3" number="7.0.5">
<h3>
<span class="header-section-number">7.0.5</span> C50<a class="anchor" aria-label="anchor" href="#c50"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/C5.0/">C50</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">C50_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">C50_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">C50_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span>    <span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">C50_train_fit</span> <span class="op">&lt;-</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html">C5.0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_train_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_train_table</span><span class="op">)</span></span>
<span><span class="va">C50_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">C50_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">C50_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">C50_test_pred</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">C50_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">C50_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">C50_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">C50_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">C50_test_table</span><span class="op">)</span></span>
<span><span class="va">C50_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">C50_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">C50_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">C50_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">C50_test_predictions</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">C50_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"C50 ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">C50_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">C50_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">C50_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/C50%20models%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 1</code></pre>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="cubist-1" class="section level3" number="7.0.6">
<h3>
<span class="header-section-number">7.0.6</span> Cubist<a class="anchor" aria-label="anchor" href="#cubist-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://topepo.github.io/Cubist//">Cubist</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: lattice</span></span></code></pre></div>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">cubist_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">cubist_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">cubist_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span>    <span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">cubist_train_fit</span> <span class="op">&lt;-</span> <span class="fu">Cubist</span><span class="fu">::</span><span class="fu"><a href="http://topepo.github.io/Cubist/reference/cubist.default.html">cubist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">cubist_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_train_pred</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_train_table</span><span class="op">)</span></span>
<span><span class="va">cubist_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cubist_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">cubist_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">cubist_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">cubist_test_pred</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">cubist_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">cubist_test_table</span><span class="op">)</span></span>
<span><span class="va">cubist_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cubist_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">cubist_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cubist_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cubist_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">cubist_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Cubist ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">cubist_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cubist_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">cubist_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/Cubist%20model%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 1</code></pre>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="gradient-boosted-1" class="section level3" number="7.0.7">
<h3>
<span class="header-section-number">7.0.7</span> Gradient Boosted<a class="anchor" aria-label="anchor" href="#gradient-boosted-1"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/gbm-developers/gbm">gbm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loaded gbm 2.1.9</span></span>
<span><span class="co">#&gt; This version of gbm is no longer under development. Consider transitioning to gbm3, https://github.com/gbm-developers/gbm3</span></span></code></pre></div>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">gb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">gb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">gb_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span>    <span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">gb_train_fit</span> <span class="op">&lt;-</span> <span class="fu">gbm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gbm/man/gbm.html">gbm</a></span><span class="op">(</span><span class="va">train</span><span class="op">$</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span>, distribution <span class="op">=</span> <span class="st">"gaussian"</span>, n.trees <span class="op">=</span> <span class="fl">100</span>, shrinkage <span class="op">=</span> <span class="fl">0.1</span>, interaction.depth <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">gb_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gb_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">gb_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">gb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">gb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gb_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">gb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">gb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">gb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">gb_train_table</span><span class="op">)</span></span>
<span><span class="va">gb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gb_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">gb_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">gb_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">gb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">gb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">gb_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">gb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">gb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">gb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">gb_test_table</span><span class="op">)</span></span>
<span><span class="va">gb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">gb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">gb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Gradient Boosted ROC curve "</span>, <span class="st">"(AUC = "</span>, <span class="va">gb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">gb_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">gb_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; Using 100 trees...</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/Gradient%20Boosted%20model%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 0.7012987</code></pre>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="random-forest-2" class="section level3" number="7.0.8">
<h3>
<span class="header-section-number">7.0.8</span> Random Forest<a class="anchor" aria-label="anchor" href="#random-forest-2"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'randomForest'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     combine</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ggplot2':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     margin</span></span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">rf_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">rf_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">rf_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span>    <span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">rf_train_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">train</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y_train</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">df</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">rf_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_train_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_train_probabilities</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_train_table</span><span class="op">)</span></span>
<span><span class="va">rf_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">rf_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">rf_test_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">rf_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.50</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">rf_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">rf_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">rf_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">rf_test_table</span><span class="op">)</span></span>
<span><span class="va">rf_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rf_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rf_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rf_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">rf_test_probabilities</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">rf_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Random Forest "</span>, <span class="st">"(AUC = "</span>, <span class="va">rf_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">rf_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">rf_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/Random%20Forest%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 1</code></pre>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="support-vector-machines-2" class="section level3" number="7.0.9">
<h3>
<span class="header-section-number">7.0.9</span> Support Vector Machines<a class="anchor" aria-label="anchor" href="#support-vector-machines-2"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">e1071</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">svm_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">svm_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">svm_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span>    <span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">svm_train_fit</span> <span class="op">&lt;-</span> <span class="fu">e1071</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/e1071/man/svm.html">svm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">train</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">svm_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_train_fit</span>, <span class="va">train</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">svm_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">svm_train_pred</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">svm_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">svm_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">svm_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">svm_train_table</span><span class="op">)</span></span>
<span><span class="va">svm_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">svm_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">svm_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">svm_train_fit</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">svm_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">svm_test_pred</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">svm_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">svm_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">svm_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">svm_test_table</span><span class="op">)</span></span>
<span><span class="va">svm_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">svm_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">svm_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">svm_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">svm_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">svm_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">svm_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Random Forest "</span>, <span class="st">"(AUC = "</span>, <span class="va">svm_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">svm_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">svm_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/Support%20Vector%20Machines%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 0.7317881</code></pre>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="xgboost-2" class="section level3" number="7.0.10">
<h3>
<span class="header-section-number">7.0.10</span> XGBoost<a class="anchor" aria-label="anchor" href="#xgboost-2"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Load the library</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmlc/xgboost">xgboost</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'xgboost'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     slice</span></span></code></pre></div>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set initial values to 0</span></span>
<span></span>
<span><span class="va">xgb_train_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_test_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_holdout_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_duration</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">xgb_table_total</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Create the function</span></span>
<span></span>
<span><span class="va">xgb_1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">colnum</span>, <span class="va">numresamples</span>, <span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="va">colnum</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"y"</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html">relocate</a></span><span class="op">(</span><span class="va">y</span>, .after <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># Moves the target column to the last column on the right</span></span>
<span>  </span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># randomizes the rows</span></span>
<span>  </span>
<span>  <span class="co"># Set up random resampling</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">numresamples</span><span class="op">)</span> <span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">train_amount</span>, <span class="va">test_amount</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">index</span> <span class="op">==</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span>    </span>
<span>    <span class="va">y_train</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">$</span><span class="va">y</span></span>
<span>    <span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">$</span><span class="va">y</span></span>
<span>    </span>
<span><span class="co"># Fit the model to the training data, make predictions on the holdout data</span></span>
<span><span class="va">train_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">train</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">train_y</span> <span class="op">&lt;-</span> <span class="va">train</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define predictor and response variables in test set</span></span>
<span><span class="va">test_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.matrix.html">data.matrix</a></span><span class="op">(</span><span class="va">test</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">test_y</span> <span class="op">&lt;-</span> <span class="va">test</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span><span class="co"># define final train and test sets</span></span>
<span><span class="va">xgb_train</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">train_x</span>, label <span class="op">=</span> <span class="va">train_y</span><span class="op">)</span></span>
<span><span class="va">xgb_test</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.DMatrix.html">xgb.DMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">test_x</span>, label <span class="op">=</span> <span class="va">test_y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define watchlist</span></span>
<span><span class="va">watchlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span><span class="op">)</span></span>
<span><span class="va">watchlist_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>train <span class="op">=</span> <span class="va">xgb_train</span>, test <span class="op">=</span> <span class="va">xgb_test</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_model</span> <span class="op">&lt;-</span> <span class="fu">xgboost</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xgboost/man/xgb.train.html">xgb.train</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">xgb_train</span>, max.depth <span class="op">=</span> <span class="fl">3</span>, watchlist <span class="op">=</span> <span class="va">watchlist_test</span>, nrounds <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">xgb_model</span><span class="op">$</span><span class="va">evaluation_log</span><span class="op">$</span><span class="va">validation_rmse</span><span class="op">)</span></span>
<span>    </span>
<span><span class="va">xgb_train_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">train_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_train_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_train_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_train_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_train_predictions</span>, <span class="va">y_train</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_train_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_train_table</span><span class="op">)</span></span>
<span><span class="va">xgb_train_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_train_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_test_pred</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">xgb_model</span>, newdata <span class="op">=</span> <span class="va">test_x</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="va">xgb_test_predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">xgb_test_pred</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">xgb_test_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xgb_test_predictions</span>, <span class="va">y_test</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">xgb_test_table</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">xgb_test_table</span><span class="op">)</span></span>
<span><span class="va">xgb_test_accuracy_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">xgb_test_accuracy</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xgb_roc_obj</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">xgb_auc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">xgb_test_pred</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">xgb_roc_obj</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"XGBoost "</span>, <span class="st">"(AUC = "</span>, <span class="va">xgb_auc</span>, <span class="st">")"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Specificity"</span>, y <span class="op">=</span> <span class="st">"Sensitivity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">0</span>, y <span class="op">=</span> <span class="fl">0</span>, yend <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">xgb_test_accuracy_mean</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="co"># closing brace for numresamples </span></span>
<span>  </span>
<span><span class="op">}</span> <span class="co"># Closing brace for the function</span></span>
<span></span>
<span><span class="co"># Test the function</span></span>
<span><span class="fu">xgb_1</span><span class="op">(</span>data <span class="op">=</span> <span class="va">diabetes</span>, colnum <span class="op">=</span> <span class="fl">9</span>, numresamples <span class="op">=</span> <span class="fl">5</span>, train_amount <span class="op">=</span> <span class="fl">0.60</span>, test_amount <span class="op">=</span> <span class="fl">0.40</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  train-rmse:0.443820 test-rmse:0.451114 </span></span>
<span><span class="co">#&gt; [2]  train-rmse:0.410144 test-rmse:0.424842 </span></span>
<span><span class="co">#&gt; [3]  train-rmse:0.389456 test-rmse:0.414245 </span></span>
<span><span class="co">#&gt; [4]  train-rmse:0.375497 test-rmse:0.406926 </span></span>
<span><span class="co">#&gt; [5]  train-rmse:0.361120 test-rmse:0.404512 </span></span>
<span><span class="co">#&gt; [6]  train-rmse:0.351706 test-rmse:0.402855 </span></span>
<span><span class="co">#&gt; [7]  train-rmse:0.344964 test-rmse:0.402907 </span></span>
<span><span class="co">#&gt; [8]  train-rmse:0.338652 test-rmse:0.403506 </span></span>
<span><span class="co">#&gt; [9]  train-rmse:0.332740 test-rmse:0.402499 </span></span>
<span><span class="co">#&gt; [10] train-rmse:0.329630 test-rmse:0.404849 </span></span>
<span><span class="co">#&gt; [11] train-rmse:0.326029 test-rmse:0.403572 </span></span>
<span><span class="co">#&gt; [12] train-rmse:0.322103 test-rmse:0.403685 </span></span>
<span><span class="co">#&gt; [13] train-rmse:0.316984 test-rmse:0.402375 </span></span>
<span><span class="co">#&gt; [14] train-rmse:0.314421 test-rmse:0.402665 </span></span>
<span><span class="co">#&gt; [15] train-rmse:0.312002 test-rmse:0.402012 </span></span>
<span><span class="co">#&gt; [16] train-rmse:0.306025 test-rmse:0.401865 </span></span>
<span><span class="co">#&gt; [17] train-rmse:0.300422 test-rmse:0.406396 </span></span>
<span><span class="co">#&gt; [18] train-rmse:0.296890 test-rmse:0.407696 </span></span>
<span><span class="co">#&gt; [19] train-rmse:0.294799 test-rmse:0.407525 </span></span>
<span><span class="co">#&gt; [20] train-rmse:0.293248 test-rmse:0.409466 </span></span>
<span><span class="co">#&gt; [21] train-rmse:0.290883 test-rmse:0.408838 </span></span>
<span><span class="co">#&gt; [22] train-rmse:0.289344 test-rmse:0.407957 </span></span>
<span><span class="co">#&gt; [23] train-rmse:0.286014 test-rmse:0.405951 </span></span>
<span><span class="co">#&gt; [24] train-rmse:0.284558 test-rmse:0.408597 </span></span>
<span><span class="co">#&gt; [25] train-rmse:0.282312 test-rmse:0.409822 </span></span>
<span><span class="co">#&gt; [26] train-rmse:0.279900 test-rmse:0.409098 </span></span>
<span><span class="co">#&gt; [27] train-rmse:0.279171 test-rmse:0.409240 </span></span>
<span><span class="co">#&gt; [28] train-rmse:0.277008 test-rmse:0.409459 </span></span>
<span><span class="co">#&gt; [29] train-rmse:0.275484 test-rmse:0.409977 </span></span>
<span><span class="co">#&gt; [30] train-rmse:0.270146 test-rmse:0.409051 </span></span>
<span><span class="co">#&gt; [31] train-rmse:0.268145 test-rmse:0.409530 </span></span>
<span><span class="co">#&gt; [32] train-rmse:0.267432 test-rmse:0.408804 </span></span>
<span><span class="co">#&gt; [33] train-rmse:0.266643 test-rmse:0.408577 </span></span>
<span><span class="co">#&gt; [34] train-rmse:0.265945 test-rmse:0.408396 </span></span>
<span><span class="co">#&gt; [35] train-rmse:0.262627 test-rmse:0.408979 </span></span>
<span><span class="co">#&gt; [36] train-rmse:0.261944 test-rmse:0.409056 </span></span>
<span><span class="co">#&gt; [37] train-rmse:0.261083 test-rmse:0.410124 </span></span>
<span><span class="co">#&gt; [38] train-rmse:0.259975 test-rmse:0.410166 </span></span>
<span><span class="co">#&gt; [39] train-rmse:0.257546 test-rmse:0.409997 </span></span>
<span><span class="co">#&gt; [40] train-rmse:0.254742 test-rmse:0.406248 </span></span>
<span><span class="co">#&gt; [41] train-rmse:0.253515 test-rmse:0.405945 </span></span>
<span><span class="co">#&gt; [42] train-rmse:0.253009 test-rmse:0.405861 </span></span>
<span><span class="co">#&gt; [43] train-rmse:0.248366 test-rmse:0.406695 </span></span>
<span><span class="co">#&gt; [44] train-rmse:0.245926 test-rmse:0.405393 </span></span>
<span><span class="co">#&gt; [45] train-rmse:0.245340 test-rmse:0.405159 </span></span>
<span><span class="co">#&gt; [46] train-rmse:0.241983 test-rmse:0.404499 </span></span>
<span><span class="co">#&gt; [47] train-rmse:0.238854 test-rmse:0.403837 </span></span>
<span><span class="co">#&gt; [48] train-rmse:0.237425 test-rmse:0.402440 </span></span>
<span><span class="co">#&gt; [49] train-rmse:0.234284 test-rmse:0.403601 </span></span>
<span><span class="co">#&gt; [50] train-rmse:0.232766 test-rmse:0.403870 </span></span>
<span><span class="co">#&gt; [51] train-rmse:0.230626 test-rmse:0.404637 </span></span>
<span><span class="co">#&gt; [52] train-rmse:0.230082 test-rmse:0.404204 </span></span>
<span><span class="co">#&gt; [53] train-rmse:0.229541 test-rmse:0.404657 </span></span>
<span><span class="co">#&gt; [54] train-rmse:0.226442 test-rmse:0.403503 </span></span>
<span><span class="co">#&gt; [55] train-rmse:0.222275 test-rmse:0.404375 </span></span>
<span><span class="co">#&gt; [56] train-rmse:0.221854 test-rmse:0.404138 </span></span>
<span><span class="co">#&gt; [57] train-rmse:0.219353 test-rmse:0.405571 </span></span>
<span><span class="co">#&gt; [58] train-rmse:0.217785 test-rmse:0.405259 </span></span>
<span><span class="co">#&gt; [59] train-rmse:0.215515 test-rmse:0.404085 </span></span>
<span><span class="co">#&gt; [60] train-rmse:0.214636 test-rmse:0.403443 </span></span>
<span><span class="co">#&gt; [61] train-rmse:0.213945 test-rmse:0.403807 </span></span>
<span><span class="co">#&gt; [62] train-rmse:0.211350 test-rmse:0.404858 </span></span>
<span><span class="co">#&gt; [63] train-rmse:0.209434 test-rmse:0.404904 </span></span>
<span><span class="co">#&gt; [64] train-rmse:0.208350 test-rmse:0.404777 </span></span>
<span><span class="co">#&gt; [65] train-rmse:0.206028 test-rmse:0.404528 </span></span>
<span><span class="co">#&gt; [66] train-rmse:0.205355 test-rmse:0.404718 </span></span>
<span><span class="co">#&gt; [67] train-rmse:0.203309 test-rmse:0.405660 </span></span>
<span><span class="co">#&gt; [68] train-rmse:0.201764 test-rmse:0.404970 </span></span>
<span><span class="co">#&gt; [69] train-rmse:0.199831 test-rmse:0.404663 </span></span>
<span><span class="co">#&gt; [70] train-rmse:0.198291 test-rmse:0.405125</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span>
<span><span class="co">#&gt; Setting levels: control = 0, case = 1</span></span>
<span><span class="co">#&gt; Setting direction: controls &lt; cases</span></span></code></pre></div>
<div class="inline-figure"><img src="06-Individual_Logistic_Models_files/figure-html/XGBoost%20model%20for%20logistic%20data-1.png" width="672"></div>
<pre><code>#&gt; [1] 0.7429577</code></pre>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Check for any errors</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warnings.html">warnings</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="building-ensembles-of-classification-models.html"><span class="header-section-number">6</span> Building ensembles of classification models</a></div>
<div class="next"><a href="advice-to-lebron-james-and-everyone-who-does-talent-analytics-logistic-ensembles.html"><span class="header-section-number">8</span> Advice to Lebron James (and everyone who does talent analytics): Logistic ensembles</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav"><li>
<a class="nav-link" href="#individual-logistic-models"><span class="header-section-number">7</span> Individual logistic models</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#how-to-use-non-glm-models-in-logistic-analysis"><span class="header-section-number">7.0.1</span> How to use non-GLM models in logistic analysis</a></li>
<li><a class="nav-link" href="#eight-individual-models-for-logistic-data"><span class="header-section-number">7.0.2</span> Eight individual models for logistic data</a></li>
<li><a class="nav-link" href="#adaboost"><span class="header-section-number">7.0.3</span> Adaboost</a></li>
<li><a class="nav-link" href="#bayesglm-1"><span class="header-section-number">7.0.4</span> BayesGLM</a></li>
<li><a class="nav-link" href="#c50"><span class="header-section-number">7.0.5</span> C50</a></li>
<li><a class="nav-link" href="#cubist-1"><span class="header-section-number">7.0.6</span> Cubist</a></li>
<li><a class="nav-link" href="#gradient-boosted-1"><span class="header-section-number">7.0.7</span> Gradient Boosted</a></li>
<li><a class="nav-link" href="#random-forest-2"><span class="header-section-number">7.0.8</span> Random Forest</a></li>
<li><a class="nav-link" href="#support-vector-machines-2"><span class="header-section-number">7.0.9</span> Support Vector Machines</a></li>
<li><a class="nav-link" href="#xgboost-2"><span class="header-section-number">7.0.10</span> XGBoost</a></li>
</ul>
</li></ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/InfiniteCuriosity/EnsemblesBook/blob/master/06-Individual_Logistic_Models.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/InfiniteCuriosity/EnsemblesBook/edit/master/06-Individual_Logistic_Models.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Ensembles: From Beginner to Expert</strong>" was written by Russ Conte. It was last built on 2024-06-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
